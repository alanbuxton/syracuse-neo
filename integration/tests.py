from django.test import TestCase
from neomodel import db
import os
from datetime import datetime, timezone
from integration.models import DataImport
from integration.management.commands.import_ttl import ( do_import_ttl,
    load_deletion_file, load_file
)
from topics.models import Organization, Resource
from integration.neo4j_utils import (
    delete_all_not_needed_resources,
    apoc_del_redundant_same_as,
    delete_and_clean_up_nodes_by_doc_id,
)
from integration.rdf_post_processor import (RDFPostProcessor, 
    update_duplicated_resource_ids, recursively_re_merge_node_via_same_as
)                
from syracuse.cache_util import nuke_cache
from topics.models.models_extras import add_dynamic_classes_for_multiple_labels

import logging
logger = logging.getLogger(__name__)


'''
    Care these tests will delete Neo4j DB
'''
env_var="DELETE_NEO"
if os.environ.get(env_var) != "Y":
    print(f"Set env var {env_var}=Y to confirm you want to drop Neo4j database")
    exit(0)

def count_relevant_nodes():
    query = """MATCH (n: Resource) WHERE SIZE(LABELS(n)) > 1
                OR n.uri CONTAINS 'https://sws.geonames.org'
                RETURN COUNT(n);""" # Resource + at least one other label, or Geoname
    val, _ = db.cypher_query(query)
    return val[0][0]

def clean_db():
    db.cypher_query("MATCH (n) CALL {WITH n DETACH DELETE n} IN TRANSACTIONS OF 10000 ROWS;")
    DataImport.objects.all().delete()

def clean_db_and_load_files(dirname,do_post_processing=False):
    clean_db()
    assert DataImport.latest_import() == None # Empty DB
    do_import_ttl(dirname=dirname,force=True,do_archiving=False,do_post_processing=do_post_processing)
    delete_all_not_needed_resources() # Lots of "sameAs" entries that aren't available in any test data
    apoc_del_redundant_same_as()

class TurtleLoadingTestCase(TestCase):

    def test_loads_ttl_files(self):
        clean_db_and_load_files("integration/test_dump/dump-3")
        assert len(DataImport.objects.all()) == 2
        assert DataImport.latest_import() == 20231224180800

    def test_handles_duplicate_internal_ids(self):
        clean_db_and_load_files("integration/test_dump/dump-1")
        RDFPostProcessor().run_all_in_order()
        uri_source = "https://1145.am/db/3518892/Goldman_Sachs_Investment_Partners"
        uri_dup_1 = "https://1145.am/db/4001440/Coretrax"
        uri_dup_2 = "https://1145.am/db/4001762/Evri"

        org_source = Resource.nodes.get_or_none(uri=uri_source)
        internal_id = org_source.internalId 

        for uri in [uri_dup_1,uri_dup_2]:
            org = Resource.nodes.get_or_none(uri=uri)
            org.internalId = internal_id
            org.save()

        assert len(Resource.nodes.filter(internalId=internal_id)) == 3

        update_duplicated_resource_ids()

        org_source = Resource.nodes.get_or_none(uri=uri_source)
        assert org_source.internalId == internal_id # hasn't changed the original source

        for uri in [uri_dup_1,uri_dup_2]:
            org = Resource.nodes.get_or_none(uri=uri)
            assert org.internalId > internal_id # has been reset to a larger value

        dup_query = "MATCH (n:Resource) WITH n.internalId AS internalId, count(*) AS count WHERE count > 1 RETURN internalId, count"
        dups, _ = db.cypher_query(dup_query)
        assert len(dups) == 0, f"Expected {dups} to be empty list"


    def test_loads_deletion_and_recreation_step_by_step(self):
        clean_db_and_load_files("integration/test_dump/dump-1",do_post_processing=True)
        node_count = count_relevant_nodes()
        assert node_count == 1765
        latest_import = DataImport.objects.all()[0]
        assert latest_import.deletions == 0
        assert latest_import.creations > 0 and latest_import.creations <= node_count

        # 4001762 is the one that will be recreated
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/4290155/Royal_Mail").uri == "https://1145.am/db/4001762/Royal_Mail"
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail").uri == "https://1145.am/db/4001762/Royal_Mail"
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/2984033/Royal_Mail") is None

        # 2984033 should be the ultimate target node - next load will ensure this is the case
        do_import_ttl(dirname="integration/test_dump/dump-1.5",force=True,do_archiving=False,do_post_processing=True)
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/4290155/Royal_Mail").uri == "https://1145.am/db/2984033/Royal_Mail"
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail").uri == "https://1145.am/db/2984033/Royal_Mail"
        assert Organization.self_or_ultimate_target_node("https://1145.am/db/2984033/Royal_Mail").uri == "https://1145.am/db/2984033/Royal_Mail"

        ultimate_target_node = Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail")
        assert ultimate_target_node.uri == "https://1145.am/db/2984033/Royal_Mail"
        target_node_rels = all_related_uris(ultimate_target_node) # Before we get to deletions

        doc_id = 4001762
        nodes_to_delete = list(Resource.nodes.filter(internalDocId=doc_id))
        uris_to_delete = [x.uri for x in nodes_to_delete]
        merged_nodes = list(Resource.nodes.filter(internalMergedSameAsHighToUri__in=uris_to_delete))
        assert len(nodes_to_delete) > 0
        assert len(merged_nodes) > 0

        # Now load deletion file
        filepath = "integration/test_dump/dump-2/20231224180756/deletions/for_deletion_4001762.ttl"
        load_deletion_file(filepath)
        do_import_ttl(force=True,only_post_processing=True)
        assert len(list(Resource.nodes.filter(internalDocId=doc_id))) == 0 # all deleted
        assert len(list(Resource.nodes.filter(internalMergedSameAsHighToUri__in=uris_to_delete))) == 0

        # And load the file with the new additions
        load_file("integration/test_dump/dump-2/20231224180756/identical_4001762.ttl",RDF_SLEEP_TIME=0)
        do_import_ttl(force=True,only_post_processing=True)
        assert len(list(Resource.nodes.filter(internalDocId=doc_id))) == len(nodes_to_delete)
        # assert len(list(Resource.nodes.filter(internalMergedSameAsHighToUri__in=uris_to_delete))) == len(merged_nodes)

        ultimate_target_node2 = Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail")
        assert ultimate_target_node2.uri == "https://1145.am/db/2984033/Royal_Mail"
        new_vals = all_related_uris(ultimate_target_node2)

        assert len(new_vals) == len(target_node_rels)

    def test_loads_deletion_with_new_edit(self):
        clean_db_and_load_files("integration/test_dump/dump-1",do_post_processing=True)
        do_import_ttl(dirname="integration/test_dump/dump-1.5",force=True,do_archiving=False,do_post_processing=True)
        ultimate_target_node = Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail")
        assert ultimate_target_node.uri == "https://1145.am/db/2984033/Royal_Mail"
        target_node_rels = all_related_uris(ultimate_target_node)
        do_import_ttl(dirname="integration/test_dump/dump-2.1",force=True,do_archiving=False,do_post_processing=True)

        # and check the new company name
        n = Resource.nodes.get_or_none(uri="https://1145.am/db/4001762/Royal_Mail") # search by Resource is faster due to explicit index
        assert isinstance(n, Organization)
        assert n.name == ['Royal Maily Foo Bar'] # name was edited (only updates in the original node)

        ultimate_target_node2 = Organization.self_or_ultimate_target_node(n)
        new_vals = all_related_uris(ultimate_target_node2)

        assert len(new_vals) == len(target_node_rels)
        for k in new_vals:
            if k != 'investor': # investor was added
                assert new_vals[k] == target_node_rels[k]

        assert target_node_rels['investor'] - new_vals['investor'] == set()
        assert new_vals['investor'] - target_node_rels['investor'] == {'https://1145.am/db/4001762/Evri-Acquisition'}

    def test_loads_deletion_without_new_file(self):
        clean_db_and_load_files("integration/test_dump/dump-1",do_post_processing=True)
        do_import_ttl(dirname="integration/test_dump/dump-1.5",force=True,do_archiving=False,do_post_processing=True)
        ultimate_target_node = Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail")
        assert ultimate_target_node.uri == "https://1145.am/db/2984033/Royal_Mail"
        target_node_rels = all_related_uris(ultimate_target_node)
        do_import_ttl(dirname="integration/test_dump/dump-2.2",force=True,do_archiving=False,do_post_processing=True)
        ultimate_target_node2 = Organization.self_or_ultimate_target_node("https://1145.am/db/4001762/Royal_Mail")
        assert ultimate_target_node2 is None
        main_node = Organization.self_or_ultimate_target_node("https://1145.am/db/2984033/Royal_Mail")
        new_vals = all_related_uris(main_node)
        assert len(new_vals) == len(target_node_rels)

        doc_id_in_uri = False
        for v in target_node_rels.values():
            if any([x.find("/4001762/") > 0 for x in v]):
                doc_id_in_uri = True
                break
        assert doc_id_in_uri is True # Originally the main node had relationships that included 4001762 doc id

        doc_id_in_uri = False
        for v in new_vals.values():
            if any([x.find("/4001762/") > 0 for x in v]):
                doc_id_in_uri = True
                break
        assert doc_id_in_uri is False # Should be no occurrence of the deleted doc id in Royal Mail's relationships

class DeleteMergedOrgsWithMergedActivitiesTestCase(TestCase):

    @classmethod
    def setUpTestData(cls):
        clean_db()
        nuke_cache()
        org_nodes = [make_node(x,y) for x,y in [(100,"a"),(101,"b")]]
        doc_source_m = """(docsource_m:Resource:Article {uri: 'https://1145.am/db/article_m',
                        headline: 'Headline m', internalDocId: 200, sourceOrganization:'prweb', 
                        datePublished: datetime('2025-07-10T11:56:25.992116+00:00') }), 
                        (docsource_m)-[:url]->(ext_m:Resource { uri: 'https://example.org/external/art_m' })"""
        act_node_0 = """(m:Resource:MarketingActivity {uri: 'https://1145.am/db/200/m', name: ['Name M'],  
                        status: ['some status'],   internalDocId: 200})-
                        [:documentSource { documentExtract: 'Doc Extract ' }]->(docsource_m)"""
        act_node_1 = """(n:Resource:MarketingActivity {uri: 'https://1145.am/db/200/n', name: ['Name N'],  
                        status: ['some other status'],   internalDocId: 200})-
                        [:documentSource { documentExtract: 'Doc Extract 2' }]->(docsource_m)"""
        act_node_for_target = make_node(202,"p","MarketingActivity")
        node_list = ", ".join(org_nodes + [doc_source_m,act_node_0,act_node_1,act_node_for_target])
        query = f"""
            CREATE {node_list},
            (b)-[:hasMarketingActivity]->(m),
            (b)-[:hasMarketingActivity]->(n),
            (b)-[:hasMarketingActivity]->(p),
            (a)-[:sameAsHigh]->(b),
            (a)-[:hasMarketingActivity]->(p)
        """
        db.cypher_query(query)
        R = RDFPostProcessor()
        R.run_all_in_order()
        node_a = Resource.nodes.get_or_none(uri="https://1145.am/db/100/a")

        assert len(node_a.marketing) == 2
        p_act = Resource.nodes.get_or_none(uri="https://1145.am/db/202/p")
        m_act = Resource.nodes.get_or_none(uri="https://1145.am/db/200/m")
        assert node_a.marketing.relationship(p_act).weight == 2 # p is added via 2 different nodes
        assert node_a.marketing.relationship(m_act).weight == 2 # m is a combination of n and m which a inherits from b
        
    def test_deletes_source_node_with_merged_activities(self):
        node_a = Resource.nodes.get_or_none(uri="https://1145.am/db/100/a")
        node_b = Resource.nodes.get_or_none(uri="https://1145.am/db/101/b")
        node_b.delete_node_and_related()
        p_act = Resource.nodes.get_or_none(uri="https://1145.am/db/202/p")
        m_act = Resource.nodes.get_or_none(uri="https://1145.am/db/200/m")
        assert node_a.marketing.relationship(p_act).weight == 1 # Node B contributed 1 of this weight and has been deleted
        assert node_a.marketing.relationship(m_act) is None # Node b was deleted so should be removed from downstream


class MergeSameAsHighTestCase(TestCase):

    @classmethod
    def setUpTestData(cls):
        clean_db()
        nuke_cache()
        org_nodes = [make_node(x,y) for x,y in zip(range(100,200),"abcdefghijk")]
        act_nodes = [make_node(x,y,"CorporateFinanceActivity") for x,y in zip(range(100,200),"mnopqrs")]
        node_list = ", ".join(org_nodes + act_nodes)
        ind1_connections = [f"({x})-[:industryClusterPrimary]->(ind1)" for x in "aei"]
        ind2_connections = [f"({x})-[:industryClusterPrimary]->(ind2)" for x in "bcdfghjk"]
        query = f"""
            CREATE {node_list},
            (a)<-[:sameAsHigh]-(b),
            (b)-[:sameAsHigh]->(c),
            (c)-[:sameAsHigh]->(d),
            (e)-[:sameAsHigh]->(f),
            (f)<-[:sameAsHigh]-(g),
            (g)-[:sameAsHigh]->(a),

            (h)-[:sameAsHigh]->(i),
            (i)-[:sameAsHigh]->(j),
            (i)<-[:sameAsHigh]-(k),

            (a)-[:buyer]->(m),
            (b)-[:buyer]->(n),
            (c)-[:buyer]->(o),
            (d)-[:investor]->(p),
            (e)-[:investor]->(q),
            (f)-[:buyer]->(r),
            (g)-[:buyer]->(s),

            (m)-[:target]->(h),
            (n)-[:target]->(i),
            (o)-[:target]->(j),
            (p)-[:target]->(k),
            (q)-[:target]->(h),
            (r)-[:target]->(i),
            (s)-[:target]->(j),

            (ind1: Resource:IndustryCluster {{uri:"https://1145.am/ind1", topicId: 23, representativeDoc:['Baz']}}),
            (ind2: Resource:IndustryCluster {{uri:"https://1145.am/ind2", topicId: 24, representativeDoc:['Bar']}}),
            { ', '.join(ind1_connections + ind2_connections) }
        """
        db.cypher_query(query)
        R = RDFPostProcessor()
        a = Resource.nodes.get_or_none(uri="https://1145.am/db/100/a")
        assert len(a.buyer) == 1
        assert len(a.investor) == 0
        assert len(a.vendor) == 0
        R.run_all_in_order()

    def test_merges_all_same_as_highs(self):
        target_uris = []
        merged_uris = []
        for x, y in zip("abcdefghijk",range(100,200)):
            uri = f"https://1145.am/db/{y}/{x}"
            if x in "ah": # target merged nodes
                target_uris.append(uri)
            else:
                merged_uris.append(uri)
        for uri in target_uris:
            logger.info(uri)
            assert Organization.unmerged_or_none_by_uri(uri) is not None
        for uri in merged_uris:
            logger.info(uri)
            assert Resource.nodes.get_or_none(uri=uri) is not None
            assert Organization.unmerged_or_none_by_uri(uri) is None

    def test_attributes_for_ultimate_target(self):
        a = Organization.self_or_ultimate_target_node("https://1145.am/db/100/a")
        assert a.best_name == 'Name A', f"Got {a.best_name}"
        assert a.industry_as_string == 'Bar, Baz', f"Got {a.industry_as_string}"

    def test_gets_ultimate_target(self):
        o = Organization.self_or_ultimate_target_node("https://1145.am/db/105/f")
        assert o.uri == "https://1145.am/db/100/a"
        assert o.best_name == 'Name A'

    def test_merges_connections1(self):
        a = Organization.self_or_ultimate_target_node("https://1145.am/db/101/b") # Actually a
        assert a.uri == "https://1145.am/db/100/a"
        assert len(a.buyer) == 5
        assert len(a.investor) == 2
        assert len(a.vendor) == 0

    def test_merges_connections2(self):
        h = Organization.self_or_ultimate_target_node("https://1145.am/db/109/j") # Actually h
        assert len(h.target) == 7

    def test_adds_weight_to_merged_relationships(self):
        '''
            Test original state for the network around node `a` with:

            match (n: Organization {uri:"https://1145.am/db/100/a"})-[:sameAsHigh*]-(o)-[:industryClusterPrimary]-(i) 
            where o.internalMergedSameAsHighToUri is null
            return *

            2 connections to ind1, 5 connections to ind2
        '''
        a = Organization.self_or_ultimate_target_node("https://1145.am/db/100/a")
        ind1 = Resource.nodes.get_or_none(uri="https://1145.am/ind1")
        ind2 = Resource.nodes.get_or_none(uri="https://1145.am/ind2")
        a_ind1 = a.internal_industryClusterPrimary.relationship(ind1)
        a_ind2 = a.internal_industryClusterPrimary.relationship(ind2)
        assert a_ind1.weight == 2, f"Got {a_ind1.weight}"
        assert a_ind2.weight == 5, f"Got {a_ind2.weight}"

class CypherQueryBaseTestCase(TestCase):

    cypher_queries = ""

    @classmethod
    def setUpTestData(cls):
        clean_db()
        nuke_cache()
        for query in cls.cypher_queries.split(";"):
            q = query.strip()
            if q != '':
                db.cypher_query(q)
        add_dynamic_classes_for_multiple_labels(ignore_cache=True)

class ReMergeOrgWithActivityTestCase(CypherQueryBaseTestCase):

    '''

    https://1145.am/db/10217121/Gripple is Organization & CorporateFinanceActivity, but has already been merged

    call apoc.export.cypher.query( 
        "match (n: Resource)-[o]-(p) where (n.internalDocId in [9156027,10217121] and p.internalDocId in [9156027,10217121]) or (n.internalDocId in [9156027,10217121] and p.uri = 'https://1145.am/db/geonames_location/3333193' ) or (n.uri = 'https://1145.am/db/geonames_location/3333193' and p.internalDocId in [9156027,10217121] ) RETURN *"
        ,null,{format:"plain",stream:true})

    also query: match (n: Resource)-[o]-(p: Resource) where (n.internalDocId = 7534240 and p.internalDocId = 7534240) or
(n.internalDocId = 7534240 and p.uri = 'https://1145.am/db/geonames_location/292223')  or (n.uri = 'https://1145.am/db/geonames_location/292223' and p.internalId = 7534240) return *


    '''
    cypher_queries = """CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;
        UNWIND [{uri:"https://1145.am/db/geonames_location/3333193", properties:{internalId:351298, featureCode:"ADM2", deletedRedundantSameAsAt:1.758814230037088E9, countryCode:"GB", name:["Sheffield"], geoNamesId:3333193, admin1Code:"ENG"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:GeoNamesLocation;
        UNWIND [{uri:"https://1145.am/db/9156027/Royal_Oak_Football_Club", properties:{internalId:12028946, basedInHighClean:["Sheffield"], internalDocId:9156027, deletedRedundantSameAsAt:1.7584814739275134E9, foundName:["Royal Oak Football Club"], name:["Royal Oak Football Club"], description:["Football"], internalCleanName:["royal oak football club"], basedInHighRaw:["Sheffield"]}}, {uri:"https://1145.am/db/9156027/Gripple", properties:{internalId:12028951, industry_embedding: [], basedInHighClean:["Sheffield"], internalDocId:9156027, deletedRedundantSameAsAt:1.7584814739275134E9, industry_embedding_json:"[]", foundName:["Gripple"], name:["Gripple"], industry:["manufacturer"], internalCleanName:["gripple"], basedInHighRaw:["Sheffield"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
        UNWIND [{uri:"https://1145.am/db/9156027/Partnership-Gripple_Royal_Oak_Football_Club", properties:{documentDate:datetime('2025-08-22T09:36:55Z'), internalId:12028949, orgName:["Royal Oak Football Club", "Gripple"], internalDocId:9156027, deletedRedundantSameAsAt:1.7584814739275134E9, documentExtract:"Sheffield - based manufacturer Gripple is proud to announce they 're the new shirt sponsors of the Royal Oak Football Club, led by Sheffield legend and social media personality Steve Bracknall, for the 2025/26 season. Sign up to our daily newsletter Sign up Thank you for signing up! Did you know with a Digital subscription to Yorkshire Post, you can get access to all of our premium content, as well as benefiting from fewer ads, loyalty rewards and much more. Learn More Sorry, there seem to be some issues. Please try again later.", name:["Partnership"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:PartnershipActivity;
        UNWIND [{uri:"https://1145.am/db/10217121/Gripple", properties:{documentDate:datetime('2025-09-19T13:47:01Z'), basedInHighClean:["Sheffield"], valueRaw:["over 15K"], deletedRedundantSameAsAt:1.7586268075250537E9, industry:["manufacturer"], internalMergedSameAsHighToUri:"https://1145.am/db/9156027/Gripple", whereHighRaw:["Sheffield"], internalId:13950783, whereHighClean:["Sheffield"], internalDocId:10217121, documentExtract:"Sheffield - based manufacturer Gripple has celebrated a successful Masks & Moonlight charity ball, raising over 15K for five local charities: St Luke's Hospice, Team Ted Foundation, Thornberry Animal Sanctuary, Parkinson's UK, and Edale Mountain Rescue Team.", foundName:["raising", "charity ball", "Gripple"], re_merge_candidate:false, name:["raising", "charity ball", "Gripple"], internalCleanName:["gripple", "charity ball"], basedInHighRaw:["Sheffield"], status:["completed"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization:CorporateFinanceActivity;
        UNWIND [{uri:"https://1145.am/db/10217121/Manufacturer-About-Us", properties:{documentDate:datetime('2025-09-19T13:47:01Z'), internalId:13950719, internalDocId:10217121, deletedRedundantSameAsAt:1.7586268075250537E9, foundName:["manufacturer"], documentExtract:"Sheffield - based manufacturer Gripple has celebrated a successful Masks & Moonlight charity ball, raising over 15K for five local charities: St Luke's Hospice, Team Ted Foundation, Thornberry Animal Sanctuary, Parkinson's UK, and Edale Mountain Rescue Team. Sign up to our daily newsletter Sign up Thank you for signing up! Did you know with a Digital Subscription to Yorkshire Evening Post, you can get unlimited access to the website including our premium content, as well as benefiting from fewer ads, loyalty rewards and much more. Subscription Offers Sorry, there seem to be some issues. Please try again later.", name:["manufacturer"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:AboutUs;
        UNWIND [{uri:"https://1145.am/db/9156027/wwwyorkshirepostcouk_community_gripple-scores-sponsorship-of-sheffields-own-steve-bracknall-and-the-royal-oak-fc-5285315", properties:{datePublished:datetime('2025-08-22T09:36:55Z'), internalId:12028928, internalDocId:9156027, deletedRedundantSameAsAt:1.7584814739275134E9, dateRetrieved:datetime('2025-08-22T15:46:07Z'), sourceOrganization:"Yorkshire Post", headline:"Gripple Scores Sponsorship of Sheffield's Own Steve Bracknall and the Royal Oak FC"}}, {uri:"https://1145.am/db/10217121/wwwyorkshireeveningpostcouk_business_thats-the-community-spirit-sheffield-firms-charity-ball-raises-over-ps15k-5325964", properties:{datePublished:datetime('2025-09-19T13:47:01Z'), internalId:13950665, internalDocId:10217121, deletedRedundantSameAsAt:1.7586268075250537E9, dateRetrieved:datetime('2025-09-19T22:07:11Z'), sourceOrganization:"Yorkshire Evening Post", headline:"That's the Community Spirit: Sheffield firm's charity ball raises over £15K"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Gripple"}, end: {uri:"https://1145.am/db/geonames_location/3333193"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Gripple"}, end: {uri:"https://1145.am/db/9156027/Partnership-Gripple_Royal_Oak_Football_Club"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:partnership]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Gripple"}, end: {uri:"https://1145.am/db/10217121/Manufacturer-About-Us"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Partnership-Gripple_Royal_Oak_Football_Club"}, end: {uri:"https://1145.am/db/9156027/wwwyorkshirepostcouk_community_gripple-scores-sponsorship-of-sheffields-own-steve-bracknall-and-the-royal-oak-fc-5285315"}, properties:{documentExtract:"Sheffield - based manufacturer Gripple is proud to announce they 're the new shirt sponsors of the Royal Oak Football Club, led by Sheffield legend and social media personality Steve Bracknall, for the 2025/26 season. Sign up to our daily newsletter Sign up Thank you for signing up! Did you know with a Digital subscription to Yorkshire Post, you can get access to all of our premium content, as well as benefiting from fewer ads, loyalty rewards and much more. Learn More Sorry, there seem to be some issues. Please try again later.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Royal_Oak_Football_Club"}, end: {uri:"https://1145.am/db/9156027/wwwyorkshirepostcouk_community_gripple-scores-sponsorship-of-sheffields-own-steve-bracknall-and-the-royal-oak-fc-5285315"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9156027/Gripple"}, end: {uri:"https://1145.am/db/9156027/wwwyorkshirepostcouk_community_gripple-scores-sponsorship-of-sheffields-own-steve-bracknall-and-the-royal-oak-fc-5285315"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9156027/Gripple"}, end: {uri:"https://1145.am/db/10217121/wwwyorkshireeveningpostcouk_business_thats-the-community-spirit-sheffield-firms-charity-ball-raises-over-ps15k-5325964"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Gripple"}, end: {uri:"https://1145.am/db/9156027/Gripple"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Gripple"}, end: {uri:"https://1145.am/db/geonames_location/3333193"}, properties:{weight:5}}, {start: {uri:"https://1145.am/db/9156027/Royal_Oak_Football_Club"}, end: {uri:"https://1145.am/db/geonames_location/3333193"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/geonames_location/3333193"}, end: {uri:"https://1145.am/db/9156027/wwwyorkshirepostcouk_community_gripple-scores-sponsorship-of-sheffields-own-steve-bracknall-and-the-royal-oak-fc-5285315"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/3333193"}, end: {uri:"https://1145.am/db/10217121/wwwyorkshireeveningpostcouk_business_thats-the-community-spirit-sheffield-firms-charity-ball-raises-over-ps15k-5325964"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Gripple"}, end: {uri:"https://1145.am/db/10217121/wwwyorkshireeveningpostcouk_business_thats-the-community-spirit-sheffield-firms-charity-ball-raises-over-ps15k-5325964"}, properties:{documentExtract:"Sheffield - based manufacturer Gripple has celebrated a successful Masks & Moonlight charity ball, raising over 15K for five local charities: St Luke's Hospice, Team Ted Foundation, Thornberry Animal Sanctuary, Parkinson's UK, and Edale Mountain Rescue Team.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Gripple"}, end: {uri:"https://1145.am/db/geonames_location/3333193"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Gripple"}, end: {uri:"https://1145.am/db/10217121/Manufacturer-About-Us"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9156027/Partnership-Gripple_Royal_Oak_Football_Club"}, end: {uri:"https://1145.am/db/9156027/Royal_Oak_Football_Club"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:providedBy]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/10217121/Manufacturer-About-Us"}, end: {uri:"https://1145.am/db/10217121/wwwyorkshireeveningpostcouk_business_thats-the-community-spirit-sheffield-firms-charity-ball-raises-over-ps15k-5325964"}, properties:{documentExtract:"Sheffield - based manufacturer Gripple has celebrated a successful Masks & Moonlight charity ball, raising over 15K for five local charities: St Luke's Hospice, Team Ted Foundation, Thornberry Animal Sanctuary, Parkinson's UK, and Edale Mountain Rescue Team. Sign up to our daily newsletter Sign up Thank you for signing up! Did you know with a Digital Subscription to Yorkshire Evening Post, you can get unlimited access to the website including our premium content, as well as benefiting from fewer ads, loyalty rewards and much more. Subscription Offers Sorry, there seem to be some issues. Please try again later.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
                
        UNWIND [{uri:"https://1145.am/db/geonames_location/292223", properties:{internalId:1645, featureCode:"PPLA", deletedRedundantSameAsAt:1.758814230037088E9, countryCode:"AE", name:["Dubai"], geoNamesId:292223, admin1Code:"03"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:GeoNamesLocation;
        UNWIND [{uri:"https://1145.am/db/7534240/Untold", properties:{basedInHighClean:["Dubai"], internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, foundName:["UNTOLD", "UNTOLD Universe"], name:["UNTOLD"], description:["music and youth culture"], internalCleanName:["untold"], basedInHighRaw:["Dubai"]}}, {uri:"https://1145.am/db/7534240/Motogp", properties:{internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, foundName:["MotoGP"], name:["MotoGP"], internalCleanName:["motogp"]}}, {uri:"https://1145.am/db/7534240/Laliga", properties:{internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, foundName:["LALIGA"], name:["LALIGA"], internalCleanName:["laliga"]}}, {uri:"https://1145.am/db/7534240/Brief_Bitget", properties:{internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, foundName:["Bitget", "UNTOLD Festival", "In Brief"], name:["Brief Bitget"], description:["crypto"], industry:["Cryptocurrency exchange"], internalCleanName:["brief bitget"], basedInLowRaw:["Dubai"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
        UNWIND [{uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc", properties:{documentDate:datetime('2025-07-09T10:00:00Z'), orgName:["MotoGP", "UNTOLD", "Bitget", "LALIGA"], internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, documentExtract:"With an anticipated attendance of over 400,000 individuals, Bitget plans to expand its visibility by engaging directly with audiences at large-scale music events under the theme Feel the ₿eat . This initiative represents Bitget's most prominent entry into the music and youth culture space to date. Building on previous sponsorship agreements with LALIGA and MotoGP, the collaboration with UNTOLD signals a strategic expansion of Bitget's presence beyond traditional crypto arenas. The broader objective of this partnership is to integrate Web3 into mainstream cultural settings, reaching audiences across all aspects of the festival experience.  We 're excited to welcome Bitget as a global partner of UNTOLD.", name:["Partnership"]}}, {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Brief_Bitget", properties:{documentDate:datetime('2025-07-09T10:00:00Z'), orgName:["Bitget"], internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, documentExtract:"Bitget Partners With UNTOLD Festival: Bringing Crypto To The Main Stage. Share this article. by Alisa Davidson by Ana To improve your local-language experience, sometimes we employ an auto-translation plugin. Please note auto-translation may not be accurate, so read original article for precise information. In Brief Bitget has partnered with UNTOLD to become an official sponsor for its 10th anniversary and UNTOLD Dubai events, marking a strategic expansion into music and youth culture by integrating Web3 and enhancing VIP experiences.", name:["Partnership"]}}, {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Untold", properties:{documentDate:datetime('2025-07-09T10:00:00Z'), whereHighRaw:["Dubai"], whereHighClean:["Dubai"], orgName:["UNTOLD", "Brief Bitget"], internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, documentExtract:"by Alisa Davidson by Ana To improve your local-language experience, sometimes we employ an auto-translation plugin. Please note auto-translation may not be accurate, so read original article for precise information. In Brief Bitget has partnered with UNTOLD to become an official sponsor for its 10th anniversary and UNTOLD Dubai events, marking a strategic expansion into music and youth culture by integrating Web3 and enhancing VIP experiences. Cryptocurrency exchange and Web3 - focused company Bitget has announced a partnership with UNTOLD, recognized as one of the top three music festivals globally. As part of this collaboration, Bitget will serve as an official sponsor of UNTOLD X, scheduled for August, and will continue its sponsorship at UNTOLD Dubai later in the year.", foundName:["music and youth culture", "and youth culture"], name:["Music and Youth Culture", "Partnership"], status:["not happened at date of document"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:PartnershipActivity;
        UNWIND [{uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage", properties:{datePublished:datetime('2025-07-09T10:00:00Z'), internalDocId:7534240, deletedRedundantSameAsAt:1.7592318588696406E9, dateRetrieved:datetime('2025-07-09T12:49:57Z'), sourceOrganization:"Metaverse Post", headline:"Bitget Partners With UNTOLD Festival: Bringing Crypto To The Main Stage"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
        UNWIND [{start: {uri:"https://1145.am/db/7534240/Untold"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Motogp"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Brief_Bitget"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Untold"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Brief_Bitget"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Brief_Bitget"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Untold"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Untold"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Brief_Bitget"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Laliga"}, end: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:partnership]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Untold"}, end: {uri:"https://1145.am/db/geonames_location/292223"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/7534240/Laliga"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Untold"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Brief_Bitget"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/7534240/Motogp"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Brief_Bitget"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{documentExtract:"Bitget Partners With UNTOLD Festival: Bringing Crypto To The Main Stage. Share this article. by Alisa Davidson by Ana To improve your local-language experience, sometimes we employ an auto-translation plugin. Please note auto-translation may not be accurate, so read original article for precise information. In Brief Bitget has partnered with UNTOLD to become an official sponsor for its 10th anniversary and UNTOLD Dubai events, marking a strategic expansion into music and youth culture by integrating Web3 and enhancing VIP experiences.", weight:1}}, {start: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Untold"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{documentExtract:"by Alisa Davidson by Ana To improve your local-language experience, sometimes we employ an auto-translation plugin. Please note auto-translation may not be accurate, so read original article for precise information. In Brief Bitget has partnered with UNTOLD to become an official sponsor for its 10th anniversary and UNTOLD Dubai events, marking a strategic expansion into music and youth culture by integrating Web3 and enhancing VIP experiences. Cryptocurrency exchange and Web3 - focused company Bitget has announced a partnership with UNTOLD, recognized as one of the top three music festivals globally. As part of this collaboration, Bitget will serve as an official sponsor of UNTOLD X, scheduled for August, and will continue its sponsorship at UNTOLD Dubai later in the year.", weight:1}}, {start: {uri:"https://1145.am/db/7534240/Partnership-Brief_Bitget_Laliga_Etc"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{documentExtract:"With an anticipated attendance of over 400,000 individuals, Bitget plans to expand its visibility by engaging directly with audiences at large-scale music events under the theme Feel the ₿eat . This initiative represents Bitget's most prominent entry into the music and youth culture space to date. Building on previous sponsorship agreements with LALIGA and MotoGP, the collaboration with UNTOLD signals a strategic expansion of Bitget's presence beyond traditional crypto arenas. The broader objective of this partnership is to integrate Web3 into mainstream cultural settings, reaching audiences across all aspects of the festival experience.  We 're excited to welcome Bitget as a global partner of UNTOLD.", weight:2}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/7534240/Untold"}, end: {uri:"https://1145.am/db/geonames_location/292223"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/geonames_location/292223"}, end: {uri:"https://1145.am/db/7534240/mpostio_bitget-partners-with-untold-festival-bringing-crypto-to-the-main-stage"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        """

    def test_handles_re_merge_with_different_attributes(self):
        source_node = Resource.nodes.get(uri="https://1145.am/db/10217121/Gripple")
        target_node = Resource.nodes.get(uri="https://1145.am/db/9156027/Gripple")
        cnts_before, _ = db.cypher_query("MATCH (a)-[x]-(b) RETURN COUNT(x), SUM(x.weight)")
        Resource.merge_node_connections(source_node, target_node, run_as_re_merge=True)
        cnts_after, _ = db.cypher_query("MATCH (a)-[x]-(b) RETURN COUNT(x), SUM(x.weight)")
        self.assertEqual(cnts_before, cnts_after)

    def test_handles_merge_equivalent_activities_with_different_attributes(self):
        r = RDFPostProcessor()
        cnts_before, _ = db.cypher_query("MATCH (a)-[x]-(b) RETURN COUNT(x), SUM(x.weight)")
        cnt0 = cnts_before[0][0]
        weights0 = cnts_before[0][1]
        merged_before, _ = db.cypher_query("MATCH (a) WHERE a.internalMergedActivityWithSimilarRelationshipsToUri IS NOT NULL RETURN COUNT(*)")
        self.assertEqual(merged_before, [[0]])
        r.merge_equivalent_activities()
        cnts_after, _ = db.cypher_query("MATCH (a)-[x]-(b) RETURN COUNT(x), SUM(x.weight)")
        cnt1 = cnts_after[0][0]
        weights1 = cnts_after[0][1] 
        self.assertEqual(cnt1, cnt0 + 2)
        self.assertEqual(weights1, weights0 + 12)     
        merged_after, _ = db.cypher_query("MATCH (a) WHERE a.internalMergedActivityWithSimilarRelationshipsToUri IS NOT NULL RETURN COUNT(*)")
        self.assertEqual(merged_after, [[2]]) # other 2 were merged into this one
        processed_docs, _ = db.cypher_query("MATCH (a) WHERE a.internalMergedActivityWithSimilarRelationshipsAt IS NOT NULL RETURN COUNT(*)")
        self.assertEqual(processed_docs, [[3]])

class MergeSubsetActivitiesTestCase(TestCase):

    '''
    Query created with:

    1. Remove not-needed embeddings fields, e.g.:
    match (n: Resource)-[r]-(o) where n.internalDocId in [5302873, 5293762, 5302672, 4782968, 2427985, 2421653]
    remove o.representative_doc_embedding
    remove n.industry_embedding
    remove o.industry_embedding

    2. Export with
    CALL apoc.export.cypher.query( 
    "match (n: Resource)-[r]-(o) where n.internalDocId in [5302873, 5293762, 5302672, 4782968, 2427985, 2421653] return *",
    null,
    {format: "plain", stream:true})

    Then edited to remove un-needed indexes, add IF NOT EXISTS and remove quoted " from text field
    '''
    cypher_queries = """CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;
            UNWIND [{uri:"https://1145.am/db/2427985/Kent_Mathieu", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["Kent Mathieu"], name:["Kent Mathieu"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/5302672/Stephen_Dacus", properties:{internalDocId:5302672, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Stephen Dacus"], name:["Stephen Dacus"], basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/5302672/Ryuichi_Isaka", properties:{basedInHighClean:["Japan"], internalDocId:5302672, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Ryuichi Isaka"], name:["Ryuichi Isaka"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2421653/Guy_Smith", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Guy Smith"], name:["Guy Smith"], basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/2421653/Mark_Harris", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Mark Harris"], name:["Mark Harris"], basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/2421653/Bobby_Klimuszko", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Bobby Klimuszko (aka Bobby K)", "Bobby K)", "Bobby Klimuszko"], name:["Bobby Klimuszko"], basedInLowRaw:["Orlando"]}}, {uri:"https://1145.am/db/2421653/Chad_Groshart", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Chad Groshart"], name:["Chad Groshart"], basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/2421653/Andre_Yew", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Andre Yew"], name:["Andre Yew"], basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/2421653/Heather_Stagl", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Heather Stagl"], name:["Heather Stagl"], basedInLowRaw:["US"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Person;
            UNWIND [{uri:"https://1145.am/db/geonames_location/4482348", properties:{featureCode:"ADM1", deletedRedundantSameAsAt:1, countryCode:"US", name:["North Carolina"], geoNamesId:4482348, admin1Code:"NC"}}, {uri:"https://1145.am/db/geonames_location/4167147", properties:{featureCode:"PPLA2", deletedRedundantSameAsAt:1, countryCode:"US", name:["Orlando"], geoNamesId:4167147, admin1Code:"FL"}}, {uri:"https://1145.am/db/geonames_location/6252001", properties:{featureCode:"PCLI", deletedRedundantSameAsAt:1, countryCode:"US", name:["United States"], geoNamesId:6252001, admin1Code:"00"}}, {uri:"https://1145.am/db/geonames_location/1861060", properties:{featureCode:"PCLI", deletedRedundantSameAsAt:1, countryCode:"JP", name:["Japan"], geoNamesId:1861060, admin1Code:"00"}}, {uri:"https://1145.am/db/geonames_location/4499379", properties:{featureCode:"PPLA2", deletedRedundantSameAsAt:1, countryCode:"US", name:["Wilmington"], geoNamesId:4499379, admin1Code:"NC"}}, {uri:"https://1145.am/db/geonames_location/5098278", properties:{featureCode:"PPLA2", deletedRedundantSameAsAt:1, countryCode:"US", name:["Freehold"], geoNamesId:5098278, admin1Code:"NJ"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:GeoNamesLocation;
            UNWIND [{uri:"https://1145.am/db/2427985/Uv_Fx-Art_Director", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["art director"], name:["Art Director"], orgFoundName:["UV/FX"]}}, {uri:"https://1145.am/db/2427985/Wildfire-Art_Director", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["art director"], name:["Art Director"], orgFoundName:["Wildfire"]}}, {uri:"https://1145.am/db/2427985/Uv_Fx-Creative_Director", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["creative director"], name:["Creative Director"], orgFoundName:["UV/FX"]}}, {uri:"https://1145.am/db/2427985/Wildfire-Creative_Director", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["creative director"], name:["Creative Director"], orgFoundName:["Wildfire"]}}, {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive", properties:{internalDocId:5302672, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["chief executive"], name:["Chief Executive"], orgFoundName:["Seven & i"]}}, {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["LC exam"], name:["Lc Exam"], orgFoundName:["NCQLP"]}}, {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["rental rep"], name:["Rental Rep"], orgFoundName:["Christie Lites Orlando"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Role;
            UNWIND [{uri:"https://1145.am/db/industry/619_reservations_reservation_restaurant_booking", properties:{topicId:619, uniqueName:"619_reservations_reservation_restaurant_booking", deletedRedundantSameAsAt:1, representativeDoc:["Restaurant Reservation Service", "Restaurant Reservation Platform", "Restaurant Reservation"], representation:["", "meal", "booking", "reservations", "service", "restaurant", "reservation", "bookings"]}}, {uri:"https://1145.am/db/industry/176_grocery_groceries_supermarket_supermarkets", properties:{topicId:176, uniqueName:"176_grocery_groceries_supermarket_supermarkets", deletedRedundantSameAsAt:1, representativeDoc:["Grocery", "Grocery Business", "Food And Grocery"], representation:["retailers", "supermarket", "grocer", "grocers", "grocery", "retailing", "supermarkets", "groceries", "retail", "shopping"]}}, {uri:"https://1145.am/db/industry/463_grocery_supermarket_ecommerce_online", properties:{topicId:463, uniqueName:"463_grocery_supermarket_ecommerce_online", deletedRedundantSameAsAt:1, representativeDoc:["Online Grocery Technology", "Online Grocery Platform", "Online Grocery"], representation:["market", "supermarket", "grocer", "ecommerce", "grocery", "online", "commerce", "food", "retail", "shopping"]}}, {uri:"https://1145.am/db/industry/337_restaurant_software_hospitality_catering", properties:{topicId:337, uniqueName:"337_restaurant_software_hospitality_catering", deletedRedundantSameAsAt:1, representativeDoc:["Restaurant Software", "Restaurant-Software", "Restaurant Management"], representation:["tech", "technologies", "software", "management", "solutions", "restaurant", "catering", "hospitality", "technology", "food"]}}, {uri:"https://1145.am/db/industry/427_convenience_retail_stores_retailer", properties:{topicId:427, uniqueName:"427_convenience_retail_stores_retailer", deletedRedundantSameAsAt:1, representativeDoc:["Convenience Store", "Convenience Store Industry", "Convenience Store Operator"], representation:["", "cashierless", "retailer", "stores", "convenience", "store", "operator", "retail"]}}, {uri:"https://1145.am/db/industry/233_restaurant_restaurants_restauranteurs_eatery", properties:{topicId:233, uniqueName:"233_restaurant_restaurants_restauranteurs_eatery", deletedRedundantSameAsAt:1, representativeDoc:["Restaurant", "Restaurant Business", "Restaurant Industry"], representation:["eatery", "restaurateur", "dining", "restauranteurs", "restaurant", "restaurateurs", "hospitality", "restaurants", "eateries", "foodservice"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:IndustryCluster;
            UNWIND [{uri:"https://www.prnewswire.com/news-releases/local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555.html", properties:{deletedRedundantSameAsAt:1}}, {uri:"https://www.livedesignonline.com/smoke-signals-from-wildfire", properties:{deletedRedundantSameAsAt:1}}, {uri:"https://1145.am/db/5289666/Seven_I_Holdings", properties:{deletedRedundantSameAsAt:1.741096690458789E9}}, {uri:"https://www.prweb.com/releases/harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894.html", properties:{deletedRedundantSameAsAt:1.7411599029903545E9}}, {uri:"https://www.reuters.com/markets/deals/bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06/", properties:{deletedRedundantSameAsAt:1.7413416403251095E9}}, {uri:"https://www.reuters.com/business/retail-consumer/japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06/", properties:{deletedRedundantSameAsAt:1.7413416403251095E9}}, {uri:"https://www.livedesignonline.com/biz-bytes-6", properties:{deletedRedundantSameAsAt:1}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties;
            UNWIND [{uri:"https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director", properties:{documentDate:datetime('1997-04-01T12:00:00Z'), internalDocId:2427985, roleHolderFoundName:["Kent Mathieu"], deletedRedundantSameAsAt:1, roleFoundName:["creative director"], foundName:["joins"], documentExtract:"Kent Mathieu, Wildfire's art director, has also departed the firm, and joins UV/FX as creative director.", name:["Joins"], activityType:["starting"], orgFoundName:["Wildfire", "UV/FX"], status:["completed"]}}, {uri:"https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director", properties:{documentDate:datetime('1997-04-01T12:00:00Z'), internalDocId:2427985, roleHolderFoundName:["Kent Mathieu"], deletedRedundantSameAsAt:1, roleFoundName:["art director"], foundName:["joins"], documentExtract:"Kent Mathieu, Wildfire's art director, has also departed the firm, and joins UV/FX as creative director.", name:["Joins"], activityType:["finishing"], orgFoundName:["Wildfire", "UV/FX"], status:["completed"]}}, {uri:"https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive", properties:{documentDate:datetime('2025-03-06T16:10:33.111Z'), deletedRedundantSameAsAt:1.7413416403251095E9, when:[localdatetime('2025-05-27T00:00:00')], whenRaw:["May 27"], whereHighRaw:["Japanese"], whereHighClean:["Japan"], internalDocId:5302672, roleHolderFoundName:["Stephen Dacus"], roleFoundName:["chief executive"], documentExtract:"Seven & i Holdings (3382.T) , opens new tab, the Japanese operator of the 7-Eleven convenience store chain, appointed its first foreign CEO and handed him the task of overhauling its business to fend off a $ 47 billion overseas take over bid and engineer a recovery.", foundName:["succeed"], name:["Succeed"], activityType:["starting"], orgFoundName:["Seven & i"], status:["unknown"]}}, {uri:"https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive", properties:{documentDate:datetime('2025-03-06T16:10:33.111Z'), deletedRedundantSameAsAt:1.7413416403251095E9, when:[localdatetime('2025-05-27T00:00:00')], whenRaw:["May 27"], whereHighRaw:["Japanese"], whereHighClean:["Japan"], internalDocId:5302672, roleHolderFoundName:["Ryuichi Isaka"], roleFoundName:["chief executive"], documentExtract:"Seven & i Holdings (3382.T) , opens new tab, the Japanese operator of the 7-Eleven convenience store chain, appointed its first foreign CEO and handed him the task of overhauling its business to fend off a $ 47 billion overseas take over bid and engineer a recovery.", foundName:["succeed"], name:["Succeed"], orgFoundName:["Seven & i"], status:["unknown"]}}, {uri:"https://1145.am/db/2421653/Guy_Smith-Finishing-Lc_Exam", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, roleHolderFoundName:["Guy Smith"], deletedRedundantSameAsAt:1, roleFoundName:["LC exam"], foundName:["passed"], documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", name:["Passed"], activityType:["finishing"], orgFoundName:["NCQLP"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Andre_Yew-Finishing-Lc_Exam", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, roleHolderFoundName:["Andre Yew"], deletedRedundantSameAsAt:1, roleFoundName:["LC exam"], foundName:["passed"], documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", name:["Passed"], activityType:["finishing"], orgFoundName:["NCQLP"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Mark_Harris-Finishing-Lc_Exam", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, roleHolderFoundName:["Mark Harris"], deletedRedundantSameAsAt:1, roleFoundName:["LC exam"], foundName:["passed"], documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", name:["Passed"], activityType:["finishing"], orgFoundName:["NCQLP"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Chad_Groshart-Finishing-Lc_Exam", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, roleHolderFoundName:["Chad Groshart"], deletedRedundantSameAsAt:1, roleFoundName:["LC exam"], foundName:["passed"], documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", name:["Passed"], activityType:["finishing"], orgFoundName:["NCQLP"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Resign-Rental_Rep", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), deletedRedundantSameAsAt:1, whereHighRaw:["Orlando"], whereHighClean:["Orlando"], internalDocId:2421653, roleHolderFoundName:["Bobby Klimuszko"], roleFoundName:["rental rep"], foundName:["appointed"], documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", name:["Appointed"], activityType:["resign"], orgFoundName:["Christie Lites"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Appoint-Rental_Rep", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), deletedRedundantSameAsAt:1, whereHighRaw:["Orlando"], whereHighClean:["Orlando"], internalDocId:2421653, roleHolderFoundName:["Bobby Klimuszko"], roleFoundName:["rental rep"], foundName:["appointed"], documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", name:["Appointed"], activityType:["appoint"], orgFoundName:["Christie Lites"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Starting-Rental_Rep", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), deletedRedundantSameAsAt:1, whereHighRaw:["Orlando"], whereHighClean:["Orlando"], internalDocId:2421653, roleHolderFoundName:["Bobby Klimuszko"], roleFoundName:["rental rep"], foundName:["appointed"], documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", name:["Appointed"], activityType:["starting"], orgFoundName:["Christie Lites"], status:["completed"]}}, {uri:"https://1145.am/db/2421653/Heather_Stagl-Finishing-Lc_Exam", properties:{documentDate:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, roleHolderFoundName:["Heather Stagl"], deletedRedundantSameAsAt:1, roleFoundName:["LC exam"], foundName:["passed"], documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", name:["Passed"], activityType:["finishing"], orgFoundName:["NCQLP"], status:["completed"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:RoleActivity;
            UNWIND [{uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington", properties:{documentDate:datetime('2025-03-04T19:30:00Z'), deletedRedundantSameAsAt:1.7411599029903545E9, locationType:["Site"], whenRaw:["March 7-9"], whereHighRaw:["N.C."], locationPurpose:["Fuel Center"], whereHighClean:["North Carolina"], internalDocId:5293762, locationFoundName:["Wilmington, N.C."], documentExtract:"MATTHEWS, N.C., March 4, 2025 /PRNewswire-PRWeb/ - Harris Teeter is proud to welcome customers to its Lumina Commons Fuel Center in Wilmington, N.C., as the company celebrates its grand opening March 7-9 with a $ 0.40 off per gallon promotion.", name:["Added Wilmington"], activityType:["added"], orgFoundName:["Harris Teeter"], status:["completed"]}}, {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons", properties:{documentDate:datetime('2025-03-04T19:30:00Z'), deletedRedundantSameAsAt:1.7411599029903545E9, locationType:["Site"], when:[localdatetime('2025-03-04T00:00:00')], whenRaw:["March 4, 2025"], whereHighRaw:["Wilmington, N.C."], whereHighClean:["Wilmington"], internalDocId:5293762, locationFoundName:["Lumina Commons"], documentExtract:"MATTHEWS, N.C., March 4, 2025 /PRNewswire-PRWeb/ - Harris Teeter is proud to welcome customers to its Lumina Commons Fuel Center in Wilmington, N.C., as the company celebrates its grand opening March 7-9 with a $ 0.40 off per gallon promotion.", name:["Added Lumina Commons"], activityType:["added"], orgFoundName:["Harris Teeter"], status:["completed"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:LocationActivity;
            UNWIND [{uri:"https://1145.am/db/5293762/Lumina_Commons", properties:{basedInHighClean:["Wilmington"], internalDocId:5293762, deletedRedundantSameAsAt:1.7411599029903545E9, foundName:["Lumina Commons"], name:["Lumina Commons"], basedInHighRaw:["Wilmington, N.C."]}}, {uri:"https://1145.am/db/5293762/Wilmington", properties:{basedInHighClean:["North Carolina"], nameClean:["Wilmington"], internalDocId:5293762, deletedRedundantSameAsAt:1.7411599029903545E9, foundName:["Wilmington, N.C."], name:["Wilmington"], basedInHighRaw:["N.C."]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Site;
            UNWIND [{uri:"https://1145.am/db/4754475/Bain_Company", properties:{internalDocId:4754475, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain & Company", "Bain"], description:["consulting", "helping clients across industries to identify and realize AI's full potential"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/2619204/Bain", properties:{internalDocId:2619204, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/4893178/Bain_Company", properties:{internalDocId:4893178, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["private equity and institutional investor clients"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company"}}, {uri:"https://1145.am/db/3406343/Bain_Company", properties:{internalDocId:3406343, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4869445/Bain", properties:{basedInHighClean:["Commonwealth of Australia"], internalDocId:4869445, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "BAIN & COMPANY"], name:["BAIN", "Bain"], description:["consulting", "procurement"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Australia"]}}, {uri:"https://1145.am/db/4492959/Bain", properties:{basedInHighClean:["Zürich"], internalDocId:4492959, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["Financial Services"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Zurich"]}}, {uri:"https://1145.am/db/4494990/Bain_Company", properties:{basedInHighClean:["Amsterdam"], internalDocId:4494990, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting firm"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Amsterdam"]}}, {uri:"https://1145.am/db/4493941/Bain", properties:{basedInHighClean:["Kingdom of the Netherlands"], internalDocId:4493941, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Netherlands"]}}, {uri:"https://1145.am/db/1624679/Bain_Company", properties:{internalDocId:1624679, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4492789/Bain_Company", properties:{basedInHighClean:["Rome"], internalDocId:4492789, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["management consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Rome"]}}, {uri:"https://1145.am/db/516997/Bain_Company", properties:{internalDocId:516997, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["private equity and institutional investor clients"]}}, {uri:"https://1145.am/db/4495181/Bain_Company", properties:{internalDocId:4495181, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], basedInLowRaw:["Italian"]}}, {uri:"https://1145.am/db/4493623/Bain_Company", properties:{internalDocId:4493623, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], basedInLowRaw:["France"]}}, {uri:"https://1145.am/db/4864316/Bain", properties:{internalDocId:4864316, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["Consulting"], industry:["management consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4492640/Bain", properties:{internalDocId:4492640, deletedRedundantSameAsAt:1, foundName:["Bain'"], name:["Bain"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/2506663/Bain_Company", properties:{internalDocId:2506663, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consultancy"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4495196/Bain_Company", properties:{internalDocId:4495196, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting and industry roles"], industry:["consulting"], basedInLowRaw:["South Africa"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4494722/Bain_Company", properties:{internalDocId:4494722, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInLowRaw:["Italy"]}}, {uri:"https://1145.am/db/4857045/Bain_Company", properties:{internalDocId:4857045, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Financial Services"], industry:["Financial Services"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company"}}, {uri:"https://1145.am/db/4495895/Bain_Company", properties:{internalDocId:4495895, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/1056343/Bain", properties:{internalDocId:1056343, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], industry:["private equity firms"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company", basedInLowRaw:["Singapore"]}}, {uri:"https://1145.am/db/4495595/Bain_Company", properties:{basedInHighClean:["Federal Republic of Germany"], internalDocId:4495595, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Germany"]}}, {uri:"https://1145.am/db/4493721/Bain", properties:{internalDocId:4493721, deletedRedundantSameAsAt:1, foundName:["& Company"], name:["Bain"], description:["customer experience"], industry:["consultancy"], basedInLowRaw:["Netherlands"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/1392421/Bain", properties:{internalDocId:1392421, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain"], description:["business"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4495307/Bain_Company", properties:{internalDocId:4495307, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Strategy"], industry:["consultancy"], basedInLowRaw:["Austria"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4494437/Bain_Company", properties:{basedInHighClean:["Kingdom of the Netherlands"], internalDocId:4494437, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Netherlands"]}}, {uri:"https://1145.am/db/3132966/Bain_Company", properties:{internalDocId:3132966, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["private equity industry"], industry:["private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company"}}, {uri:"https://1145.am/db/4494413/Bain_Company", properties:{internalDocId:4494413, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInLowRaw:["Italy"]}}, {uri:"https://1145.am/db/4495134/Bain_Company", properties:{internalDocId:4495134, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], basedInLowRaw:["France"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4646717/Bain", properties:{internalDocId:4646717, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company"}}, {uri:"https://1145.am/db/2892265/Bain", properties:{internalDocId:2892265, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["private equity"], industry:["private equity"], basedInLowRaw:["US"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company"}}, {uri:"https://1145.am/db/4496098/Bain_Company", properties:{basedInHighClean:["Brussels"], internalDocId:4496098, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Brussels"]}}, {uri:"https://1145.am/db/4495239/Bain_Company", properties:{internalDocId:4495239, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], basedInLowRaw:["France"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4896010/Bain_Company", properties:{internalDocId:4896010, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain & Company", "Bain"], description:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4493803/Bain", properties:{internalDocId:4493803, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company", basedInLowRaw:["Israel"]}}, {uri:"https://1145.am/db/4493272/Bain_Company", properties:{basedInHighClean:["Amsterdam"], internalDocId:4493272, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Strategic consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Amsterdam"]}}, {uri:"https://1145.am/db/3237070/Bain_Company", properties:{internalDocId:3237070, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["private equity"], industry:["private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company"}}, {uri:"https://1145.am/db/4493875/Bain_Company", properties:{internalDocId:4493875, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["management consulting"], industry:["consulting"], basedInLowRaw:["France"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4494252/Bain", properties:{internalDocId:4494252, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company"}}, {uri:"https://1145.am/db/4692047/Bain_Company", properties:{internalDocId:4692047, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInLowRaw:["Houston"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4999377/Bain_Company", properties:{internalDocId:4999377, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4495464/Bain_Company", properties:{internalDocId:4495464, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], basedInLowRaw:["Germany"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/1269514/Bain", properties:{internalDocId:1269514, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["life sciences"], industry:["management consultancy"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/3384040/Bain_Company", properties:{internalDocId:3384040, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], industry:["consultancy"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4493026/Bain_Company", properties:{basedInHighClean:["Federal Republic of Germany"], internalDocId:4493026, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy, organisation, mergers and acquisitions, operations, digital and sustainability among other areas"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Germany"]}}, {uri:"https://1145.am/db/4999376/Bain_Company", properties:{internalDocId:4999376, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain & Company"], description:["Wealth & Asset Management", "investment advisory"], industry:["investment advisory"], basedInLowRaw:["Italy"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4899805/Bain_Company", properties:{internalDocId:4899805, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4494473/Bain_Company", properties:{basedInHighClean:["Kingdom of Norway"], internalDocId:4494473, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy and management consulting firm"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Norway"]}}, {uri:"https://1145.am/db/4495955/Bain_Company", properties:{basedInHighClean:["Düsseldorf"], internalDocId:4495955, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Dusseldorf"]}}, {uri:"https://1145.am/db/4495807/Bain_Company", properties:{internalDocId:4495807, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["management consulting"], industry:["consulting"], basedInLowRaw:["Belgium"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4495159/Bain_Company", properties:{basedInHighClean:["United States"], internalDocId:4495159, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["US"]}}, {uri:"https://1145.am/db/4494772/Bain_Company", properties:{internalDocId:4494772, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInLowRaw:["Italy"]}}, {uri:"https://1145.am/db/1080772/Bain_Company", properties:{internalDocId:1080772, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Financial Services"], industry:["Financial Services"], internalMergedSameAsHighToUri:"https://1145.am/db/1042241/Bain"}}, {uri:"https://1145.am/db/4492676/Bain", properties:{internalDocId:4492676, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain"], description:["business consulting"], industry:["consulting"], basedInLowRaw:["Germany"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4493820/Bain_Company", properties:{basedInHighClean:["Kingdom of Belgium"], internalDocId:4493820, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Belgium"]}}, {uri:"https://1145.am/db/4492611/Bain_Company", properties:{basedInHighClean:["Amsterdam"], internalDocId:4492611, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Amsterdam"]}}, {uri:"https://1145.am/db/2892275/Bain", properties:{internalDocId:2892275, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["private equity"], industry:["private equity"], basedInLowRaw:["US"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company"}}, {uri:"https://1145.am/db/5006246/Bain_Company", properties:{internalDocId:5006246, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4492996/Bain", properties:{basedInHighClean:["Switzerland"], internalDocId:4492996, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain'"], name:["Bain"], description:["M & A strategies, due diligence, and value creation for portfolio companies"], industry:["private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company", basedInHighRaw:["Switzerland"]}}, {uri:"https://1145.am/db/4724292/Bain", properties:{internalDocId:4724292, deletedRedundantSameAsAt:1, foundName:["Bain & Company", "Bain"], name:["Bain"], description:["strategy and digital application delivery"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/3525963/Bain", properties:{internalDocId:3525963, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["a hostile offer"], basedInLowRaw:["Switzerland"]}}, {uri:"https://1145.am/db/4494705/Bain_Company", properties:{basedInHighClean:["Rome"], internalDocId:4494705, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Rome"]}}, {uri:"https://1145.am/db/1124271/Bain_Company", properties:{internalDocId:1124271, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["CFO"]}}, {uri:"https://1145.am/db/4495179/Bain_Company", properties:{basedInHighClean:["Republic of France"], internalDocId:4495179, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["France"]}}, {uri:"https://1145.am/db/4493964/Bain_Company", properties:{basedInHighClean:["Munich"], internalDocId:4493964, deletedRedundantSameAsAt:1, foundName:["Bain & Company'"], name:["Bain & Company"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Munich"]}}, {uri:"https://1145.am/db/4774607/Bain", properties:{internalDocId:4774607, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4493761/Bain_Company", properties:{internalDocId:4493761, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consultancy"], basedInLowRaw:["Nordic"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/4492839/Bain_Company", properties:{basedInHighClean:["Paris"], internalDocId:4492839, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Paris"]}}, {uri:"https://1145.am/db/4495032/Bain_Company", properties:{basedInHighClean:["Brussels"], internalDocId:4495032, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Brussels"]}}, {uri:"https://1145.am/db/4458801/Seven_I_Holdings", properties:{internalDocId:4458801, deletedRedundantSameAsAt:1, foundName:["Seven & I", "Seven & I Holdings"], name:["Seven & I Holdings"], description:["7-Eleven"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Canada", "Japan"]}}, {uri:"https://1145.am/db/4458715/Seven_I_Holdings", properties:{basedInHighClean:["Tokyo"], internalDocId:4458715, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["retail"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Tokyo"]}}, {uri:"https://1145.am/db/4462096/Seven_I_Holdings", properties:{internalDocId:4462096, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["Japanese company"], industry:["convenience store"], basedInLowRaw:["Japanese"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/4470702/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4470702, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4480339/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4480339, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["convenience store chain"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4482983/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4482983, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings SVNDY"], name:["Seven & i", "Seven & i Holdings"], industry:["convenience stores"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japan"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/3667481/Bain", properties:{internalDocId:3667481, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["Private equity"], industry:["Private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital"}}, {uri:"https://1145.am/db/1637680/Bain_Company", properties:{basedInHighClean:["Boston"], internalDocId:1637680, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["BOSTON"]}}, {uri:"https://1145.am/db/3072302/Bain", properties:{internalDocId:3072302, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["private equity"], industry:["private equity"], basedInLowRaw:["Basque region"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital"}}, {uri:"https://1145.am/db/782708/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:782708, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["investment"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/853203/Bain", properties:{internalDocId:853203, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["consulting"], industry:["consulting"], basedInLowRaw:["Australia"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4507567/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:4507567, deletedRedundantSameAsAt:1, foundName:["Seven & I", "Seven & i Holdings", "Seven & i Holdings Co"], name:["Seven & I Holdings", "Seven & i Holdings", "Seven & i Holdings Co"], description:["business"], industry:["convenience store operator", "convenience store"], basedInLowRaw:["Canada"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4509386/Seven_I_Holdings_Co", properties:{internalDocId:4509386, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co.", "7", "7-Eleven"], name:["Seven & i Holdings Co."], industry:["convenience store operator"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/4511335/Seven_I_Holdings", properties:{internalDocId:4511335, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings SVNDY"], name:["Seven & i Holdings"], basedInLowRaw:["Laval, Que."]}}, {uri:"https://1145.am/db/4511287/Seven_I_Holdings_Co", properties:{internalDocId:4511287, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co."], name:["Seven & i Holdings Co."], industry:["convenience store operator"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Laval, Que."]}}, {uri:"https://1145.am/db/4516271/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4516271, deletedRedundantSameAsAt:1, foundName:["Seven & I", "Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["7-Eleven stores"], industry:["convenience-store operator", "convenience stores"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Canada"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4520211/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4520211, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i", "Seven & i Holdings"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2407503/Uv_Fx", properties:{internalDocId:2407503, deletedRedundantSameAsAt:1, foundName:["UV/FX"], name:["UV/FX"], basedInLowRaw:["California"]}}, {uri:"https://1145.am/db/2430824/Uv_Fx", properties:{internalDocId:2430824, deletedRedundantSameAsAt:1, foundName:["UV/FX"], name:["UV/FX"], description:["film"]}}, {uri:"https://1145.am/db/2430824/Wildfire", properties:{internalDocId:2430824, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["music"]}}, {uri:"https://1145.am/db/1848556/Wildfire", properties:{internalDocId:1848556, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], industry:["social marketer"], internalMergedSameAsHighToUri:"https://1145.am/db/1824305/Wildfire"}}, {uri:"https://1145.am/db/2397277/Uv_Fx", properties:{internalDocId:2397277, deletedRedundantSameAsAt:1, foundName:["UVFX", "UV/FX"], name:["UVFX", "UV/FX"], description:["designing with ultraviolet sensitive materials for stage, television, and themed environments", "designing with ultraviolet sensitive materials"], basedInLowRaw:["Chicago"]}}, {uri:"https://1145.am/db/1717317/Bain", properties:{internalDocId:1717317, deletedRedundantSameAsAt:1, foundName:["Bain, the Chainsmokers' Mantis VC"], name:["Bain"], description:["Investing"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital"}}, {uri:"https://1145.am/db/2663848/Bain", properties:{internalDocId:2663848, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital", basedInLowRaw:["Sweden"]}}, {uri:"https://1145.am/db/3319835/Bain_Company", properties:{basedInHighClean:["Boston"], internalDocId:3319835, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["private equity, consumer products, energy, finance, and technology"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital", basedInHighRaw:["BOSTON"]}}, {uri:"https://1145.am/db/3438908/Bain_Company", properties:{basedInHighClean:["New York City"], internalDocId:3438908, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], basedInHighRaw:["New York"]}}, {uri:"https://1145.am/db/1348970/Bain", properties:{basedInHighClean:["New York City"], internalDocId:1348970, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["business consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["New York"]}}, {uri:"https://1145.am/db/3092295/Bain", properties:{internalDocId:3092295, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["private equity"], industry:["private equity"], basedInLowRaw:["US"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital"}}, {uri:"https://1145.am/db/939089/Bain_Company", properties:{basedInHighClean:["London"], internalDocId:939089, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Management consulting"], industry:["management consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["London"]}}, {uri:"https://1145.am/db/3537547/Bain_Company", properties:{basedInHighClean:["Houston"], internalDocId:3537547, deletedRedundantSameAsAt:1, foundName:["Bain & Company'"], name:["Bain & Company"], basedInHighRaw:["Houston"]}}, {uri:"https://1145.am/db/1403515/Bain_Company", properties:{basedInHighClean:["London", "Boston"], internalDocId:1403515, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital", basedInHighRaw:["BOSTON and LONDON"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/963546/Bain_Company", properties:{basedInHighClean:["Washington"], internalDocId:963546, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["WASHINGTON"]}}, {uri:"https://1145.am/db/3603953/Bain", properties:{basedInHighClean:["New York City"], internalDocId:3603953, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital", basedInHighRaw:["New York"]}}, {uri:"https://1145.am/db/360986/Bain", properties:{internalDocId:360986, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/3119138/Bain_Company", properties:{basedInHighClean:["New York City"], internalDocId:3119138, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["a business consultant"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["NEW YORK"]}}, {uri:"https://1145.am/db/2650891/Bain", properties:{internalDocId:2650891, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], industry:["private equity funds"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital", basedInLowRaw:["Brazil"]}}, {uri:"https://1145.am/db/209835/Harris_Teeter", properties:{internalDocId:209835, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/863280/Harris_Teeter", properties:{internalDocId:863280, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter", basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/383223/Harris_Teeter", properties:{internalDocId:383223, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["shopper"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/4614792/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4614792, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings SVNDY"], name:["Seven & i Holdings"], description:["Retailing"], industry:["retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4590040/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4590040, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["conglomerate"], industry:["supermarket", "retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4570635/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4570635, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["business"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4593230/Seven_I_Holdings_Co", properties:{internalDocId:4593230, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co.", "SVNDY", "Seven & i Holdings Co", "& i"], name:["Seven & i Holdings Co.", "Seven & i Holdings", "Seven & i Holdings Co", "Seven"], description:["Japanese retailer", "Business"], industry:["Retail", "convenience stores", "retailer"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/4579781/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:4579781, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co.", "Seven & i Holdings Co. SVNDY"], name:["Seven & i Holdings Co."], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1400257/Wildfire", properties:{internalDocId:1400257, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"]}}, {uri:"https://1145.am/db/1511122/Harris_Teeter", properties:{internalDocId:1511122, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["retail partner"], industry:["retail"], basedInLowRaw:["United States"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter"}}, {uri:"https://1145.am/db/4617195/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:4617195, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co. SVNDY Ltd."], name:["Seven & i Holdings Co."], description:["business"], industry:["convenience-store business"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4621016/Seven_I_Holdings_Co", properties:{internalDocId:4621016, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co"], name:["Seven & i Holdings Co"], description:["business"], industry:["retailer"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/2920747/Wildfire", properties:{internalDocId:2920747, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["social marketing"], industry:["social marketing"], internalMergedSameAsHighToUri:"https://1145.am/db/1824305/Wildfire"}}, {uri:"https://1145.am/db/2082743/Harris_Teeter", properties:{internalDocId:2082743, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], basedInLowRaw:["Metrolina"]}}, {uri:"https://1145.am/db/2017319/Harris_Teeter", properties:{internalDocId:2017319, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Corporate Affairs"], industry:["Retail"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4628816/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4628816, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings", "& i"], name:["Seven & i", "Seven & i Holdings", "Seven"], description:["business"], industry:["Retailer", "convenience stores", "retailer"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4640231/Seven_And_I_Holdings", properties:{internalDocId:4640231, deletedRedundantSameAsAt:1, foundName:["Seven and i Holdings"], name:["Seven and i Holdings"], description:["Acquisition"], basedInLowRaw:["TOKYO"]}}, {uri:"https://1145.am/db/4783010/Better-for-You_Restaurant", properties:{basedInHighClean:["Midland"], internalDocId:4783010, deletedRedundantSameAsAt:1, foundName:["Better-for-You Restaurant"], name:["Better-for-You Restaurant"], industry:["restaurant"], basedInHighRaw:["Midland, GA."]}}, {uri:"https://1145.am/db/4740244/Wildfire", properties:{basedInHighClean:["Raleigh"], internalDocId:4740244, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["cashback rewards"], basedInHighRaw:["RALEIGH, N.C."]}}, {uri:"https://1145.am/db/2427985/Uv_Fx", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["UV/FX"], name:["UV/FX"], description:["a creative director"]}}, {uri:"https://1145.am/db/4940869/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4940869, deletedRedundantSameAsAt:1, foundName:["Seven & I", "Seven & I Holdings", "& I"], name:["Seven & I", "Seven & I Holdings", "Seven"], description:["banking"], industry:["banking"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4965136/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4965136, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings SVNDY"], name:["Seven & i Holdings"], description:["business"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2416227/Uv_Fx", properties:{internalDocId:2416227, deletedRedundantSameAsAt:1, foundName:["UV/FX"], name:["UV/FX"], description:["music"], internalMergedSameAsHighToUri:"https://1145.am/db/2374911/Uv_Fx", basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/2374185/Wildfire_Inc", properties:{basedInHighClean:["Las Vegas"], internalDocId:2374185, deletedRedundantSameAsAt:1, foundName:["Wildfire Inc."], name:["Wildfire Inc."], description:["UV (ultraviolet, aka 'black light') effects for theater, themed entertainment"], industry:["live entertainment industries"], basedInHighRaw:["Las Vegas, NV"]}}, {uri:"https://1145.am/db/1701180/Wildfire", properties:{internalDocId:1701180, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["promotion"]}}, {uri:"https://1145.am/db/5001520/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5001520, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings", "Seven"], name:["Seven & i Holdings"], description:["investment firms"], industry:["retailer", "convenience store"], basedInLowRaw:["Canada", "Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4990084/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4990084, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["7-Eleven convenience stores around the world"], industry:["convenience stores", "retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5001949/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5001949, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience stores"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5007784/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:5007784, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings Co."], name:["Seven & i Holdings Co."], industry:["retailer", "convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5007768/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:5007768, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings Co."], name:["Seven & i Holdings Co."], description:["Japanese rival"], industry:["retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5014578/Seven_I_Holdings_Co", properties:{basedInHighClean:["Tokyo"], internalDocId:5014578, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings Co."], name:["Seven & i Holdings Co."], industry:["retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japan"], basedInHighRaw:["Tokyo"]}}, {uri:"https://1145.am/db/526078/Bain_Company", properties:{internalDocId:526078, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"]}}, {uri:"https://1145.am/db/723777/Harris_Teeter", properties:{internalDocId:723777, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter"}}, {uri:"https://1145.am/db/5045439/Bain", properties:{internalDocId:5045439, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["client work"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/929643/Harris_Teeter", properties:{internalDocId:929643, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/1137162/Harris_Teeter", properties:{internalDocId:1137162, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/1230504/Bain_Company", properties:{internalDocId:1230504, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["customer experience"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company"}}, {uri:"https://1145.am/db/4896992/Bain_Company", properties:{internalDocId:4896992, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/5069614/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5069614, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience stores"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4528307/Harris_Teeter", properties:{internalDocId:4528307, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["grocery shopping"], industry:["grocery"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter"}}, {uri:"https://1145.am/db/4592679/Harris_Teeter", properties:{internalDocId:4592679, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], industry:["Retail"], internalMergedSameAsHighToUri:"https://1145.am/db/383223/Harris_Teeter"}}, {uri:"https://1145.am/db/5144868/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5144868, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5139178/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:5139178, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings Co."], name:["Seven & i Holdings Co."], description:["retailer", "retail"], industry:["retailer", "retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5178644/Bain_Company", properties:{basedInHighClean:["Rome"], internalDocId:5178644, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["strategy consulting"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["Rome"]}}, {uri:"https://1145.am/db/1889110/Wildfire", properties:{internalDocId:1889110, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], industry:["social media marketing"], internalMergedSameAsHighToUri:"https://1145.am/db/1824305/Wildfire"}}, {uri:"https://1145.am/db/1880352/Wildfire", properties:{internalDocId:1880352, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], industry:["marketing platform"], internalMergedSameAsHighToUri:"https://1145.am/db/1824305/Wildfire"}}, {uri:"https://1145.am/db/1915974/Wildfire", properties:{internalDocId:1915974, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["marketing"], industry:["social media marketing"], internalMergedSameAsHighToUri:"https://1145.am/db/1701180/Wildfire"}}, {uri:"https://1145.am/db/2889580/Bain", properties:{basedInHighClean:["United States"], internalDocId:2889580, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], industry:["consultancy"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["U.S."]}}, {uri:"https://1145.am/db/2374911/Uv_Fx", properties:{internalDocId:2374911, deletedRedundantSameAsAt:1, foundName:["UV/FX"], name:["UV/FX"], description:["music"], basedInLowRaw:["Sweden"]}}, {uri:"https://1145.am/db/3621781/Bain_Company", properties:{basedInHighClean:["New York City"], internalDocId:3621781, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["NEW YORK"]}}, {uri:"https://1145.am/db/3380468/Bain_Company", properties:{internalDocId:3380468, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"]}}, {uri:"https://1145.am/db/3893284/Wildfire", properties:{internalDocId:3893284, deletedRedundantSameAsAt:1, foundName:["WildFire"], name:["WildFire"], description:["cyberthreats"], basedInLowRaw:["U.S"]}}, {uri:"https://1145.am/db/3604230/Harris_Teeter", properties:{internalDocId:3604230, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/187774/Harris_Teeter", properties:{internalDocId:187774, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["shopper"], industry:["Grocery"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/3294301/Harris_Teeter", properties:{internalDocId:3294301, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Food"], industry:["grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/362039/Harris_Teeter", properties:{basedInHighClean:["Gastonia"], internalDocId:362039, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["Gastonia, N.C."]}}, {uri:"https://1145.am/db/428028/Harris_Teeter", properties:{internalDocId:428028, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/354836/Harris_Teeter", properties:{internalDocId:354836, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["shopper"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/353533/Harris_Teeter", properties:{internalDocId:353533, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/301727/Harris_Teeter", properties:{internalDocId:301727, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/258613/Harris_Teeter", properties:{basedInHighClean:["North Carolina"], internalDocId:258613, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Pharmacy"], industry:["Pharmacy"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInHighRaw:["North Carolina"]}}, {uri:"https://1145.am/db/332718/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:332718, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/585329/Harris_Teeter", properties:{internalDocId:585329, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/769197/Harris_Teeter", properties:{internalDocId:769197, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/783409/Harris_Teeter", properties:{internalDocId:783409, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["non-profit organizations"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/4907409/Bain_Company", properties:{internalDocId:4907409, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Business"], internalMergedSameAsHighToUri:"https://1145.am/db/1080772/Bain_Company"}}, {uri:"https://1145.am/db/816439/Seven_I_Holdings", properties:{internalDocId:816439, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["business"], industry:["convenience-store chain"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/940278/Bain_Company", properties:{internalDocId:940278, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"]}}, {uri:"https://1145.am/db/1042241/Bain", properties:{basedInHighClean:["Boston"], internalDocId:1042241, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["business"], basedInHighRaw:["BOSTON"]}}, {uri:"https://1145.am/db/4816470/Bain", properties:{basedInHighClean:["Boston"], internalDocId:4816470, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain"], description:["business"], internalMergedSameAsHighToUri:"https://1145.am/db/1042241/Bain", basedInHighRaw:["BOSTON"]}}, {uri:"https://1145.am/db/981066/Bain_Company", properties:{basedInHighClean:["New York City"], internalDocId:981066, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain", basedInHighRaw:["NEW YORK"]}}, {uri:"https://1145.am/db/2008581/Harris_Teeter", properties:{internalDocId:2008581, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1452040/Harris_Teeter", properties:{internalDocId:1452040, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/1684131/Harris_Teeter", properties:{internalDocId:1684131, deletedRedundantSameAsAt:1, foundName:["Harris Teeter", "Teeter"], name:["Harris Teeter"], description:["retail operations"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1340262/Harris_Teeter", properties:{basedInHighClean:["Concord"], internalDocId:1340262, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["Concord, N.C."]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/1960096/Harris_Teeter", properties:{internalDocId:1960096, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["USO"]}}, {uri:"https://1145.am/db/1083822/Harris_Teeter", properties:{internalDocId:1083822, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["fundraising"], basedInLowRaw:["N.C"], internalMergedSameAsHighToUri:"https://1145.am/db/783409/Harris_Teeter"}}, {uri:"https://1145.am/db/1086847/Harris_Teeter", properties:{internalDocId:1086847, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["TIE program"], basedInLowRaw:["N.C"]}}, {uri:"https://1145.am/db/1974016/Harris_Teeter", properties:{basedInHighClean:["Parish of Charlotte"], internalDocId:1974016, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["drug take-back"], basedInHighRaw:["Charlotte"]}}, {uri:"https://1145.am/db/1467072/Harris_Teeter", properties:{internalDocId:1467072, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["shopper"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1105244/Harris_Teeter", properties:{internalDocId:1105244, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/1411385/Harris_Teeter", properties:{internalDocId:1411385, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a hot foods bar, salad bar, a sub shop, store-made pizza, and"], industry:["grocery"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1943512/Harris_Teeter", properties:{internalDocId:1943512, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["grocery store"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/2042603/Harris_Teeter", properties:{internalDocId:2042603, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/1232009/Harris_Teeter", properties:{basedInHighClean:["California"], internalDocId:1232009, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["California, M.D."]}}, {uri:"https://1145.am/db/1137030/Harris_Teeter", properties:{internalDocId:1137030, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/1965432/Harris_Teeter", properties:{internalDocId:1965432, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1499865/Harris_Teeter", properties:{internalDocId:1499865, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["Metrolina"]}}, {uri:"https://1145.am/db/2069176/Harris_Teeter", properties:{internalDocId:2069176, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/1648326/Harris_Teeter", properties:{internalDocId:1648326, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/1433118/Harris_Teeter", properties:{basedInHighClean:["Charlotte"], internalDocId:1433118, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["Charlotte, N.C."]}}, {uri:"https://1145.am/db/1824305/Wildfire", properties:{internalDocId:1824305, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], description:["marketing and ad campaigns"], industry:["social marketing"]}}, {uri:"https://1145.am/db/2761898/Bain_Company", properties:{internalDocId:2761898, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["US consultancy giant"], industry:["consultancy"], basedInLowRaw:["China"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/2761931/Bain_Company", properties:{basedInHighClean:["Boston"], internalDocId:2761931, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["global advisory firms"], industry:["global advisory firms"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company", basedInHighRaw:["Boston"]}}, {uri:"https://1145.am/db/1126783/Bain_Company", properties:{internalDocId:1126783, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/1396540/Bain_Company", properties:{basedInHighClean:["Boston"], internalDocId:1396540, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], description:["Business"], internalMergedSameAsHighToUri:"https://1145.am/db/1042241/Bain", basedInHighRaw:["BOSTON"]}}, {uri:"https://1145.am/db/3322662/Bain_Company", properties:{internalDocId:3322662, deletedRedundantSameAsAt:1, foundName:["Bain & Company"], name:["Bain & Company"], industry:["consulting"], internalMergedSameAsHighToUri:"https://1145.am/db/853203/Bain"}}, {uri:"https://1145.am/db/2060104/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:2060104, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["convenience store operator"], industry:["convenience store operator"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1225557/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:1225557, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co"], name:["Seven & i Holdings Co"], description:["retail"], industry:["Retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2115982/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:2115982, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a pharmacy"], industry:["Pharmacy"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/2108850/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:2108850, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["retail operations"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/2140656/Bain", properties:{basedInHighClean:["United States"], internalDocId:2140656, deletedRedundantSameAsAt:1, foundName:["Bain"], name:["Bain"], description:["private equity"], industry:["private equity"], internalMergedSameAsHighToUri:"https://1145.am/db/516997/Bain_Company", basedInHighRaw:["U.S."]}}, {uri:"https://1145.am/db/5243244/Wildfire", properties:{internalDocId:5243244, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"]}}, {uri:"https://1145.am/db/2819095/Harris_Teeter", properties:{internalDocId:2819095, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], internalMergedSameAsHighToUri:"https://1145.am/db/2082743/Harris_Teeter", basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/4029844/Harris_Teeter", properties:{internalDocId:4029844, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Supermarkets"], industry:["Supermarket"], basedInLowRaw:["United States"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/3119463/Harris_Teeter", properties:{internalDocId:3119463, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"]}}, {uri:"https://1145.am/db/3953824/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:3953824, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["health non-profit organizations"], internalMergedSameAsHighToUri:"https://1145.am/db/783409/Harris_Teeter", basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/2789086/Harris_Teeter", properties:{internalDocId:2789086, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], internalMergedSameAsHighToUri:"https://1145.am/db/2082743/Harris_Teeter"}}, {uri:"https://1145.am/db/4059507/Harris_Teeter", properties:{internalDocId:4059507, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["retail operations"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/2783269/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:2783269, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["drug take-back"], internalMergedSameAsHighToUri:"https://1145.am/db/1974016/Harris_Teeter", basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/4103698/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:4103698, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Food"], internalMergedSameAsHighToUri:"https://1145.am/db/2082743/Harris_Teeter", basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/3970939/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:3970939, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/4066967/Harris_Teeter", properties:{internalDocId:4066967, deletedRedundantSameAsAt:1.740529705680305E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["Giving back to the community"], basedInLowRaw:["N.C."]}}, {uri:"https://1145.am/db/2427985/Wildfire", properties:{internalDocId:2427985, deletedRedundantSameAsAt:1, foundName:["Wildfire"], name:["Wildfire"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/4183497/Harris_Teeter", properties:{internalDocId:4183497, deletedRedundantSameAsAt:1.7406036189731367E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["active duty military and their families, as well as wounded service members, those transitioning back to civilian"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4192448/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4192448, deletedRedundantSameAsAt:1.7406036189731367E9, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4282774/Harris_Teeter", properties:{basedInHighClean:["Matthews"], internalDocId:4282774, deletedRedundantSameAsAt:1.7407445831294847E9, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInHighRaw:["MATTHEWS, N.C."]}}, {uri:"https://1145.am/db/4384666/Harris_Teeter", properties:{internalDocId:4384666, deletedRedundantSameAsAt:1.7407445831294847E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["a company"]}}, {uri:"https://1145.am/db/4374614/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4374614, deletedRedundantSameAsAt:1.7407445831294847E9, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["business"], industry:["convenience-store business"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1956273/Seven_I_Holdings", properties:{internalDocId:1956273, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/3462173/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:3462173, deletedRedundantSameAsAt:1, foundName:["Seven & I Holdings"], name:["Seven & I Holdings"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2104165/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:2104165, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings Co.", "Seven & i Holdings"], name:["Seven & i Holdings"], industry:["retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2825662/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:2825662, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["retail"], industry:["retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1654243/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:1654243, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2068732/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:2068732, deletedRedundantSameAsAt:1, foundName:["Seven & i"], name:["Seven & i Holdings"], description:["business"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2103122/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:2103122, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i", "Seven & i Holdings"], description:["operator of the world's largest convenience store chain"], industry:["retailer", "convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1493845/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:1493845, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings Co Ltd"], name:["Seven & i Holdings"], description:["operator of 7-Eleven convenience stores and the Speedway gas station chain in the United States"], industry:["convenience stores"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5276194/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5276194, deletedRedundantSameAsAt:1.7407685593746521E9, foundName:["Seven & I", "Seven & I Holdings"], name:["Seven & I Holdings"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/332258/Seven_I_Holdings", properties:{internalDocId:332258, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["7-Eleven"], industry:["convenience store"], basedInLowRaw:["Japanese"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/5273757/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5273757, deletedRedundantSameAsAt:1.7407685593746521E9, foundName:["Seven & I", "Seven & i", "Seven & I Holdings"], name:["Seven & I Holdings"], industry:["retailer"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Canada"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5281024/Seven_I_Holdings", properties:{basedInHighClean:["Canada"], internalDocId:5281024, deletedRedundantSameAsAt:1.7407685593746521E9, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["convenience store owner"], industry:["convenience store owner"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/5273977/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:5273977, deletedRedundantSameAsAt:1.7407685593746521E9, foundName:["Seven & I", "Seven & i", "Seven & i Holdings Co. SVNDF"], name:["Seven & i Holdings Co."], description:["retail giant"], industry:["convenience stores", "retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Canada", "Japan"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/1976499/Seven_I_Holdings", properties:{internalDocId:1976499, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings (3382.T)"], name:["Seven & i Holdings"], description:["convenience store operator"], industry:["convenience store operator"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/1179523/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:1179523, deletedRedundantSameAsAt:1, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/331244/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:331244, deletedRedundantSameAsAt:1, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience store"], basedInHighRaw:["Japan"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4579956/Seven_I_Holdings_Co", properties:{basedInHighClean:["Japan"], internalDocId:4579956, deletedRedundantSameAsAt:1.7409115006080527E9, foundName:["Seven & i", "Seven & i Holdings Co."], name:["Seven & i Holdings Co."], description:["business"], industry:["Retail"], basedInLowRaw:["Japanese"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4584498/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:4584498, deletedRedundantSameAsAt:1.7409115006080527E9, foundName:["Seven & I Holdings"], name:["Seven & I Holdings"], description:["a parent company"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5006488/Harris_Teeter", properties:{internalDocId:5006488, deletedRedundantSameAsAt:1.7410094788502004E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], internalMergedSameAsHighToUri:"https://1145.am/db/2082743/Harris_Teeter", basedInLowRaw:["South Carolina"]}}, {uri:"https://1145.am/db/4940087/Harris_Teeter", properties:{internalDocId:4940087, deletedRedundantSameAsAt:1.7410094788502004E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["food"], internalMergedSameAsHighToUri:"https://1145.am/db/2082743/Harris_Teeter"}}, {uri:"https://1145.am/db/5139050/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5139050, deletedRedundantSameAsAt:1.741096690458789E9, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["business", "operator of the 7-Eleven convenience store chain"], industry:["convenience stores", "retailer"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5250595/Harris_Teeter", properties:{internalDocId:5250595, deletedRedundantSameAsAt:1.741096690458789E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["hard work and dedication to their communities"], industry:["Supermarket"], basedInLowRaw:["United States"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter"}}, {uri:"https://1145.am/db/5293762/Harris_Teeter", properties:{basedInHighClean:["Wilmington"], internalDocId:5293762, deletedRedundantSameAsAt:1.7411599029903545E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["customer shopping"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInHighRaw:["Wilmington, N.C."]}}, {uri:"https://1145.am/db/5293771/Harris_Teeter", properties:{basedInHighClean:["Virginia Beach"], internalDocId:5293771, deletedRedundantSameAsAt:1.7411599029903545E9, foundName:["Harris Teeter"], name:["Harris Teeter"], description:["customer shopping"], internalMergedSameAsHighToUri:"https://1145.am/db/187774/Harris_Teeter", basedInHighRaw:["Virginia Beach, V.A."]}}, {uri:"https://1145.am/db/5300295/York_Holdings", properties:{internalDocId:5300295, deletedRedundantSameAsAt:1.741249911350312E9, foundName:["York Holdings"], name:["York Holdings"], industry:["retailer"], basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/5300295/Seven_I_Holdings", properties:{internalDocId:5300295, deletedRedundantSameAsAt:1.741249911350312E9, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], industry:["Retail"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/5302873/Seven_I_Holdings", properties:{internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Seven & i", "Seven & i Holdings'"], name:["Seven & i Holdings"], description:["business"], industry:["supermarket and retail", "grocery store businesses"], basedInLowRaw:["U.S.", "Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings"}}, {uri:"https://1145.am/db/5302672/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5302672, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Seven & i", "Seven & i Holdings (3382.T)"], name:["Seven & i Holdings"], description:["business", "Business"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["Japanese"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5302873/Bain", properties:{internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Bain"], name:["Bain"], basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/5303073/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5303073, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5302873/York_Holdings", properties:{internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["York Holdings", "York"], name:["York Holdings"], description:["non-core businesses"], industry:["supermarket", "grocery store businesses"], basedInLowRaw:["Japan"], internalMergedSameAsHighToUri:"https://1145.am/db/5300295/York_Holdings"}}, {uri:"https://1145.am/db/5304567/Seven_I_Holdings", properties:{internalDocId:5304567, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["Seven & i Holdings"], name:["Seven & i Holdings"], description:["Business"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInLowRaw:["North America"]}}, {uri:"https://1145.am/db/5302538/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5302538, deletedRedundantSameAsAt:1.7414133574032001E9, foundName:["Seven & i", "Seven & i Holdings"], name:["Seven & i Holdings"], description:["business", "Business"], industry:["convenience store"], basedInLowRaw:["Japanese"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/5310227/Bain_Capital", properties:{internalDocId:5310227, deletedRedundantSameAsAt:1.7414189531090903E9, foundName:["Bain Capital", "Bain"], name:["Bain Capital"], description:["investment"], industry:["private equity firm"], internalMergedSameAsHighToUri:"https://1145.am/db/4846/Bain_Capital"}}, {uri:"https://1145.am/db/5309616/Seven_I_Holdings", properties:{basedInHighClean:["Japan"], internalDocId:5309616, deletedRedundantSameAsAt:1.7414189531090903E9, foundName:["Seven & I", "Seven & I Holdings"], name:["Seven & I Holdings"], description:["business"], industry:["convenience store"], internalMergedSameAsHighToUri:"https://1145.am/db/331244/Seven_I_Holdings", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["Christie Lites Orlando"], name:["Christie Lites Orlando"], basedInLowRaw:["Orlando"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/2421653/Ncqlp_Lc", properties:{internalDocId:2421653, deletedRedundantSameAsAt:1, foundName:["NCQLP"], name:["NCQLP LC"], basedInLowRaw:["San Francisco"]}}, {uri:"https://1145.am/db/410711/Harris_Teeter", properties:{internalDocId:410711, deletedRedundantSameAsAt:1, foundName:["Harris Teeter"], name:["Harris Teeter"], basedInLowRaw:["United States"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/4782968/Local_Frutta_Bowls-Investment", properties:{whereHighRaw:["United States"], documentDate:datetime('2022-11-30T18:15:00Z'), whereHighClean:["United States"], internalDocId:4782968, deletedRedundantSameAsAt:1, documentExtract:"Local Frutta Bowls Raises $ 850 For No Kid Hungry to Help Provide Healthy Meals to Children.", foundName:["Raises"], name:["Raises"], activityType:["investment"], status:["completed"]}}, {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant-Investment", properties:{whereHighRaw:["United States"], documentDate:datetime('2022-11-30T18:15:00Z'), whereHighClean:["United States"], internalDocId:4782968, deletedRedundantSameAsAt:1, documentExtract:"Better-for-You Restaurant in Freehold, NJ, Raises Highest Amount of Funds Across Frutta Bowls Chain.", foundName:["Raises"], name:["Raises"], activityType:["investment"], status:["completed"]}}, {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Ipo-Business", properties:{documentDate:datetime('2025-03-06T15:46:18.412Z'), targetName:["Seven & i Holdings"], internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["list"], documentExtract:"Bain Capital aims to list Seven & i Holdings' (3382.T) , opens new tab supermarket and retail business in around three years after boosting synergies within the group, an executive of the U.S. private equity firm said on Thursday.", name:["list"], activityType:["ipo"], targetDetails:["business"], status:["not happened at date of document"], whereLowRaw:"U.S."}}, {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Investment", properties:{documentDate:datetime('2025-03-06T15:46:18.412Z'), whereHighRaw:["Japan"], whereHighClean:["Japan"], internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, documentExtract:"Seven & i and its founder families will reinvest to take 40 % of York.", activityType:["investment"], status:["not happened at date of document"]}}, {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition", properties:{documentDate:datetime('2025-03-06T15:46:18.412Z'), targetName:["York Holdings"], internalDocId:5302873, valueRaw:["$ 5.50 billion", "814.7 billion yen"], deletedRedundantSameAsAt:1.7413416403251095E9, foundName:["take", "sell"], documentExtract:"Seven & i and its founder families will reinvest to take 40 % of York.", name:["take", "sell"], activityType:["investment", "acquisition"], status:["not happened at date of document"], whereLowRaw:"Japan"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:CorporateFinanceActivity;
            UNWIND [{uri:"https://1145.am/db/4782968/Better-for-You_Restaurant", properties:{documentDate:datetime('2022-11-30T18:15:00Z'), basedInHighClean:["Freehold"], deletedRedundantSameAsAt:1, description:["a restaurant"], industry:["restaurant"], whereHighRaw:["United States"], whereHighClean:["United States"], internalDocId:4782968, documentExtract:"Better-for-You Restaurant in Freehold, NJ, Raises Highest Amount of Funds Across Frutta Bowls Chain.", foundName:["Better-for-You Restaurant"], name:["Better-for-You Restaurant"], basedInHighRaw:["Freehold, NJ"], status:["completed"]}}, {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls", properties:{documentDate:datetime('2022-11-30T18:15:00Z'), basedInHighClean:["Freehold"], valueRaw:["up to $ 2,500"], deletedRedundantSameAsAt:1, description:["charitable work", "a restaurant"], industry:["restaurant"], whereHighRaw:["United States"], whereHighClean:["United States"], internalDocId:4782968, foundName:["Frutta Bowls Freehold", "Local Frutta Bowls"], documentExtract:"As the first-place winner of the Donation Competition, Frutta Bowls Freehold will receive matching donations up to $ 2,500 from WOWorks, the parent company of Frutta Bowls.", name:["Local Frutta Bowls", "Frutta Bowls"], basedInHighRaw:["Freehold"], status:["completed"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization:CorporateFinanceActivity;
            UNWIND [{uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html", properties:{datePublished:datetime('2022-11-30T18:15:00Z'), internalDocId:4782968, deletedRedundantSameAsAt:1, dateRetrieved:datetime('2024-10-30T11:58:22Z'), sourceOrganization:"PR Newswire", headline:"Local Frutta Bowls Raises $850 For No Kid Hungry to Help Provide Healthy Meals to Children"}}, {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire", properties:{datePublished:datetime('1997-04-01T12:00:00Z'), internalDocId:2427985, deletedRedundantSameAsAt:1, sourceOrganization:"Live Design Online", headline:"Smoke signals from Wildfire"}}, {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html", properties:{datePublished:datetime('2025-03-04T19:30:00Z'), internalDocId:5293762, deletedRedundantSameAsAt:1.7411599029903545E9, dateRetrieved:datetime('2025-03-04T21:50:09Z'), sourceOrganization:"prweb", headline:"Harris Teeter celebrates Virginia Beach, V.A. Fuel Center grand opening with $0.40 off per gallon fuel discount"}}, {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06", properties:{datePublished:datetime('2025-03-06T15:46:18.412Z'), internalDocId:5302873, deletedRedundantSameAsAt:1.7413416403251095E9, dateRetrieved:datetime('2025-03-06T20:28:44Z'), sourceOrganization:"Reuters", headline:"Bain aims to list Seven & i's supermarket business in about three years"}}, {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06", properties:{datePublished:datetime('2025-03-06T16:10:33.111Z'), internalDocId:5302672, deletedRedundantSameAsAt:1.7413416403251095E9, dateRetrieved:datetime('2025-03-06T20:27:20Z'), sourceOrganization:"Reuters", headline:"Japan's Seven & i announces restructuring, new CEO to fend off $47 billion takeover bid"}}, {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6", properties:{datePublished:datetime('2002-05-01T12:00:00Z'), internalDocId:2421653, deletedRedundantSameAsAt:1, sourceOrganization:"Live Design Online", headline:"Biz Bytes"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/York_Holdings"}, end: {uri:"https://1145.am/db/industry/463_grocery_supermarket_ecommerce_online"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/industry/463_grocery_supermarket_ecommerce_online"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterSecondary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Ncqlp_Lc"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando"}, end: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Uv_Fx"}, end: {uri:"https://1145.am/db/2427985/Uv_Fx-Art_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Uv_Fx"}, end: {uri:"https://1145.am/db/2427985/Uv_Fx-Creative_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Wildfire"}, end: {uri:"https://1145.am/db/2427985/Wildfire-Creative_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Wildfire"}, end: {uri:"https://1145.am/db/2427985/Wildfire-Art_Director"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:hasRole]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{documentExtract:"Kent Mathieu, Wildfire's art director, has also departed the firm, and joins UV/FX as creative director.", weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{documentExtract:"Kent Mathieu, Wildfire's art director, has also departed the firm, and joins UV/FX as creative director.", weight:1}}, {start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{documentExtract:"Seven & i Holdings (3382.T) , opens new tab, the Japanese operator of the 7-Eleven convenience store chain, appointed its first foreign CEO and handed him the task of overhauling its business to fend off a $ 47 billion overseas take over bid and engineer a recovery.", weight:1}}, {start: {uri:"https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{documentExtract:"Seven & i Holdings (3382.T) , opens new tab, the Japanese operator of the 7-Eleven convenience store chain, appointed its first foreign CEO and handed him the task of overhauling its business to fend off a $ 47 billion overseas take over bid and engineer a recovery.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Starting-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Heather_Stagl-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Appoint-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Mark_Harris-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Chad_Groshart-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Resign-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Christie Lites has appointed Bobby Klimuszko (aka Bobby K) , former rental account manager for corporate and special events at Westsun International, to the position of rental rep for Christie Lites Orlando.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Andre_Yew-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", weight:1}}, {start: {uri:"https://1145.am/db/2421653/Guy_Smith-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{documentExtract:"Horton Lees Brogden Lighting Design has announced that Mark Harris, Guy Smith, Heather Stagl, Andre Yew, and Chad Groshart have recently passed the NCQLP LC exam.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, end: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:vendor]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/4783010/Better-for-You_Restaurant"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/geonames_location/4499379"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/geonames_location/1861060"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5243244/Wildfire"}, end: {uri:"https://1145.am/db/2427985/Wildfire"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2783269/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1105244/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4066967/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4103698/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/5006488/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4183497/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/3604230/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/3119463/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1960096/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2789086/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2082743/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1452040/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/3970939/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/410711/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4282774/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1411385/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/585329/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4940087/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1137162/Harris_Teeter"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Ipo-Business"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{documentExtract:"Bain Capital aims to list Seven & i Holdings' (3382.T) , opens new tab supermarket and retail business in around three years after boosting synergies within the group, an executive of the U.S. private equity firm said on Thursday.", weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{documentExtract:"Seven & i and its founder families will reinvest to take 40 % of York.", weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Investment"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{documentExtract:"Seven & i and its founder families will reinvest to take 40 % of York.", weight:1}}, {start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls-Investment"}, end: {uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html"}, properties:{documentExtract:"Local Frutta Bowls Raises $ 850 For No Kid Hungry to Help Provide Healthy Meals to Children.", weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant-Investment"}, end: {uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html"}, properties:{documentExtract:"Better-for-You Restaurant in Freehold, NJ, Raises Highest Amount of Funds Across Frutta Bowls Chain.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka"}, end: {uri:"https://1145.am/db/geonames_location/1861060"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive"}, end: {uri:"https://1145.am/db/geonames_location/1861060"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive"}, end: {uri:"https://1145.am/db/geonames_location/1861060"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Starting-Rental_Rep"}, end: {uri:"https://1145.am/db/geonames_location/4167147"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Resign-Rental_Rep"}, end: {uri:"https://1145.am/db/geonames_location/4167147"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Appoint-Rental_Rep"}, end: {uri:"https://1145.am/db/geonames_location/4167147"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"}, end: {uri:"https://1145.am/db/5293762/Wilmington"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"}, end: {uri:"https://1145.am/db/5293762/Lumina_Commons"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:location]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Ipo-Business"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, end: {uri:"https://1145.am/db/5302873/York_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Ipo-Business"}, end: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, end: {uri:"https://1145.am/db/5300295/York_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:target]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Investment"}, end: {uri:"https://1145.am/db/geonames_location/1861060"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant-Investment"}, end: {uri:"https://1145.am/db/geonames_location/6252001"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls-Investment"}, end: {uri:"https://1145.am/db/geonames_location/6252001"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Stephen_Dacus"}, end: {uri:"https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka"}, end: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Heather_Stagl"}, end: {uri:"https://1145.am/db/2421653/Heather_Stagl-Finishing-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Andre_Yew"}, end: {uri:"https://1145.am/db/2421653/Andre_Yew-Finishing-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Mark_Harris"}, end: {uri:"https://1145.am/db/2421653/Mark_Harris-Finishing-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Guy_Smith"}, end: {uri:"https://1145.am/db/2421653/Guy_Smith-Finishing-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko"}, end: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Appoint-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko"}, end: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Resign-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Chad_Groshart"}, end: {uri:"https://1145.am/db/2421653/Chad_Groshart-Finishing-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko"}, end: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Starting-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu"}, end: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu"}, end: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:roleActivity]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Chad_Groshart-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Resign-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Guy_Smith-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Mark_Harris-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Appoint-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko-Starting-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Andre_Yew-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Heather_Stagl-Finishing-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director"}, end: {uri:"https://1145.am/db/2427985/Wildfire-Creative_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director"}, end: {uri:"https://1145.am/db/2427985/Wildfire-Art_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director"}, end: {uri:"https://1145.am/db/2427985/Uv_Fx-Art_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director"}, end: {uri:"https://1145.am/db/2427985/Uv_Fx-Creative_Director"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:role]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Stephen_Dacus"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Ryuichi_Isaka"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Heather_Stagl"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Chad_Groshart"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Bobby_Klimuszko"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Mark_Harris"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Guy_Smith"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Andre_Yew"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Kent_Mathieu"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, end: {uri:"https://1145.am/db/geonames_location/5098278"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/geonames_location/5098278"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, end: {uri:"https://www.prweb.com/releases/harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894.html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, end: {uri:"https://www.reuters.com/markets/deals/bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06/"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, end: {uri:"https://www.reuters.com/business/retail-consumer/japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06/"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, end: {uri:"https://www.livedesignonline.com/biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html"}, end: {uri:"https://www.prnewswire.com/news-releases/local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555.html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, end: {uri:"https://www.livedesignonline.com/smoke-signals-from-wildfire"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:url]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{documentExtract:"MATTHEWS, N.C., March 4, 2025 /PRNewswire-PRWeb/ - Harris Teeter is proud to welcome customers to its Lumina Commons Fuel Center in Wilmington, N.C., as the company celebrates its grand opening March 7-9 with a $ 0.40 off per gallon promotion.", weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{documentExtract:"MATTHEWS, N.C., March 4, 2025 /PRNewswire-PRWeb/ - Harris Teeter is proud to welcome customers to its Lumina Commons Fuel Center in Wilmington, N.C., as the company celebrates its grand opening March 7-9 with a $ 0.40 off per gallon promotion.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings-Chief_Executive"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando-Rental_Rep"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Uv_Fx-Creative_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Wildfire-Art_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Uv_Fx-Art_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Wildfire-Creative_Director"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, end: {uri:"https://1145.am/db/industry/233_restaurant_restaurants_restauranteurs_eatery"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/industry/233_restaurant_restaurants_restauranteurs_eatery"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterPrimary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/industry/337_restaurant_software_hospitality_catering"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/industry/619_reservations_reservation_restaurant_booking"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, end: {uri:"https://1145.am/db/industry/619_reservations_reservation_restaurant_booking"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, end: {uri:"https://1145.am/db/industry/337_restaurant_software_hospitality_catering"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterSecondary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Investment"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings-Investment"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:investor]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/187774/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Bain"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5300295/York_Holdings"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Christie_Lites_Orlando"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2421653/Ncqlp_Lc"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Uv_Fx"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2427985/Wildfire"}, end: {uri:"https://1145.am/db/2427985/wwwlivedesignonlinecom_smoke-signals-from-wildfire"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/geonames_location/4499379"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/4482348"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/1861060"}, end: {uri:"https://1145.am/db/5302873/wwwreuterscom_markets_deals_bain-aims-list-seven-is-supermarket-business-about-3-years-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/1861060"}, end: {uri:"https://1145.am/db/5302672/wwwreuterscom_business_retail-consumer_japans-seven-i-expected-announce-new-ceo-restructuring-plan-2025-03-06"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/4167147"}, end: {uri:"https://1145.am/db/2421653/wwwlivedesignonlinecom_biz-bytes-6"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/6252001"}, end: {uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/5098278"}, end: {uri:"https://1145.am/db/4782968/wwwprnewswirecom_news-releases_local-frutta-bowls-raises-850-for-no-kid-hungry-to-help-provide-healthy-meals-to-children-301690555html"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/383223/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4059507/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1467072/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1684131/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1648326/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2017319/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/4592679/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2008581/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/353533/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1511122/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/354836/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/2108850/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293771/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/1965432/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/187774/Harris_Teeter"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5281024/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/332258/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4458715/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1956273/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5273757/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5001520/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5007784/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1976499/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4462096/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4579956/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4590040/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4192448/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4509386/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/816439/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5304567/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4570635/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5001949/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2068732/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2103122/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4511287/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4614792/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5273977/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4516271/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4374614/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/782708/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5139050/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/332718/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4458801/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2104165/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4507567/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1179523/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5300295/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2825662/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4617195/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1493845/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5007768/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5014578/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4628816/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4990084/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1225557/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5303073/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4520211/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5139178/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings"}, end: {uri:"https://1145.am/db/5300295/York_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/3462173/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4482983/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4480339/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2060104/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5069614/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4965136/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4621016/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4593230/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4480339/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4590040/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4628816/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5303073/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4579956/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4570635/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4617195/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4509386/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/3462173/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2060104/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4482983/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2068732/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5139178/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4614792/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5273977/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4458801/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5069614/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2103122/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/782708/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4511287/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4621016/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/331244/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4192448/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4593230/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/332718/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5001949/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4516271/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5139050/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4990084/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2104165/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5007768/Seven_I_Holdings_Co"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5014578/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5001520/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5281024/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4374614/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4965136/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/332258/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1956273/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5273757/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1493845/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1225557/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5007784/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5300295/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5304567/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4507567/Seven_I_Holdings_Co"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4462096/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/2825662/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/816439/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1976499/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4458715/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/1179523/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/4520211/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302538/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302538/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5309616/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5309616/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Wilmington"}, end: {uri:"https://1145.am/db/geonames_location/4499379"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:nameGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Bain"}, end: {uri:"https://1145.am/db/5302873/York_Holdings-Acquisition"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:buyer]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5289666/Seven_I_Holdings"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/5289666/Seven_I_Holdings"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, end: {uri:"https://1145.am/db/geonames_location/6252001"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, end: {uri:"https://1145.am/db/geonames_location/6252001"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls-Investment"}, end: {uri:"https://1145.am/db/4782968/Local_Frutta_Bowls"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant-Investment"}, end: {uri:"https://1145.am/db/4782968/Better-for-You_Restaurant"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:target]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"}, end: {uri:"https://1145.am/db/geonames_location/4499379"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"}, end: {uri:"https://1145.am/db/geonames_location/4482348"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Lumina_Commons"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Wilmington"}, end: {uri:"https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5302873/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/industry/176_grocery_groceries_supermarket_supermarkets"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302873/York_Holdings"}, end: {uri:"https://1145.am/db/industry/176_grocery_groceries_supermarket_supermarkets"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5302672/Seven_I_Holdings"}, end: {uri:"https://1145.am/db/industry/427_convenience_retail_stores_retailer"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterPrimary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Lumina_Commons"}, end: {uri:"https://1145.am/db/geonames_location/4499379"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Wilmington"}, end: {uri:"https://1145.am/db/geonames_location/4482348"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/5293762/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/187774/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/187774/Harris_Teeter"}, end: {uri:"https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:locationAdded]->(end) SET r += row.properties;
        """
    
    def setUp(self):
        clean_db()
        nuke_cache()
        for query in self.cypher_queries.split(";"):
            q = query.strip()
            if q != '':
                db.cypher_query(q)
        add_dynamic_classes_for_multiple_labels(ignore_cache=True)

        self.a1_source_uri = "https://1145.am/db/5302672/Ryuichi_Isaka-None-Chief_Executive"
        self.a1_target_uri = "https://1145.am/db/5302672/Stephen_Dacus-Starting-Chief_Executive"
        a1_s = Resource.get_by_uri(self.a1_source_uri)
        a1_t = Resource.get_by_uri(self.a1_target_uri)
        assert a1_s.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert a1_t.withRole.relationship(a1_t.withRole[0]).weight == 1

        self.a2_source_uri = "https://1145.am/db/5302873/Seven_I_Holdings-Investment"
        self.a2_target_uri = "https://1145.am/db/5302873/York_Holdings-Acquisition"
        a2_s = Resource.get_by_uri(self.a2_source_uri)
        a2_t = Resource.get_by_uri(self.a2_target_uri)
        assert a2_s.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert a2_t.investor.relationship(Resource.get_by_uri("https://1145.am/db/331244/Seven_I_Holdings")).weight == 1

        self.a3_source_uri = "https://1145.am/db/5293762/Harris_Teeter-Added-Wilmington"
        self.a3_target_uri = "https://1145.am/db/5293762/Harris_Teeter-Added-Lumina_Commons"
        a3_s = Resource.get_by_uri(self.a3_source_uri)
        a3_t = Resource.get_by_uri(self.a3_target_uri)
        a3_t_target = a3_t.locationAdded.filter(internalMergedSameAsHighToUri__isnull=True)[0]
        assert a3_s.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert a3_t.locationAdded.relationship(a3_t_target).weight == 1
        assert a3_t.documentSource.relationship(Resource.get_by_uri("https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html")).weight == 1

        self.a4_uri_1 = "https://1145.am/db/4782968/Better-for-You_Restaurant"
        self.a4_uri_2 = "https://1145.am/db/4782968/Local_Frutta_Bowls" # Both of these are Organization *and* CorporateFinanceActivity
        a4_1 = Resource.get_by_uri(self.a4_uri_1)
        a4_2 = Resource.get_by_uri(self.a4_uri_2)
        assert len(a4_1.target.all()) == 1
        assert len(a4_2.target.all()) == 1

        self.ra_2427985_uri_a = "https://1145.am/db/2427985/Kent_Mathieu-Finishing-Art_Director"
        self.ra_2427985_uri_b = "https://1145.am/db/2427985/Kent_Mathieu-Starting-Creative_Director"
        ra_2427985_a = Resource.get_by_uri(self.ra_2427985_uri_a)
        ra_2427985_b = Resource.get_by_uri(self.ra_2427985_uri_b)
        assert len(ra_2427985_a.withRole.filter(internalMergedSameAsHighToUri__isnull=True).all()) == 2
        assert len(ra_2427985_b.withRole.filter(internalMergedSameAsHighToUri__isnull=True).all()) == 2

        self.ra_2421653_bobby_uri = "https://1145.am/db/2421653/Bobby_Klimuszko"
        ra_2421653_bobby = Resource.get_by_uri(self.ra_2421653_bobby_uri)
        ra_2421653_bobby_activities = ra_2421653_bobby.roleActivity.filter(internalMergedActivityWithSimilarRelationshipsToUri__isnull=True)
        assert len(ra_2421653_bobby_activities) == 3
        roles = [x.withRole.all() for x in ra_2421653_bobby_activities]
        uniques = set([x for sublist in roles for x in sublist])
        assert len(uniques) == 1 # 1 role for bobby via 3 activities

        R = RDFPostProcessor()
        R.run_all_in_order()

    def test_does_not_merge_leaving_joining_role(self):
        a1_s = Resource.get_by_uri(self.a1_source_uri) 
        a1_t = Resource.get_by_uri(self.a1_target_uri)
        assert a1_s.internalMergedActivityWithSimilarRelationshipsToUri is None # No changes to roles because person is different
        assert a1_t.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert a1_t.withRole.relationship(a1_t.withRole[0]).weight == 1

    def test_merges_corp_fin_activities(self):
        a2_s = Resource.get_by_uri(self.a2_source_uri)
        a2_t = Resource.get_by_uri(self.a2_target_uri)
        assert a2_s.internalMergedActivityWithSimilarRelationshipsToUri == self.a2_target_uri
        assert a2_t.investor.relationship(Resource.get_by_uri("https://1145.am/db/331244/Seven_I_Holdings")).weight == 2

    def test_merges_location_activities(self):
        a3_s = Resource.get_by_uri(self.a3_source_uri)
        a3_t = Resource.get_by_uri(self.a3_target_uri)
        a3_t_target = a3_t.locationAdded.filter(internalMergedSameAsHighToUri__isnull=True)[0]
        assert a3_s.internalMergedActivityWithSimilarRelationshipsToUri == self.a3_target_uri
        assert a3_t.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert a3_t.locationAdded.relationship(a3_t_target).weight == 2
        assert a3_t.documentSource.relationship(Resource.get_by_uri("https://1145.am/db/5293762/wwwprwebcom_releases_harris-teeter-celebrates-virginia-beach-va-fuel-center-grand-opening-with-0-40-off-per-gallon-fuel-discount-302391894html")).weight == 2

    def test_does_not_touch_nodes_with_activity_and_organization_labels(self):
        # if it has an organization label then it might also have a sameAsHigh relationship and don't want to mix up merging sameAsHigh and merging similar activities
        a4_1 = Resource.get_by_uri(self.a4_uri_1)
        a4_2 = Resource.get_by_uri(self.a4_uri_2)
        assert len(a4_1.target.all()) == 1 # Shouldn't change
        assert len(a4_2.target.all()) == 1 # Shouldn't change - not merging nodes with Activity and Organization labels

    def test_does_not_merge_distinct_role_activities(self):
        # 2427985 looks like duplicate roles but they have unique uris so shouldn't combine
        ra_2427985_a = Resource.get_by_uri(self.ra_2427985_uri_a)
        ra_2427985_b = Resource.get_by_uri(self.ra_2427985_uri_b) # role activiy
        assert len(ra_2427985_a.withRole.all()) == 2 # role
        assert len(ra_2427985_b.withRole.all()) == 2
        assert ra_2427985_a.internalMergedActivityWithSimilarRelationshipsToUri is None
        assert ra_2427985_b.internalMergedActivityWithSimilarRelationshipsToUri is None

    def test_merges_duplicated_role_activities_for_same_person_and_role(self):
        # Bobby has 3 activities for the same role
        ra_2421653_bobby = Resource.get_by_uri(self.ra_2421653_bobby_uri)
        ra_2421653_bobby_activities = ra_2421653_bobby.roleActivity.filter(internalMergedActivityWithSimilarRelationshipsToUri__isnull=True)
        assert len(ra_2421653_bobby_activities) == 1
        roles = [x.withRole.all() for x in ra_2421653_bobby_activities]
        uniques = set([x for sublist in roles for x in sublist])
        assert len(uniques) == 1 # 1 role for bobby via 1 activity

    def test_keeps_separate_role_activities_for_separate_people_even_with_same_role(self):
        # 5 other people have 5 activities each for the same role. This is ok because we can't guarantee 
        # that one activity means the same for more than one person (esp if one activity is "leaves" and 
        # another is "joins")
        exam_uri = "https://1145.am/db/2421653/Ncqlp_Lc-Lc_Exam"
        exam = Resource.get_by_uri(exam_uri) # role
        acts = exam.withRole.filter(internalMergedActivityWithSimilarRelationshipsToUri__isnull=True).all() # role activities
        assert len(acts) == 5
        people = [x.roleActivity.all() for x in acts] # person
        people = set([x for sublist in people for x in sublist])
        assert len(people) == 5

class NegativeWeightRelationshipTestCase(CypherQueryBaseTestCase):

    cypher_queries="""CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;
            UNWIND [{uri:"https://1145.am/db/979613/Scott_Nelson", properties:{internalId:1964346, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Scott Nelson"], name:["Scott Nelson"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Person;
            UNWIND [{uri:"https://1145.am/db/979613/Tma_Systems-Vice_President_Of_Marketing", properties:{internalId:1964165, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vice President of Marketing"], name:["Vice President of Marketing"], orgFoundName:["TMA Systems"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Role;
            UNWIND [{uri:"https://1145.am/db/industry/693_maintenance_mro_repair_operations", properties:{internalId:1034, topicId:693, uniqueName:"693_maintenance_mro_repair_operations", representativeDoc:["Mro (Maintenance Repair And Operations)", "Mro (Maintenance Repair And Operations) Services", "Aftermarket Distribution And Maintenance, Repair And Overhaul Mro (Maintenance Repair And Operations) Services For Air, Land And"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["", "repair", "operations", "overhaul", "service", "mro", "operating", "services", "maintenance", "aftermarket"]}}, {uri:"https://1145.am/db/industry/230_technology_financial_tech_finance", properties:{internalId:1250, topicId:230, uniqueName:"230_technology_financial_tech_finance", representativeDoc:["Financial-Technology", "Financial Services And Financial Technology", "Financial Technology"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["", "innovation", "tech", "financial", "liquidity", "services", "technology", "finance"]}}, {uri:"https://1145.am/db/industry/33_saas_technology_software_cloud", properties:{internalId:223, topicId:33, uniqueName:"33_saas_technology_software_cloud", deletedRedundantSameAsAt:1.7602485398459773E9, representativeDoc:["Saas (Software As A Service Software) Technology", "Saas (Software As A Service Software) Technology Technology", "Technology And Saas (Software As A Service Software) Technology"], representation:["cloud", "tech", "software", "outsourcing", "saas", "solutions", "backend", "services", "technology", "applications"]}}, {uri:"https://1145.am/db/industry/195_consulting_consultancy_consultant_technology", properties:{internalId:350, topicId:195, uniqueName:"195_consulting_consultancy_consultant_technology", representativeDoc:["Technology And Consulting", "Consulting And Technology", "Technology Consulting And Services"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["tech", "technologies", "consultancy", "consultant", "consulting", "solutions", "it", "services", "technology", "consultancies"]}}, {uri:"https://1145.am/db/industry/110_software_applications_solutions_development", properties:{internalId:372, topicId:110, uniqueName:"110_software_applications_solutions_development", representativeDoc:["Software Development And Visibility Tools", "Open Source Software", "Commercial Open Source Software Company"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["", "computing", "development", "software", "systems", "solutions", "tools", "applications", "integrated", "toolkits"]}}, {uri:"https://1145.am/db/industry/59_hospital_hospitals_hospitalist_healthcare", properties:{internalId:479, topicId:59, uniqueName:"59_hospital_hospitals_hospitalist_healthcare", representativeDoc:["Hospital Management Service", "Hospital System", "Hospital Provider"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["hospitals", "medical", "management", "provider", "clinic", "hospital", "hospitalist", "healthsystem", "providers", "healthcare"]}}, {uri:"https://1145.am/db/industry/132_martech_tech_technology_technologies", properties:{internalId:767, topicId:132, uniqueName:"132_martech_tech_technology_technologies", representativeDoc:["Martech And Data Industry", "Martech Solutions", "Martech"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["tech", "technologies", "techie", "puretech", "hardtech", "techmaker", "technology", "revtech", "martech", "femtech"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:IndustryCluster;
            UNWIND [{uri:"https://1145.am/db/979613/Scott_Nelson-Starting-Vice_President_Of_Marketing", properties:{documentDate:datetime('2022-04-14T12:00:00Z'), deletedRedundantSameAsAt:1.7602485398459773E9, internalId:1964107, internalDocId:979613, roleHolderFoundName:["Scott Nelson"], roleFoundName:["Vice President of Marketing"], documentExtract:"TMA Systems, a world-class provider of advanced Computerized Maintenance Management Systems (CMMS) and Enterprise Asset Management Solutions (EAMS) , is pleased to announce that career SaaS marketing executive Scott Nelson has joined the company as Vice President of Marketing.", foundName:["joined"], name:["Joined"], activityType:["starting"], orgFoundName:["TMA Systems"], status:["completed"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:RoleActivity;
            UNWIND [{uri:"https://1145.am/db/979613/Tma_Systems", properties:{internalId:1738941, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["TMA Systems"], name:["TMA Systems"], description:["a company", "a world-class provider of advanced Computerized Maintenance Management Systems (CMMS) and Enterprise"], industry:["SaaS", "technology"], internalCleanName:["tma systems"], internalMergedSameAsHighToUri:"https://1145.am/db/730863/Tma_Systems"}}, {uri:"https://1145.am/db/730863/Tma_Systems", properties:{internalId:1889189, internalDocId:730863, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["TMA Systems"], name:["TMA Systems"], description:["SaaS, technology and financial service companies"], industry:["SaaS, technology and financial service"], internalCleanName:["tma systems"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/979613/Supply_Chain_Management_And_Commercial_Marketplace_Platform-About-Us", properties:{documentDate:datetime('2022-04-14T12:00:00Z'), internalId:9557884, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["supply chain management and commercial marketplace platform"], documentExtract:"Nelson previously served as the Senior Director of Global and Demand Generation Marketing at Avetta, a cloud - based supply chain management and commercial marketplace platform. TMA looks forward to leveraging his expertise in building high-energy, engaging marketing organizations from the ground up.  TMA has a huge opportunity to expand in the EAM space , says Nelson.  I look forward to delivering high-yield marketing programs that enable revenue growth and position TMA Systems as a CMMS/EAMS market leader . About TMA Systems.", name:["supply chain management and commercial marketplace platform"]}}, {uri:"https://1145.am/db/979613/Advanced_Computerized_Maintenance_Management_Systems_(cmms)_And_Enterprise_Asset_Management_Solutions_(eams)-About-Us", properties:{documentDate:datetime('2022-04-14T12:00:00Z'), internalId:9557958, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["advanced Computerized Maintenance Management Systems ( CMMS ) and Enterprise Asset Management Solutions ( EAMS )"], documentExtract:"TMA Systems, a world-class provider of advanced Computerized Maintenance Management Systems (CMMS) and Enterprise Asset Management Solutions (EAMS) , is pleased to announce that career SaaS marketing executive Scott Nelson has joined the company as Vice President of Marketing.  Scott's depth and breadth across all aspects of SaaS marketing makes him a great addition to TMA , says Mark Simner, TMA Systems' Chief Executive Officer.  His results-oriented approach to delivering revenue growth and building market awareness is exciting. He 'll be a key player to our expanding Executive Leadership team primed to take TMA Systems to new heights . Bringing more than 30 years of expertise in the technology sector, Nelson will drive all of TMA's marketing initiatives.", name:["advanced Computerized Maintenance Management Systems (CMMS) and Enterprise Asset Management Solutions (EAMS)"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:AboutUs;
            UNWIND [{uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing", properties:{datePublished:datetime('2022-04-14T12:00:00Z'), internalId:1964354, internalDocId:979613, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Business Wire", headline:"TMA Systems Appoints Scott Nelson as Vice President of Marketing"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Scott_Nelson"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/230_technology_financial_tech_finance"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/195_consulting_consultancy_consultant_technology"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterSecondary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems-Vice_President_Of_Marketing"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/979613/Tma_Systems-Vice_President_Of_Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:hasRole]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Scott_Nelson-Starting-Vice_President_Of_Marketing"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{documentExtract:"TMA Systems, a world-class provider of advanced Computerized Maintenance Management Systems (CMMS) and Enterprise Asset Management Solutions (EAMS) , is pleased to announce that career SaaS marketing executive Scott Nelson has joined the company as Vice President of Marketing.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/132_martech_tech_technology_technologies"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/693_maintenance_mro_repair_operations"}, properties:{weight:4}}, {start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/110_software_applications_solutions_development"}, properties:{weight:3}}, {start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/59_hospital_hospitals_hospitalist_healthcare"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/33_saas_technology_software_cloud"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/730863/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/693_maintenance_mro_repair_operations"}, properties:{weight:3}}, {start: {uri:"https://1145.am/db/730863/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/110_software_applications_solutions_development"}, properties:{weight:3}}, {start: {uri:"https://1145.am/db/730863/Tma_Systems"}, end: {uri:"https://1145.am/db/industry/59_hospital_hospitals_hospitalist_healthcare"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterPrimary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/979613/Advanced_Computerized_Maintenance_Management_Systems_(cmms)_And_Enterprise_Asset_Management_Solutions_(eams)-About-Us"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Tma_Systems"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Scott_Nelson-Starting-Vice_President_Of_Marketing"}, end: {uri:"https://1145.am/db/979613/Tma_Systems-Vice_President_Of_Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:role]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Scott_Nelson"}, end: {uri:"https://1145.am/db/979613/Scott_Nelson-Starting-Vice_President_Of_Marketing"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:roleActivity]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/979613/Advanced_Computerized_Maintenance_Management_Systems_(cmms)_And_Enterprise_Asset_Management_Solutions_(eams)-About-Us"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{documentExtract:"TMA Systems, a world-class provider of advanced Computerized Maintenance Management Systems (CMMS) and Enterprise Asset Management Solutions (EAMS) , is pleased to announce that career SaaS marketing executive Scott Nelson has joined the company as Vice President of Marketing.  Scott's depth and breadth across all aspects of SaaS marketing makes him a great addition to TMA , says Mark Simner, TMA Systems' Chief Executive Officer.  His results-oriented approach to delivering revenue growth and building market awareness is exciting. He 'll be a key player to our expanding Executive Leadership team primed to take TMA Systems to new heights . Bringing more than 30 years of expertise in the technology sector, Nelson will drive all of TMA's marketing initiatives.", weight:1}}, {start: {uri:"https://1145.am/db/979613/Supply_Chain_Management_And_Commercial_Marketplace_Platform-About-Us"}, end: {uri:"https://1145.am/db/979613/wwwbusinesswirecom_news_home_20220414005268_en_TMA-Systems-Appoints-Scott-Nelson-as-Vice-President-of-Marketing"}, properties:{documentExtract:"Nelson previously served as the Senior Director of Global and Demand Generation Marketing at Avetta, a cloud - based supply chain management and commercial marketplace platform. TMA looks forward to leveraging his expertise in building high-energy, engaging marketing organizations from the ground up.  TMA has a huge opportunity to expand in the EAM space , says Nelson.  I look forward to delivering high-yield marketing programs that enable revenue growth and position TMA Systems as a CMMS/EAMS market leader . About TMA Systems.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            """
    
    def test_deletes_negative_weight(self):
        weight_query = """MATCH (n: Resource)-[ic:industryClusterPrimary]-(i: IndustryCluster) 
            WHERE n.uri in ['https://1145.am/db/979613/Tma_Systems','https://1145.am/db/730863/Tma_Systems'] 
            AND i.uri = 'https://1145.am/db/industry/693_maintenance_mro_repair_operations' RETURN n.uri, ic.weight"""
        res, _ = db.cypher_query(weight_query)
        weights = {k:v for k,v in res}
        self.assertDictEqual(weights, {'https://1145.am/db/730863/Tma_Systems': 3, 'https://1145.am/db/979613/Tma_Systems': 4})
        doc_id = 979613
        delete_and_clean_up_nodes_by_doc_id(doc_id)
        res, _ = db.cypher_query(weight_query)
        weights = {k:v for k,v in res}
        self.assertDictEqual(weights, {})
        self.assertIsNone(Resource.nodes.get_or_none(uri="https://1145.am/db/979613/Tma_Systems"))
        self.assertIsNotNone(Resource.nodes.get_or_none(uri='https://1145.am/db/730863/Tma_Systems'))

class DeleteMergedNodesTestCase1(CypherQueryBaseTestCase):

    '''
     CALL apoc.export.cypher.query( "match (n: Resource)-[x]-(o: Resource) match (p: Resource)-[:documentSource]-(q) where (n.internalDocId=742525 and o.internalDocId=742525) and p.uri = 'https://1145.am/db/674884/Olea_Kiosks_Inc' return *", null,{format:"plain",stream:true})
    '''
    cypher_queries = """CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;
        UNWIND [{uri:"https://1145.am/db/742525/Daniel_Olea", properties:{internalId:1893898, internalDocId:742525, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Daniel Olea"], name:["Daniel Olea"], basedInLowRaw:["LOS ANGELES"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Person;
        UNWIND [{uri:"https://1145.am/db/742525/Olea_Kiosks-Director_Of_Sales", properties:{internalId:1893622, internalDocId:742525, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Director of Sales"], name:["Director of Sales"], orgFoundName:["Olea Kiosks®, Inc."]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Role;
        UNWIND [{uri:"https://1145.am/db/742525/Daniel_Olea-Starting-Director_Of_Sales", properties:{documentDate:datetime('2022-01-07T12:17:41Z'), deletedRedundantSameAsAt:1.7602485398459773E9, whereHighRaw:["United States"], internalId:1893863, whereHighClean:["United States"], internalDocId:742525, roleHolderFoundName:["Daniel Olea"], roleFoundName:["Director of Sales"], documentExtract:"Olea Kiosks®, Inc. Announces Promotion of Daniel Olea to Director of Sales, Accelerating its Sales and Strategic Focus.", foundName:["Promotion"], name:["Inferred Activity", "Promotion"], activityType:["starting"], orgFoundName:["Olea Kiosks®, Inc."], status:["completed", "unknown"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:RoleActivity;
        UNWIND [{uri:"https://1145.am/db/674884/Olea_Kiosks_Inc", properties:{internalId:12326360, internalDocId:674884, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Olea Kiosks Inc."], name:["Olea Kiosks Inc."], description:["retail self-checkout terminals market"], internalCleanName:["olea kiosks"]}}, {uri:"https://1145.am/db/742525/Olea_Kiosks", properties:{internalId:1893663, internalDocId:742525, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Olea Kiosks®, Inc."], name:["Olea Kiosks®"], description:["Sales"], internalCleanName:["olea kiosks"], internalMergedSameAsHighToUri:"https://1145.am/db/742525/Olea_Kiosks_Inc"}}, {uri:"https://1145.am/db/742525/Olea_Kiosks_Inc", properties:{basedInHighClean:["Los Angeles"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["a self-service kiosk solution provider", "self-service kiosk solutions"], industry:["self-service kiosk solution provider"], internalMergedSameAsHighToUri:"https://1145.am/db/674884/Olea_Kiosks_Inc", internalId:9224692, internalDocId:742525, foundName:["Olea Kiosks® Inc.,", "Olea Kiosks®, Inc."], name:["Olea Kiosks® Inc."], internalCleanName:["olea kiosks"], basedInLowRaw:["United States"], basedInHighRaw:["LOS ANGELES, Calif."]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
        UNWIND [{uri:"https://1145.am/db/742525/Self-Service_Kiosk_Solutions-About-Us", properties:{documentDate:datetime('2022-01-07T12:17:41Z'), internalId:9224671, internalDocId:742525, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["self-service kiosk solutions", "self-service kiosk solution provider"], documentExtract:"Olea Kiosks® Inc., is a self-service kiosk solution provider for the attractions and entertainment, healthcare and hospitality industries.", name:["self-service kiosk solutions", "self-service kiosk solution provider"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:AboutUs;
        UNWIND [{uri:"https://1145.am/db/3266116/wwwprnewswirecom_news-releases_global-interactive-kiosk-industry-outlook-2020-2025-interactive-kiosks-emerging-in-real-estate-marketing-301003881html", properties:{datePublished:datetime('2020-02-12T18:30:00Z'), internalId:12060588, internalDocId:3266116, deletedRedundantSameAsAt:1.7602485398459773E9, dateRetrieved:datetime('2024-01-14T01:37:54Z'), sourceOrganization:"PR Newswire", headline:"Global Interactive Kiosk Industry Outlook, 2020-2025 - Interactive Kiosks Emerging in Real Estate Marketing"}}, {uri:"https://1145.am/db/4913288/wwwprnewswirecom_news-releases_interactive-kiosk-market-to-grow-at-a-cagr-of-4-91-by-2025-increasing-use-of-cashless-payment-to-boost-growth-17000-technavio-reports-301401122html", properties:{datePublished:datetime('2021-10-18T05:00:00Z'), internalId:12326411, internalDocId:4913288, deletedRedundantSameAsAt:1.7602485398459773E9, dateRetrieved:datetime('2024-11-05T08:14:15Z'), sourceOrganization:"PR Newswire", headline:"Interactive Kiosk Market to grow at a CAGR of 4.91% by 2025| Increasing Use of Cashless Payment to Boost Growth |17000+ Technavio Reports"}}, {uri:"https://1145.am/db/674884/wwwbusinesswirecom_news_home_20211206005658_en_Global-Retail-Self-checkout-Terminals-Market-Report-2021-2025-Market-is-Poised-to-Grow-by-223-Billion-Market-is-Driven-by-Premiumization-Through-Product-Innovation-and-Technology-ResearchAndMarketscom", properties:{datePublished:datetime('2021-12-06T16:49:00Z'), internalId:12381138, internalDocId:674884, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Business Wire", headline:"Global Retail Self-checkout Terminals Market Report 2021-2025: Market is Poised to Grow by $2.23 Billion - Market is Driven by Premiumization Through Product Innovation and Technology - ResearchAndMarkets.com"}}, {uri:"https://1145.am/db/679721/apnewscom_press-release_BusinessWire_technology-business-retail-industry-89150ec2e914478caf855e00c603e9f4", properties:{datePublished:datetime('2021-12-06T16:49:37Z'), internalId:12381365, internalDocId:679721, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Associated Press", headline:"Global Retail Self-checkout Terminals Market Report 2021-2025: Market is Poised to Grow by $2.23 Billion"}}, {uri:"https://1145.am/db/4136759/wwwglobenewswirecom_news-release_2024_04_03_2856744_28124_en_48-8-Bn-Interactive-Kiosk-Markets-Banking-Self-service-Vending-Global-Forecast-to-2029html", properties:{datePublished:datetime('2024-04-03T10:29:38Z'), internalId:15086368, internalDocId:4136759, deletedRedundantSameAsAt:1.7602485398459773E9, dateRetrieved:datetime('2024-04-04T05:56:44Z'), sourceOrganization:"GlobeNewswire", headline:"$48.8 Bn Interactive Kiosk Markets: Banking, Self-service, Vending - Global Forecast to 2029"}}, {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716", properties:{datePublished:datetime('2022-01-07T12:17:41Z'), internalId:1893892, internalDocId:742525, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Associated Press", headline:"Olea Kiosks®, Inc. Announces Promotion of Daniel Olea to Director of Sales, Accelerating its Sales and Strategic Focus"}}, {uri:"https://1145.am/db/1586281/apnewscom_press-release_send2press_business-los-angeles-cc99034e92a936b477c759eca00929d4", properties:{datePublished:datetime('2022-12-16T12:07:09Z'), internalId:2129658, internalDocId:1586281, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Associated Press", headline:"Olea Kiosks, Inc. Announces Addition of Kiosk Industry Veteran Michael Tulloch"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Daniel_Olea"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Olea_Kiosks-Director_Of_Sales"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Olea_Kiosks_Inc"}, end: {uri:"https://1145.am/db/742525/Olea_Kiosks-Director_Of_Sales"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/742525/Olea_Kiosks"}, end: {uri:"https://1145.am/db/742525/Olea_Kiosks-Director_Of_Sales"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasRole]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Daniel_Olea-Starting-Director_Of_Sales"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{documentExtract:"Olea Kiosks®, Inc. Announces Promotion of Daniel Olea to Director of Sales, Accelerating its Sales and Strategic Focus.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Olea_Kiosks_Inc"}, end: {uri:"https://1145.am/db/742525/Self-Service_Kiosk_Solutions-About-Us"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Olea_Kiosks"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/742525/Olea_Kiosks_Inc"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{weight:2}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Daniel_Olea-Starting-Director_Of_Sales"}, end: {uri:"https://1145.am/db/742525/Olea_Kiosks-Director_Of_Sales"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:role]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Daniel_Olea"}, end: {uri:"https://1145.am/db/742525/Daniel_Olea-Starting-Director_Of_Sales"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:roleActivity]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/742525/Self-Service_Kiosk_Solutions-About-Us"}, end: {uri:"https://1145.am/db/742525/apnewscom_press-release_Send2Press_business-los-angeles-edfe367ce302bcaa29713a0645e9b716"}, properties:{documentExtract:"Olea Kiosks® Inc., is a self-service kiosk solution provider for the attractions and entertainment, healthcare and hospitality industries.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;"""

    def test_deletes_merged_entities(self):
        doc_id = 742525
        orgs_before = set([x.uri for x in Organization.nodes.all()])
        expected = set(['https://1145.am/db/674884/Olea_Kiosks_Inc', 'https://1145.am/db/742525/Olea_Kiosks_Inc', 'https://1145.am/db/742525/Olea_Kiosks'])
        self.assertSetEqual(orgs_before, expected)
        delete_and_clean_up_nodes_by_doc_id(doc_id)
        orgs_after = [x.uri for x in Organization.nodes.all()]
        self.assertListEqual(orgs_after, ['https://1145.am/db/674884/Olea_Kiosks_Inc'] )

class DeleteMergedNodesTestCase2(CypherQueryBaseTestCase):

    cypher_queries = """CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;;
            UNWIND [{uri:"https://1145.am/db/geonames_location/6251999", properties:{internalId:1940, featureCode:"PCLI", deletedRedundantSameAsAt:1.7602485398459773E9, countryCode:"CA", name:["Canada"], geoNamesId:6251999, admin1Code:"00"}}, {uri:"https://1145.am/db/geonames_location/5909050", properties:{internalId:69019, featureCode:"ADM1", deletedRedundantSameAsAt:1.7602485398459773E9, countryCode:"CA", name:["British Columbia"], geoNamesId:5909050, admin1Code:"02"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:GeoNamesLocation;
            UNWIND [{uri:"https://1145.am/db/industry/146_automotive_automobile_autotech_auto", properties:{internalId:1007, topicId:146, uniqueName:"146_automotive_automobile_autotech_auto", representativeDoc:["Automotive Technology", "Automotive And Technology", "Automotive"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["automobile", "tech", "technologies", "auto", "car", "engine", "autotech", "technology", "automotive", "powertrain"]}}, {uri:"https://1145.am/db/industry/250_dealership_dealerships_dealer_dealers", properties:{internalId:1272, topicId:250, uniqueName:"250_dealership_dealerships_dealer_dealers", representativeDoc:["Automotive Dealership", "Auto Dealership Insurance", "Auto Dealership"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["automobile", "dealerships", "auto", "showroom", "car", "retailer", "dealer", "dealers", "automotive", "dealership"]}}, {uri:"https://1145.am/db/industry/296_broker_brokerage_brokers_brokerages", properties:{internalId:460, topicId:296, uniqueName:"296_broker_brokerage_brokers_brokerages", representativeDoc:["Broker-Dealer And Alternative Trading Systems", "Broker Dealer", "Broker-Dealer"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["trading", "brokerage", "brokers", "service", "dealer", "interdealer", "services", "broker", "brokerages", "securities"]}}, {uri:"https://1145.am/db/industry/646_automotive_retail_retailing_auto", properties:{internalId:715, topicId:646, uniqueName:"646_automotive_retail_retailing_auto", deletedRedundantSameAsAt:1.7602485398459773E9, representativeDoc:["Automotive Retail", "Automotive Retail And Services", "Retail Automotive"], representation:["", "auto", "companies", "marketplace", "industry", "automotive", "retailing", "consumer", "retail"]}}, {uri:"https://1145.am/db/industry/550_automotive_automobiles_automobile_motoring", properties:{internalId:778, topicId:550, uniqueName:"550_automotive_automobiles_automobile_motoring", representativeDoc:["Automotive Drive Shaft Market Sector", "Motorcoach Industry", "Automobile Sector"], deletedRedundantSameAsAt:1.7602485398459773E9, representation:["automobile", "motor", "auto", "car", "automobiles", "industries", "motorcoach", "industry", "motoring", "automotive"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:IndustryCluster;
            UNWIND [{uri:"https://apnews.com/press-release/Accesswire/technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4", properties:{internalId:3131319, deletedRedundantSameAsAt:1.7602485398459773E9}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties;
            UNWIND [{uri:"https://1145.am/db/1888864/Announces-Appradio_2", properties:{documentDate:datetime('2012-01-09T20:30:05Z'), internalId:4201888, internalDocId:1888864, deletedRedundantSameAsAt:1.7602485398459773E9, documentExtract:"Pioneer Announces Android Support For AppRadio 2. AppRadio has always been a pretty sweet offering from Pioneer, but something important was missing: support for Android. In 2012, however, Pioneer's new AppRadio 2 platform will support both iPhone 4/4S as well as select Android phones. It has built-in Bluetooth, which only makes sense in the car, along with two configurable RCA Pre-outs for connecting to aftermarket or OEM amplifiers. The AppRadio 2 also comes with a full 7-inch touchscreen.", foundName:["Announces"], name:["Announces"], productName:["AppRadio 2"], status:["not happened at date of document"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:ProductActivity;
            UNWIND [{uri:"https://1145.am/db/1159217/Vicinity_Motor_Corp", properties:{internalId:10095230, internalDocId:1159217, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/4582685/Pioneer", properties:{internalId:10263409, internalDocId:4582685, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/236634/Pioneer"}}, {uri:"https://1145.am/db/1400795/Vicinity_Motor_Corp", properties:{internalId:10479576, internalDocId:1400795, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/1423704/Vicinity_Motor_Corp", properties:{internalId:10479601, internalDocId:1423704, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp.", "Vicinity"], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/1495207/Vicinity_Motor_Corp", properties:{internalId:10619733, basedInHighClean:["Canada"], internalDocId:1495207, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Research and development"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/1280411/Vicinity_Motor_Corp", properties:{internalId:1125695, internalDocId:1280411, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/932720/Vicinity_Motor_Corp", properties:{basedInHighClean:["North Salt Lake"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", internalId:1125701, internalDocId:932720, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], basedInHighRaw:["North American"]}}, {uri:"https://1145.am/db/758157/Vicinity_Motor_Corp", properties:{internalId:1125702, internalDocId:758157, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity"], name:["Vicinity Motor Corp", "Vicinity"], description:["commercial electric vehicles", "public transportation"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/546983/Vicinity_Motor_Corp", properties:{internalId:1125707, internalDocId:546983, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp.", "Vicinity Motor"], name:["Vicinity Motor Corp.", "Vicinity Motor"], description:["Engineering", "automotive", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp"}}, {uri:"https://1145.am/db/1143090/Vicinity_Motor_Corp", properties:{internalId:1125709, internalDocId:1143090, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Business", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada", "North American"]}}, {uri:"https://1145.am/db/1033550/Vicinity_Motor_Corp", properties:{internalId:1125722, internalDocId:1033550, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["North American supplier of commercial electric vehicles", "Financial Results"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "Eastern Time"]}}, {uri:"https://1145.am/db/1560041/Vicinity_Motor_Corp", properties:{internalId:1125734, internalDocId:1560041, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["manufacturing", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada", "North American"]}}, {uri:"https://1145.am/db/1384634/Vicinity_Motor_Corp", properties:{internalId:1125735, internalDocId:1384634, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Business"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/729218/Vicinity_Motor_Corp", properties:{internalId:1125742, internalDocId:729218, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["North American supplier of electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/949356/Vicinity_Motor_Corp", properties:{internalId:1125746, internalDocId:949356, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["(NASDAQ: VEV) (TSX-V: VMC) (FRA:6LGA) (Vicinity or the Company)", "Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["commercial electric vehicles"], industry:["automotive"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/2064719/Vicinity_Motor_Corporation", properties:{basedInHighClean:["British Columbia"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["North American electric vehicle supplier", "industry-leading initiative"], industry:["electric vehicles"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", internalId:1125747, internalDocId:2064719, foundName:["Vicinity Motor Corp", "Vicinity Motor Corporation", "VMC"], name:["Vicinity Motor Corp", "Vicinity Motor Corporation"], internalCleanName:["vicinity motor"], basedInLowRaw:["Canada"], basedInHighRaw:["British Columbia."]}}, {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp", properties:{internalId:1125765, internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["Business", "commercial electric vehicles"], industry:["automotive", "auto industry"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American", "British Columbia"]}}, {uri:"https://1145.am/db/3743773/Vicinity_Motor", properties:{internalId:1125771, internalDocId:3743773, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity", "Vicinity Motor"], name:["Vicinity Motor"], description:["commercial EVs"], industry:["automotive"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "United States"]}}, {uri:"https://1145.am/db/801769/Vicinity_Motor_Corp", properties:{basedInHighClean:["North Salt Lake"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["commercial electric vehicles"], industry:["automotive"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", internalId:1125776, internalDocId:801769, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], basedInHighRaw:["North American"]}}, {uri:"https://1145.am/db/1125725/Vicinity_Motor_Corp", properties:{internalId:1125785, internalDocId:1125725, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Business", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada", "North American"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/915885/Vicinity_Motor_Corp", properties:{internalId:1125790, internalDocId:915885, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp"}}, {uri:"https://1145.am/db/569465/Vicinity_Motor", properties:{internalId:1125801, basedInHighClean:["North Salt Lake"], internalDocId:569465, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor"], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInHighRaw:["North American"]}}, {uri:"https://1145.am/db/954002/Vicinity_Motor_Corp", properties:{internalId:1125821, internalDocId:954002, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["Business", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/906832/Vicinity_Motor_Corp", properties:{internalId:1125828, internalDocId:906832, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp.", "Corp", "VMC"], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["adoption and deployment of electric vehicles", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "U.S"]}}, {uri:"https://1145.am/db/1217269/Vicinity_Motor_Corp", properties:{internalId:1125836, internalDocId:1217269, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["a North American supplier of commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "U.S"]}}, {uri:"https://1145.am/db/1067710/Vicinity_Motor_Corp", properties:{internalId:1125849, internalDocId:1067710, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp.", "Vicinity", "Corp"], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/1507432/Vicinity_Motor_Corp", properties:{internalId:1125864, internalDocId:1507432, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/515846/Vicinity_Motor_Corp", properties:{internalId:1125868, internalDocId:515846, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["a leading supplier of electric, CNG, gas and clean diesel vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/903258/Vicinity_Motor_Corp", properties:{internalId:1125885, internalDocId:903258, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Financial Results", "commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "Eastern Time"]}}, {uri:"https://1145.am/db/528846/Vicinity_Motor_Corp", properties:{basedInHighClean:["Canada"], internalId:1125889, internalDocId:528846, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp.", "Vicinity Motor"], description:["a leading supplier of electric, CNG, gas and clean diesel vehicles", "engineering, procurement, design, sales and support", "automotive", "Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"], basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/1487967/Vicinity_Motor_Corp", properties:{internalId:1125931, internalDocId:1487967, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Financial Results", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "Eastern Time"]}}, {uri:"https://1145.am/db/1008551/Vicinity_Motor_Corp", properties:{internalId:1125948, internalDocId:1008551, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "Hawaii"]}}, {uri:"https://1145.am/db/435254/Vicinity_Motor_Corp", properties:{internalId:1125963, internalDocId:435254, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["a leading supplier of electric, CNG and clean diesel vehicles"], internalCleanName:["vicinity motor"], basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/4802560/Vicinity_Motor_Corp", properties:{basedInHighClean:["Canada"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["advanced shuttle transportation vehicles", "electric bus manufacturer", "public transit"], industry:["electric bus manufacturer", "transportation"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", internalId:1125982, internalDocId:4802560, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], internalCleanName:["vicinity motor"], basedInLowRaw:["AB", "Canada"], basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/544363/Vicinity_Motor_Corp", properties:{internalId:1125988, internalDocId:544363, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["manufacturing and transportation"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/1250077/Vicinity_Motor_Corp", properties:{internalId:1125995, internalDocId:1250077, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Financial Results", "commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "Eastern Time"]}}, {uri:"https://1145.am/db/884143/Vicinity_Motor_Corp", properties:{internalId:1125996, internalDocId:884143, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["a bus body manufacturer", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American", "United States"]}}, {uri:"https://1145.am/db/3635892/Vicinity_Motor", properties:{internalId:1126001, internalDocId:3635892, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor"], name:["Vicinity Motor"], description:["automotive industry"], industry:["automotive"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp"}}, {uri:"https://1145.am/db/1176847/Vicinity_Motor_Corp", properties:{internalId:1126015, internalDocId:1176847, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["Business"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/1617801/Vicinity_Motor_Corp", properties:{basedInHighClean:["Canada"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", internalId:1126032, internalDocId:1617801, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], internalCleanName:["vicinity motor"], basedInLowRaw:["Canada"], basedInHighRaw:["Canada"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/530094/Vicinity_Motor_Corp", properties:{internalId:1126036, internalDocId:530094, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["a leading supplier of electric, CNG, and clean diesel vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["CAD"]}}, {uri:"https://1145.am/db/1367854/Vicinity_Motor_Corp", properties:{basedInHighClean:["Canada"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["Business"], industry:["North American supplier of electric vehicles", "commercial electric vehicles"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", internalId:1126037, internalDocId:1367854, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/942966/Vicinity_Motor_Corp", properties:{internalId:1126040, internalDocId:942966, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["automotive"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/508739/Vicinity_Motor_Corp", properties:{internalId:1126043, internalDocId:508739, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["a leading supplier of electric, CNG, gas and clean diesel vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada", "CAD"]}}, {uri:"https://1145.am/db/1284317/Vicinity_Motor_Corp", properties:{internalId:1126055, internalDocId:1284317, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["manufacturing", "commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], basedInLowRaw:["North American"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp"}}, {uri:"https://1145.am/db/1610905/Vicinity_Motor_Corp", properties:{internalId:1126058, internalDocId:1610905, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["North American supplier of commercial electric vehicles"], industry:["North American supplier of electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/8557137/Pioneer_Bancorp", properties:{internalId:11442750, internalDocId:8557137, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Bancorp"], name:["Pioneer Bancorp"], internalCleanName:["pioneer bancorp"], internalMergedSameAsHighToUri:"https://1145.am/db/236634/Pioneer", internalCleanShortName:["pioneer"]}}, {uri:"https://1145.am/db/3175940/Pioneer_Corporation", properties:{internalId:12090477, internalDocId:3175940, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Corporation"], name:["Pioneer Corporation"], description:["Global In-vehicle Infotainment Market"], industry:["Infotainment"], internalCleanName:["pioneer"], basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/4816894/Pioneer_Corp", properties:{internalId:12435702, internalDocId:4816894, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Corp."], name:["Pioneer Corp"], description:["Automotive Navigation Systems"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/3175940/Pioneer_Corporation", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/848612/Pioneer", properties:{internalId:12643401, basedInHighClean:["Japan"], internalDocId:848612, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["Automotive HUD"], industry:["automotive HUD"], internalCleanName:["pioneer"], basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/4879114/Pioneer", properties:{internalId:12643588, basedInHighClean:["Japan"], internalDocId:4879114, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["Automotive HUD"], industry:["automotive HUD market"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/848612/Pioneer", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/848840/Pioneer", properties:{internalId:12643628, basedInHighClean:["Japan"], internalDocId:848840, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["manufacturing"], industry:["automotive HUD market"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/406970/Pioneer_Corporation", basedInHighRaw:["Japan"]}}, {uri:"https://1145.am/db/432972/Vicinity_Motor_Corp", properties:{internalId:1297171, internalDocId:432972, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["Chief Executive Officer", "Business"], internalCleanName:["vicinity motor"], basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/977674/Vicinity_Motor_Corp", properties:{internalId:1297208, internalDocId:977674, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["Business"], industry:["Automotive", "commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American", "U.S"]}}, {uri:"https://1145.am/db/3650140/Vicinity_Motor", properties:{internalId:1297248, basedInHighClean:["Canada"], internalDocId:3650140, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity", "Vicinity Motor"], name:["Vicinity", "Vicinity Motor"], description:["business", "transportation"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada"], basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/3680437/Vicinity_Motor", properties:{internalId:1297330, internalDocId:3680437, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor"], name:["Vicinity Motor"], description:["Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/819854/Vicinity_Motor_Corp", properties:{internalId:1297347, internalDocId:819854, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/3666275/Vicinity_Motor_Corp", properties:{internalId:1297366, internalDocId:3666275, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Quebec"]}}, {uri:"https://1145.am/db/4235129/Vicinity_Motor", properties:{internalId:1297380, internalDocId:4235129, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor"], name:["Vicinity Motor"], description:["Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["C"]}}, {uri:"https://1145.am/db/3984596/Vicinity_Motor", properties:{internalId:1297389, internalDocId:3984596, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor"], name:["Vicinity Motor"], description:["Business"], industry:["auto"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["France"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/943447/Vicinity_Motor_Corp", properties:{internalId:1297408, internalDocId:943447, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["North American supplier of commercial electric vehicles", "Business"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/4010373/Vicinity_Motor", properties:{internalId:1297419, internalDocId:4010373, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor"], name:["Vicinity Motor"], description:["Business"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/788714/Vicinity_Motor_Corp", properties:{basedInHighClean:["Canada"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["Business"], industry:["North American supplier of electric vehicles", "commercial electric vehicles"], internalMergedSameAsHighToUri:"https://1145.am/db/432972/Vicinity_Motor_Corp", internalId:1297433, internalDocId:788714, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp.", "Corp"], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], internalCleanName:["vicinity motor"], basedInLowRaw:["Canada"], basedInHighRaw:["Canada", "Canada."]}}, {uri:"https://1145.am/db/4738720/Pioneer_Corp", properties:{internalId:14177681, internalDocId:4738720, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Corp."], name:["Pioneer Corp."], description:["automotive aftermarket"], industry:["Automotive aftermarket"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/4667158/Pioneer_Corp", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/3117041/Pioneer_Corporation", properties:{internalId:14577184, internalDocId:3117041, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Corporation"], name:["Pioneer Corporation"], description:["electronics"], industry:["Infotainment"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/1869666/Pioneer"}}, {uri:"https://1145.am/db/4458408/Pioneer", properties:{internalId:15431786, internalDocId:4458408, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["new product developments and venture capital investments to obtain market share"], industry:["automotive HUD market"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/848612/Pioneer", basedInLowRaw:["Newark"]}}, {uri:"https://1145.am/db/4667158/Pioneer_Corp", properties:{internalId:15440057, internalDocId:4667158, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Corp."], name:["Pioneer Corp."], description:["automotive parts aftermarket"], industry:["automotive parts aftermarket"], internalCleanName:["pioneer"], basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/546953/Vicinity_Motor_Corp", properties:{internalId:1953610, internalDocId:546953, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp"], description:["a leading supplier of electric, compressed natural gas and clean diesel vehicles", "automotive"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/524851/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}, {uri:"https://1145.am/db/524851/Vicinity_Motor_Corp", properties:{internalId:1953668, internalDocId:524851, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["a North American electric vehicle (EV) manufacturer", "automotive"], industry:["transportation"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/236634/Pioneer", properties:{internalId:2439590, internalDocId:236634, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], industry:["energy"], internalCleanName:["pioneer"], basedInLowRaw:["United States"]}}, {uri:"https://1145.am/db/2675427/Pioneer", properties:{internalId:2819535, internalDocId:2675427, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer,", "Pioneer"], name:["Pioneer"], description:["in-car navigation telematics technologies"], industry:["car electronics"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/771223/Pioneer_Group", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/771223/Pioneer_Group", properties:{basedInHighClean:["British Columbia"], deletedRedundantSameAsAt:1.7602485398459773E9, description:["retail automotive dealer"], industry:["automotive"], internalMergedSameAsHighToUri:"https://1145.am/db/236634/Pioneer", internalCleanShortName:["pioneer"], internalId:3131270, internalDocId:771223, foundName:["Pioneer Group"], name:["Pioneer Group"], internalCleanName:["pioneer group"], basedInHighRaw:["British Columbia"]}}, {uri:"https://1145.am/db/5074695/Vicinity_Motor_Corp", properties:{internalId:3131274, internalDocId:5074695, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp", "Vicinity Motor Corp."], name:["Vicinity Motor Corp", "Vicinity Motor Corp."], description:["sales, assembly, procurement and engineering"], internalCleanName:["vicinity motor"], basedInLowRaw:["Ferndale, WA"]}}, {uri:"https://1145.am/db/1888864/Pioneer", properties:{internalId:3131374, internalDocId:1888864, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["car"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/771223/Pioneer_Group", basedInLowRaw:["Japan"]}}, {uri:"https://1145.am/db/771223/Pioneer_Auto_Group", properties:{internalId:3131440, basedInHighClean:["British Columbia"], internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Auto Group"], name:["Pioneer Auto Group"], description:["retail automotive dealer"], industry:["automotive dealer"], internalCleanName:["pioneer auto group"], internalCleanShortName:["pioneer auto"], basedInHighRaw:["British Columbia"]}}, {uri:"https://1145.am/db/4285415/Pioneer_Group", properties:{internalId:3698854, internalDocId:4285415, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer Group"], name:["Pioneer Group"], description:["real estate", "life sciences"], industry:["life sciences"], internalCleanName:["pioneer group"], internalMergedSameAsHighToUri:"https://1145.am/db/3715934/Pioneer", internalCleanShortName:["pioneer"], basedInLowRaw:["Europe", "United Kingdom"]}}, {uri:"https://1145.am/db/741590/Vicinity_Motor_Corp", properties:{internalId:9222111, internalDocId:741590, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp."], name:["Vicinity Motor Corp."], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/737999/Vicinity_Motor_Corp", properties:{internalId:9222166, internalDocId:737999, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["commercial electric vehicles"], industry:["commercial electric vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}, {uri:"https://1145.am/db/771223/Pioneer", properties:{internalId:9243979, basedInHighClean:["Canada"], internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Pioneer"], name:["Pioneer"], description:["retails over 6,000 vehicles per year"], industry:["auto dealership"], internalCleanName:["pioneer"], internalMergedSameAsHighToUri:"https://1145.am/db/771223/Pioneer_Group", basedInHighRaw:["Canada"]}}, {uri:"https://1145.am/db/497607/Vicinity_Motor", properties:{internalId:9399417, internalDocId:497607, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor"], description:["a leading supplier of electric, CNG, gas and clean diesel vehicles"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["Canada"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/2064719/Vicinity_Motor_Corp", properties:{internalId:9980336, internalDocId:2064719, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["Vicinity Motor Corp"], name:["Vicinity Motor Corp"], description:["North American electric vehicle supplier"], internalCleanName:["vicinity motor"], internalMergedSameAsHighToUri:"https://1145.am/db/435254/Vicinity_Motor_Corp", basedInLowRaw:["North American"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
            UNWIND [{uri:"https://1145.am/db/2675427/Intelligent_Transport_Systems-Ntt_Docomo_Pioneer", properties:{documentDate:datetime('2013-05-17T02:28:26Z'), internalId:2819538, orgName:["Pioneer", "DoCoMo", "NTT DoCoMo"], internalDocId:2675427, deletedRedundantSameAsAt:1.7602485398459773E9, documentExtract:"The two will jointly develop and launch ITS services that integrate this information with various other services for individual and corporate customers this year. As well as developing such services and constructing ITS-related cloud infrastructure, the two companies will develop and sell compatible car-mounted communication devices, DoCoMo added. The deal is the latest ITS collaboration between DoCoMo and Pioneer. DoCoMo and Pioneer already have partnered in the integration of car electronics and information services, including the docomo Drive Net navigation service, which incorporates DoCoMo's smartphones placed in dashboard-mounted cradles, the mobile carrier noted. Separately rival eAccess said it will begin selling a Pocket WiFi (GL09P) , which supports downlink speeds of up to 110 Mbps in August this year.", foundName:["and information services", "intelligent transport systems"], name:["And Information Services", "Partnership", "Intelligent Transport Systems"], status:["not happened at date of document", "completed"]}}, {uri:"https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp", properties:{documentDate:datetime('2022-01-19T13:31:48Z'), internalId:3131305, orgName:["Vicinity Motor Corp", "Pioneer Auto Group"], internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, documentExtract:"The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022. ADVERTISEMENT.  We are pleased to announce this order with Pioneer Auto Group, our exclusive dealer in the province , said William Trainer, Founder and CEO of Vicinity Motor Corp. Given their significant presence across British Columbia and strong brand recognition in the region, we believe they are an ideal retailer for a practical vehicle such as our all-electric VMC 1200.  The VMC 1200 has proven extremely popular - I have seen significant preliminary interest for hundreds of additional VMC 1200 vehicles.", name:["Partnership"], internalMergedActivityWithSimilarRelationshipsAt:1.745817391044252E9}}, {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group", properties:{documentDate:datetime('2022-01-19T13:31:48Z'), orgName:["Pioneer Group", "Pioneer Auto Group"], deletedRedundantSameAsAt:1.7602485398459773E9, whereHighRaw:["Canada"], internalId:3131433, whereHighClean:["Canada"], internalDocId:771223, documentExtract:"Vicinity Motor Corp. (NASDAQ: VEV) (TSXV: VMC) (FRA:6LGA) (Vicinity or the Company) , a North American supplier of commercial electric vehicles, today announced that it has secured a CAD $ 14 million order from Pioneer Auto Group (Pioneer) , a leading retail automotive dealer in British Columbia, for 100 VMC 1200 Class 3 electric trucks. The Pioneer Group has been appointed to act as VMC's exclusive dealer in the province of British Columbia - this follows a previous letter of intent. Pioneer is a well-respected Canadian dealership group with 17 locations located chiefly throughout British Columbia, Canada. The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022.", foundName:["1200 Class 3 electric trucks"], name:["1200 Class 3 Electric Trucks"], internalMergedActivityWithSimilarRelationshipsAt:1.745817391044252E9, status:["not happened at date of document"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:PartnershipActivity;
            UNWIND [{uri:"https://1145.am/db/771223/Supplier_Of_Commercial_Electric_Vehicles-About-Us", properties:{documentDate:datetime('2022-01-19T13:31:48Z'), internalId:9243976, internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["supplier of commercial electric vehicles", "supplier of electric vehicles", "supplier of"], documentExtract:"Vicinity Motor Corp. (NASDAQ: VEV) (TSXV: VMC) (FRA:6LGA) is a North American supplier of electric vehicles for both public and commercial enterprise use.", name:["supplier of commercial electric vehicles", "supplier of electric vehicles"]}}, {uri:"https://1145.am/db/771223/Dealership_Group-About-Us", properties:{documentDate:datetime('2022-01-19T13:31:48Z'), internalId:9243995, internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, foundName:["dealership group"], documentExtract:"Pioneer is a well-respected Canadian dealership group with 17 locations located chiefly throughout British Columbia, Canada. The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022. ADVERTISEMENT.  We are pleased to announce this order with Pioneer Auto Group, our exclusive dealer in the province , said William Trainer, Founder and CEO of Vicinity Motor Corp. Given their significant presence across British Columbia and strong brand recognition in the region, we believe they are an ideal retailer for a practical vehicle such as our all-electric VMC 1200.", name:["dealership group"]}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:AboutUs;
            UNWIND [{uri:"https://1145.am/db/2675427/wwwfiercewirelesscom_europe_docomo-adds-transport-to-cloud-mix", properties:{datePublished:datetime('2013-05-17T02:28:26Z'), internalId:2819625, internalDocId:2675427, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Fierce Wireless", headline:"DoCoMo adds transport to cloud mix"}}, {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4", properties:{datePublished:datetime('2022-01-19T13:31:48Z'), internalId:3131340, internalDocId:771223, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"Associated Press", headline:"Vicinity Motor Corp. Receives $14 Million Order for VMC 1200 EV Trucks from Pioneer Auto Group"}}, {uri:"https://1145.am/db/1888864/techcrunchcom_2012_01_09_pioneer-announces-android-support-for-appradio-2", properties:{datePublished:datetime('2012-01-09T20:30:05Z'), internalId:4201886, internalDocId:1888864, deletedRedundantSameAsAt:1.7602485398459773E9, sourceOrganization:"TechCrunch", headline:"Pioneer Announces Android Support For AppRadio 2"}}] AS row
            CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
            UNWIND [{start: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, end: {uri:"https://apnews.com/press-release/Accesswire/technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:url]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/industry/296_broker_brokerage_brokers_brokerages"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/industry/646_automotive_retail_retailing_auto"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/industry/646_automotive_retail_retailing_auto"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterSecondary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/432972/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/2675427/Intelligent_Transport_Systems-Ntt_Docomo_Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:partnership]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/236634/Pioneer"}, end: {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:awarded]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/236634/Pioneer"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/432972/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/1888864/techcrunchcom_2012_01_09_pioneer-announces-android-support-for-appradio-2"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/2675427/wwwfiercewirelesscom_europe_docomo-adds-transport-to-cloud-mix"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{documentExtract:"Vicinity Motor Corp. (NASDAQ: VEV) (TSXV: VMC) (FRA:6LGA) (Vicinity or the Company) , a North American supplier of commercial electric vehicles, today announced that it has secured a CAD $ 14 million order from Pioneer Auto Group (Pioneer) , a leading retail automotive dealer in British Columbia, for 100 VMC 1200 Class 3 electric trucks. The Pioneer Group has been appointed to act as VMC's exclusive dealer in the province of British Columbia - this follows a previous letter of intent. Pioneer is a well-respected Canadian dealership group with 17 locations located chiefly throughout British Columbia, Canada. The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022.", weight:1}}, {start: {uri:"https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{documentExtract:"The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022. ADVERTISEMENT.  We are pleased to announce this order with Pioneer Auto Group, our exclusive dealer in the province , said William Trainer, Founder and CEO of Vicinity Motor Corp. Given their significant presence across British Columbia and strong brand recognition in the region, we believe they are an ideal retailer for a practical vehicle such as our all-electric VMC 1200.  The VMC 1200 has proven extremely popular - I have seen significant preliminary interest for hundreds of additional VMC 1200 vehicles.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/geonames_location/5909050"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/geonames_location/5909050"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/geonames_location/6251999"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/geonames_location/6251999"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/729218/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1033550/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1143090/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1384634/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/8557137/Pioneer_Bancorp"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/8557137/Pioneer_Bancorp"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/3175940/Pioneer_Corporation"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/3175940/Pioneer_Corporation"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4816894/Pioneer_Corp"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/848612/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/848840/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/848840/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4879114/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4879114/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4738720/Pioneer_Corp"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4738720/Pioneer_Corp"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/3117041/Pioneer_Corporation"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4458408/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4458408/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4667158/Pioneer_Corp"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/949356/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/546983/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1367854/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/1888864/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/4010373/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/432972/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/977674/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/546953/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/530094/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3680437/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/884143/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/5074695/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/508739/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/528846/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1284317/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1125725/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1217269/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1610905/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3666275/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/943447/Vicinity_Motor_Corp"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3743773/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/4802560/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/544363/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/4235129/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3984596/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/524851/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3635892/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/435254/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/515846/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/942966/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/954002/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1176847/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/788714/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/3650140/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/819854/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/2675427/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/801769/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1560041/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/758157/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2064719/Vicinity_Motor_Corporation"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/737999/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/741590/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/906832/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1487967/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1280411/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1617801/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/1888864/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1067710/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1008551/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1507432/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/903258/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/1250077/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/569465/Vicinity_Motor"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/915885/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/497607/Vicinity_Motor"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/932720/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2064719/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1159217/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4285415/Pioneer_Group"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/4582685/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer_Group"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4582685/Pioneer"}, end: {uri:"https://1145.am/db/771223/Pioneer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1400795/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1423704/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1495207/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/geonames_location/5909050"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/geonames_location/6251999"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/1888864/Announces-Appradio_2"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:productActivity]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/236634/Pioneer"}, end: {uri:"https://1145.am/db/771223/Dealership_Group-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/771223/Dealership_Group-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Supplier_Of_Commercial_Electric_Vehicles-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/771223/Dealership_Group-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/432972/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/771223/Supplier_Of_Commercial_Electric_Vehicles-About-Us"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Pioneer_Auto_Group"}, end: {uri:"https://1145.am/db/industry/250_dealership_dealerships_dealer_dealers"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/industry/550_automotive_automobiles_automobile_motoring"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/industry/146_automotive_automobile_autotech_auto"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/771223/Pioneer"}, end: {uri:"https://1145.am/db/industry/250_dealership_dealerships_dealer_dealers"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Vicinity_Motor_Corp"}, end: {uri:"https://1145.am/db/industry/146_automotive_automobile_autotech_auto"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/771223/Pioneer_Group"}, end: {uri:"https://1145.am/db/industry/250_dealership_dealerships_dealer_dealers"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:industryClusterPrimary]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group"}, end: {uri:"https://1145.am/db/geonames_location/6251999"}, properties:{weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:whereHighGeoNamesLocation]->(end) SET r += row.properties;
            UNWIND [{start: {uri:"https://1145.am/db/771223/Supplier_Of_Commercial_Electric_Vehicles-About-Us"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{documentExtract:"Vicinity Motor Corp. (NASDAQ: VEV) (TSXV: VMC) (FRA:6LGA) is a North American supplier of electric vehicles for both public and commercial enterprise use.", weight:1}}, {start: {uri:"https://1145.am/db/771223/Dealership_Group-About-Us"}, end: {uri:"https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4"}, properties:{documentExtract:"Pioneer is a well-respected Canadian dealership group with 17 locations located chiefly throughout British Columbia, Canada. The company retails over 6,000 vehicles per year and carries over 1,500 vehicles in its network including Mitsubishi, Honda, Chrysler, Dodge, Jeep and RAM models. The VMC 1200 trucks should start arriving to Pioneer in the second quarter of 2022. ADVERTISEMENT.  We are pleased to announce this order with Pioneer Auto Group, our exclusive dealer in the province , said William Trainer, Founder and CEO of Vicinity Motor Corp. Given their significant presence across British Columbia and strong brand recognition in the region, we believe they are an ideal retailer for a practical vehicle such as our all-electric VMC 1200.", weight:1}}] AS row
            MATCH (start:Resource{uri: row.start.uri})
            MATCH (end:Resource{uri: row.end.uri})
            CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        """

    def test_deletes_merged_entities(self):
        doc_id = 771223
        resources_before = Resource.nodes.filter(internalDocId=doc_id).all()
        self.assertEqual( len(resources_before), 9)
        ''' URIs and internalMergedSameAsHighToUri link
        ('https://1145.am/db/771223/Pioneer_Auto_Group', None)
        ('https://1145.am/db/771223/Partnership-Pioneer_Auto_Group_Vicinity_Motor_Corp', None)
        ('https://1145.am/db/771223/1200_Class_3_Electric_Trucks-Pioneer_Auto_Group_Pioneer_Group', None)
        ('https://1145.am/db/771223/Supplier_Of_Commercial_Electric_Vehicles-About-Us', None)
        ('https://1145.am/db/771223/Dealership_Group-About-Us', None)
        ('https://1145.am/db/771223/apnewscom_press-release_Accesswire_technology-business-british-columbia-canada-north-america-e2c37de0188673a412275b4d0268c6f4', None)
        ('https://1145.am/db/771223/Vicinity_Motor_Corp', 'https://1145.am/db/432972/Vicinity_Motor_Corp')
        ('https://1145.am/db/771223/Pioneer_Group', 'https://1145.am/db/236634/Pioneer')
        ('https://1145.am/db/771223/Pioneer', 'https://1145.am/db/771223/Pioneer_Group')
        '''
        all_nodes_before = Resource.nodes.all()
        self.assertEqual( len(all_nodes_before), 98 )
        delete_and_clean_up_nodes_by_doc_id(doc_id)
        resources_after = Resource.nodes.filter(internalDocId=doc_id).all()
        self.assertEqual( len(resources_after), 0)
        all_nodes_after = Resource.nodes.all()
        self.assertEqual( len(all_nodes_after), len(all_nodes_before) - len(resources_before) )


class MergeUnmergedIntegrationTestCase(TestCase):

    @classmethod
    def setUpTestData(cls):
        '''
        created from

        CALL apoc.export.cypher.query( 
            'match (n: Resource {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"})-[o]-(p),
            (s: Resource {uri:"https://1145.am/db/9022045/Ai-Powered_Procurement_Solutions-About-Us"})-[t]-(u),
            (v: Resource {uri:"https://1145.am/db/324816/Simfoni"})-[w]-(x),
            (d: Resource {uri:"https://1145.am/db/9022045/Launches-Strategic_Spend_Hub"})-[e]-(f),
            (a: Resource {uri:"https://1145.am/db/9022045/Simfoni"})-[b]-(c) return *',
            null,
            {format: "plain", stream:true})   

        then removed not needed indexes and added IF NOT EXISTS to constraint
        '''
        queries = """
        CREATE CONSTRAINT n10s_unique_uri IF NOT EXISTS FOR (node:Resource) REQUIRE (node.uri) IS UNIQUE;
        UNWIND [{uri:"https://1145.am/db/3284296/Simfoni-Chief_Executive_Officer", properties:{internalId:1568352, internalDocId:3284296, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Chief Executive Officer"], name:["Chief Executive Officer"], orgFoundName:["Simfoni Analytics"]}}, {uri:"https://1145.am/db/413077/Simfoni-Executive_Management_Team", properties:{internalId:1811069, internalDocId:413077, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["executive management team"], name:["Executive Management Team"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/835233/Simfoni-Board_Of_Directors", properties:{internalId:1921882, internalDocId:835233, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Board of Directors"], name:["Board of Directors"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/456774/Simfoni-General_Manager", properties:{internalId:4360891, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["General Manager"], name:["General Manager"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/456774/Simfoni-Chief_Financial_Officer", properties:{internalId:4360981, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Chief Financial Officer"], name:["Chief Financial Officer"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/456774/Simfoni-Accounts_Director", properties:{internalId:4361130, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Accounts Director"], name:["Accounts Director"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/456774/Simfoni-Eu_Accounts_Director", properties:{internalId:4361213, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["EU Accounts Director"], name:["Eu Accounts Director"], orgFoundName:["Simfoni"]}}, {uri:"https://1145.am/db/456774/Simfoni-Chief_Financial_Officer_(cfo", properties:{internalId:4361244, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Chief Financial Officer (CFO"], name:["Chief Financial Officer (CFO"], orgFoundName:["Simfoni"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Role;
        UNWIND [{uri:"https://1145.am/db/geonames_location/5391959", properties:{internalId:30687, featureCode:"PPLA2", deletedRedundantSameAsAt:1.7454600609416347E9, countryCode:"US", name:["San Francisco"], geoNamesId:5391959, admin1Code:"CA"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:GeoNamesLocation;
        UNWIND [{uri:"https://www.prweb.com/releases/simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691.html", properties:{internalId:11824754, deletedRedundantSameAsAt:1.7556290431795936E9}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties;
        UNWIND [{uri:"https://1145.am/db/9022045/Launches-Strategic_Spend_Hub", properties:{documentDate:datetime('2025-08-19T13:00:00Z'), internalId:12933858, internalDocId:9022045, deletedRedundantSameAsAt:1.757253306944307E9, documentExtract:"Simfoni Launches Strategic Spend Hub to Power AI-Driven Procurement on Snowflake AI Data Cloud. With Strategic Spend Hub, Simfoni has reimagined the procurement process as a closed-loop, AI- and data-driven experience by leveraging the capabilities of the Snowflake Native App Framework. Post this. With 'Talk To My Data' , the Strategic Spend Hub's flagship AI chat feature, customers can generate meaningful analysis in moments, share it with their team, and surface the data they need to make fast-and valuable-spend decisions.  The launch of Strategic Spend Hub is a game-changer for anyone responsible for managing business spend , said Stefan Dent, Co-Founder at Simfoni.", foundName:["Launches"], name:["Launches"], productName:["Strategic Spend Hub"], status:["completed"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:ProductActivity;
        UNWIND [{uri:"https://1145.am/db/industry/164_transformation_digital_solutions_technologies", properties:{internalId:685, topicId:164, uniqueName:"164_transformation_digital_solutions_technologies", representativeDoc:["Digital Transformation Solutions", "Digital Transformation Solutions And Services Provider", "Digital Transformation Solutions And Services"], deletedRedundantSameAsAt:1.7454600609416347E9, representative_doc_embedding: [], representation:["digital", "technologies", "solution", "solutions", "company", "agile", "it", "services", "technology", "transformation"]}}, {uri:"https://1145.am/db/industry/132_martech_tech_technology_technologies", properties:{internalId:767, topicId:132, uniqueName:"132_martech_tech_technology_technologies", representativeDoc:["Martech And Data Industry", "Martech Solutions", "Martech"], deletedRedundantSameAsAt:1.7454600609416347E9, representative_doc_embedding: [], representation:["tech", "technologies", "techie", "puretech", "hardtech", "techmaker", "technology", "revtech", "martech", "femtech"]}}, {uri:"https://1145.am/db/industry/480_procurement_eprocurement_sourcing_contracting", properties:{internalId:836, topicId:480, uniqueName:"480_procurement_eprocurement_sourcing_contracting", representativeDoc:["Procurement", "Procurement Services", "E-Procurement"], deletedRedundantSameAsAt:1.7454600609416347E9, representative_doc_embedding: [], representation:["", "consultancy", "strategic", "eprocurement", "procurement", "industry", "services", "supply", "sourcing", "contracting"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:IndustryCluster;
        UNWIND [{uri:"https://1145.am/db/1300315/Simfoni", properties:{internalId:10275180, internalDocId:1300315, deletedRedundantSameAsAt:1.7527438402470007E9, foundName:["Simfoni"], name:["Simfoni"], description:["spend analytics and spend automation"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/9022045/Simfoni", properties:{internalId:11824782, internalDocId:9022045, deletedRedundantSameAsAt:1.7556290431795936E9, foundName:["Simfoni"], name:["Simfoni"], description:["Procurement", "procurement"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/835233/Simfoni", properties:{internalId:1270366, industry_embedding: [], internalDocId:835233, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement intelligence, tail spend management, strategic sourcing and award decision optimization"], industry:["technology"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/384780/Simfoni", basedInLowRaw:["US"]}}, {uri:"https://1145.am/db/1533890/Simfoni", properties:{internalId:1270446, industry_embedding: [], internalDocId:1533890, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement intelligence, eSourcing and tail spend management", "Procurement intelligence, eSourcing and tail spend management"], industry:["digital solutions provider"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni", basedInLowRaw:["Michigan"]}}, {uri:"https://1145.am/db/746047/Simfoni", properties:{industry_embedding: [], internalId:1270455, internalDocId:746047, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["digital procurement", "eSourcing and decision award optimization"], industry:["digital procurement"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/413077/Simfoni", properties:{industry_embedding: [], internalId:1270568, internalDocId:413077, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement, enterprise contract management and supply management"], industry:["digital solutions provider"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/4477278/Simfoni", properties:{internalId:1270614, internalDocId:4477278, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["digital procurement solutions"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/456774/Simfoni", properties:{internalId:1270696, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement analytics and spend automation"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/384780/Simfoni", basedInLowRaw:["Middle East & North Africa", "US"]}}, {uri:"https://1145.am/db/384780/Simfoni", properties:{internalId:1270697, industry_embedding: [], internalDocId:384780, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["CFOs", "Spend Intelligence and Spend Automation"], industry:["procurement software"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni"}}, {uri:"https://1145.am/db/324816/Simfoni", properties:{internalId:1270841, internalDocId:324816, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["digital solutions provider", "procurement analytics and spend automation"], internalCleanName:["simfoni"]}}, {uri:"https://1145.am/db/3284296/Simfoni", properties:{internalId:1568449, basedInHighClean:["San Francisco"], internalDocId:3284296, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni Limited", "Simfoni Analytics"], name:["Simfoni"], description:["Spend Analytics and Spend Automation"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/324816/Simfoni", basedInHighRaw:["San Francisco"]}}, {uri:"https://1145.am/db/2027303/Simfoni", properties:{internalId:1774903, internalDocId:2027303, deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement intelligence and tail spend management", "Tail Spend Management and Procurement Solution Provider"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/384780/Simfoni"}}, {uri:"https://1145.am/db/5523328/Simfoni", properties:{internalId:7887387, internalDocId:5523328, deletedRedundantSameAsAt:1.7470102996724772E9, foundName:["Simfoni"], name:["Simfoni"], description:["procurement and data professionals"], internalCleanName:["simfoni"], internalMergedSameAsHighToUri:"https://1145.am/db/384780/Simfoni"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Organization;
        UNWIND [{uri:"https://1145.am/db/324816/Digital_Procurement_Transformation-Gulftainer_Gulftainer_Etc", properties:{documentDate:datetime('2021-05-05T04:00:00Z'), whereHighRaw:["UAE"], internalId:3021146, whereHighClean:["United Arab Emirates"], orgName:["Simfoni", "Gulftainer"], internalDocId:324816, deletedRedundantSameAsAt:1.7454600609416347E9, documentExtract:"Simfoni is a next generation digital solutions provider for procurement analytics and spend automation specialises in the provision of digital technology that streamlines the procurement process We chose Simfoni because it was clear that they had both the global capability and the market knowledge needed to support our business , said David Casey, Chief Commercial Officer at Gulftainer. Gulftainer announced today that it has selected Simfoni for the implementation of a digital procurement transformation of its business. The leading port operator has port operations and associated logistics activities across the UAE, KSA, Iraq and the US. Simfoni, a next generation digital solutions provider for procurement analytics and spend automation specialises in the provision of digital technology that streamlines the procurement process thereby reducing both process costs and third-party expenditures. Simfoni is unique in not only offering the technology but having its own team of implementation support and buying resources effectively providing a one-stop shop for the entire eProcurement transformation process.", foundName:["digital procurement", "digital procurement transformation", "Digital Procurement Transformation"], name:["Digital Procurement Transformation", "Digital Procurement"], status:["not happened at date of document"]}}, {uri:"https://1145.am/db/384780/Partnership-Peakspan_Capital_Simfoni", properties:{documentDate:datetime('2021-07-22T04:00:00Z'), internalId:3595110, orgName:["Simfoni", "PeakSpan Capital"], internalDocId:384780, deletedRedundantSameAsAt:1.7454600609416347E9, documentExtract:" We have been tracking the procurement software space for several years, and are thrilled to partner with Simfoni, which has crafted an approach truly unlike anything we 've ever seen in this market , said Jack Freeman, Principal at PeakSpan Capital.  The unique business model and 'Pay As You Save' pricing developed by this team has set the stage for Simfoni to capture a large, untapped opportunity, offering digital procurement solutions to enterprises who lack robust procurement resource, experience, and budget. We have been really impressed by Simfoni's seasoned management team, global reach and the unique commercial proposition. The company is growing rapidly with strong capital efficiency, and we are excited to be able to provide additional resources to support the business' continued acceleration . The Simfoni Spend Automation platform is a full digital procurement suite that provides more control for CFOs.", name:["Partnership"]}}, {uri:"https://1145.am/db/4477278/Digital_Procurement_Solutions-Kearney_Simfoni", properties:{documentDate:datetime('2023-06-05T12:30:00Z'), internalId:3602655, orgName:["Simfoni", "Kearney"], internalDocId:4477278, deletedRedundantSameAsAt:1.7454600609416347E9, documentExtract:"We are confident our clients will benefit from improved visibility and increased efficiencies as they continue to regenerate their business models and performance. Post this. Simfoni's spend management platform provides powerful AI-enabled spend analytics, sourcing, optimization, spend automation, and payment consolidation to help clients identify savings opportunities, optimize complex sourcing and procurement processes, and deliver on the user experience. Kearney provides a rigorous approach to program management, ensuring strategic analysis of tail spend segmentation to sustain results and provide a positive ROI year over year.  Kearney is thrilled to partner with Simfoni to provide our clients with access to the most comprehensive digital procurement solutions in the market , said Alex Liu, managing partner and chairman, Kearney.", foundName:["digital", "digital procurement", "digital procurement solutions"], name:["Partnership", "Digital Procurement Solutions", "Digital", "Digital Procurement"], status:["not happened at date of document"]}}, {uri:"https://1145.am/db/5523328/Intelligence_And_Procurement_Solutions-Simfoni_Snowflake", properties:{documentDate:datetime('2025-05-09T09:21:57Z'), internalId:7887366, orgName:["Snowflake", "Simfoni"], internalDocId:5523328, deletedRedundantSameAsAt:1.7470102996724772E9, documentExtract:"Through the collaboration, joint customers will be able to leverage Simfoni Native Apps available via the Snowflake platform for automated data extraction, spend analytics, opportunity assessments, contract reviews, and more.  AI needs reliable data to inform analysis and decision-making, which is a central tenet of our collaboration , says Stefan Dent, Chief Strategy Officer and Simfoni co-founder.  Simfoni is thrilled to work with Snowflake to bring to market solutions that leverage the Snowflake platform and its comprehensive data and AI capabilities to help joint customers leverage AI to directly launch sourcing events at the touch of a button .  Traditional procurement solutions typically require large teams of skilled operators to operate the solution and analyze data, which is often stored in silos , notes Joe Frederick, VP Procurement at Snowflake.  However, the landscape is changing rapidly with the advent of solutions such as Simfoni, which automate spend management activity using the easy, trusted and connected Snowflake platform .", foundName:["Intelligence and Procurement Solutions", "spend intelligence and procurement solutions"], name:["Partnership", "Spend Intelligence and Procurement Solutions"], status:["not happened at date of document", "completed"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:PartnershipActivity;
        UNWIND [{uri:"https://1145.am/db/746047/Ec_Sourcing_Group-Acquisition", properties:{documentDate:datetime('2022-01-10T06:05:00Z'), internalId:1270720, targetName:["EC Sourcing Group"], internalDocId:746047, deletedRedundantSameAsAt:1.7454600609416347E9, documentExtract:"Simfoni, the world's most accessible digital procurement vendor, today announced that it has completed its acquisition of EC Sourcing Group, an established leader in eSourcing and decision award optimization.", foundName:["acquisition"], name:["acquisition"], activityType:["acquisition"], status:["completed"]}}, {uri:"https://1145.am/db/1533890/Xeeva-Acquisition", properties:{documentDate:datetime('2022-11-28T03:00:00Z'), targetName:["Xeeva"], deletedRedundantSameAsAt:1.7454600609416347E9, whereHighRaw:["Michigan"], internalId:1774869, whereHighClean:["Michigan"], internalDocId:1533890, documentExtract:"Simfoni, the next-generation digital solutions provider for procurement intelligence, eSourcing and tail spend management, today announced that it has acquired Michigan - based Xeeva, a fellow leader in AI-powered spend management and procurement technology solutions.", foundName:["acquired"], name:["acquired"], activityType:["acquisition"], status:["completed"]}}, {uri:"https://1145.am/db/2027303/Simfoni-Investment", properties:{documentDate:datetime('2023-06-05T12:30:00Z'), internalId:2194057, internalDocId:2027303, deletedRedundantSameAsAt:1.7454600609416347E9, documentExtract:"Simfoni, the next-generation digital solutions provider for procurement intelligence and tail spend management, today announced a Series A-2 investment round with Kearney, a global leader in management consultancy, to enable more efficiency and cost management for Kearney's clients.", foundName:["investment"], name:["investment"], activityType:["investment"], status:["completed"]}}, {uri:"https://1145.am/db/384780/Peakspan_Capital-Simfoni-Investment-Series_B", properties:{documentDate:datetime('2021-07-22T04:00:00Z'), internalId:2518473, internalDocId:384780, valueRaw:["total", "$ 15 million", "$ 15M"], deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["funding"], documentExtract:"Simfoni, the next-generation digital solutions provider for Spend Intelligence and Spend Automation, today announced that it has raised a total of $ 15 million in Series B funding led by Peakspan Capital.", name:["funding"], activityType:["investment"], targetDetails:["Series B"], status:["not happened at date of document", "completed"]}}, {uri:"https://1145.am/db/4477278/Kearney-Simfoni-Investment", properties:{documentDate:datetime('2023-06-05T12:30:00Z'), internalId:2521715, internalDocId:4477278, valueRaw:["$ 8M"], deletedRedundantSameAsAt:1.7454600609416347E9, foundName:["Investment"], documentExtract:"Tail Spend Management and Procurement Solution Provider Simfoni Secures $ 8M Investment Round Led by Kearney.", name:["Investment"], activityType:["investment"], status:["completed"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:CorporateFinanceActivity;
        UNWIND [{uri:"https://1145.am/db/9022045/Strategic_Spend_Hub-Product", properties:{internalId:12933818, useCase:["Power AI-Driven Procurement"], internalDocId:9022045, deletedRedundantSameAsAt:1.757253306944307E9, foundName:["Strategic Spend Hub"], name:["Strategic Spend Hub"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Product;
        UNWIND [{uri:"https://1145.am/db/1300315/Spend_Analytics_And_Spend_Automation_Provider-About-Us", properties:{documentDate:datetime('2022-08-30T12:35:00Z'), internalId:10275129, internalDocId:1300315, deletedRedundantSameAsAt:1.7527438402470007E9, foundName:["spend analytics and spend automation provider"], documentExtract:"As co-founder at Simfoni, a market-leading spend analytics and spend automation provider, Stefan helped develop a highly innovative value proposition and product suite, and scaled sales and delivery capabilities on a global level.  I am excited to join the Thinking Machine team at a key inflexion point as the company showcases a product release and expands its operations in the United States and Europe , said Stefan Dent, Board Advisor, Thinking Machine.  I am deeply passionate about how technology can be used to accelerate procurement performance to improve the way businesses operate and derive value from their spend with suppliers. Thinking Machine is at the forefront of AI automation and is experiencing exponential growth with customers adopting their platform to replace labor-intensive processes with a wholly digitized solution. The value proposition is compelling with Thinking Machine self-funded from the savings it generates across telecoms and data management spend.", name:["spend analytics and spend automation provider"]}}, {uri:"https://1145.am/db/9022045/Ai-Powered_Procurement_Solutions-About-Us", properties:{documentDate:datetime('2025-08-19T13:00:00Z'), internalId:11824838, internalDocId:9022045, deletedRedundantSameAsAt:1.7556290431795936E9, foundName:["AI-powered procurement solutions"], documentExtract:"Simfoni is a leading provider of AI-powered procurement solutions for complex, decentralized enterprises. Our Strategic Spend Hub brings together spend analytics, eSourcing, savings tracking, and supplier insights into a single, Snowflake-native platform-helping companies unlock savings, manage risk, and drive better business outcomes.", name:["AI-powered procurement solutions"]}}, {uri:"https://1145.am/db/324816/Digital_Solutions_Provider_For_Procurement_Analytics_And_Spend_Automation-About-Us", properties:{documentDate:datetime('2021-05-05T04:00:00Z'), internalId:9650186, internalDocId:324816, deletedRedundantSameAsAt:1.7522322705130017E9, foundName:["digital solutions provider for procurement analytics and spend automation"], documentExtract:"Simfoni, a next generation digital solutions provider for procurement analytics and spend automation specialises in the provision of digital technology that streamlines the procurement process thereby reducing both process costs and third-party expenditures. Simfoni is unique in not only offering the technology but having its own team of implementation support and buying resources effectively providing a one-stop shop for the entire eProcurement transformation process. Pietro Nesti, Engineering - Procurement Head at Gulftainer, commented on the engagement, We started this engagement just six weeks ago, and I could not be more pleased with the results we are already seeing. eProcurement implementations are notorious for poor levels of adoption and complications with configuration. The Simfoni system was configured and operational within the first week, and we are reaching over 80 % adoption in our second month of implementation.", name:["digital solutions provider for procurement analytics and spend automation"]}}, {uri:"https://1145.am/db/3284296/Spend_Analytics_And_Spend_Automation-About-Us", properties:{documentDate:datetime('2020-04-29T01:35:00Z'), internalId:9704420, internalDocId:3284296, deletedRedundantSameAsAt:1.7522322705130017E9, foundName:["Spend Analytics and Spend Automation"], documentExtract:"SAN FRANCISCO, April 28, 2020 /PRNewswire/ - Simfoni Limited, a global innovator in Spend Analytics and Spend Automation, announced the appointment of Jason Stern to Chief Executive Officer of Simfoni Analytics, and the opening (soon) of an additional office and moving of US Headquarters to San Francisco, the heart of technology innovation. Simfoni.  Last quarter Simfoni announced a strategic Investment to further ramp our growth and meet the increasing demand for our innovative real Artificial Intelligence (AI) Spend Analytics SaaS application. Today I am proud to announce we are executing extremely well on our strategy, even moreso in these uncertain times when supply chain risk and cost visibility are paramount concerns. We have hired a proven leader, started the year off with the two strategic multiyear competitive wins a leading global payment processor and a well-known private equity firm for their portfolio companies.", name:["Spend Analytics and Spend Automation"]}}, {uri:"https://1145.am/db/384780/Digital_Solutions_Provider_For_Spend_Intelligence_And_Spend_Automation-About-Us", properties:{documentDate:datetime('2021-07-22T04:00:00Z'), internalId:9769408, internalDocId:384780, deletedRedundantSameAsAt:1.7522322705130017E9, foundName:["digital solutions provider for Spend Intelligence and Spend Automation"], documentExtract:"Simfoni, the next-generation digital solutions provider for Spend Intelligence and Spend Automation, today announced that it has raised a total of $ 15 million in Series B funding led by Peakspan Capital. With this funding, Simfoni will significantly expand sales and marketing to meet increasing demand for its analytics-driven, turn-key Spend Automation platform, powered by Artificial Intelligence (AI).", name:["digital solutions provider for Spend Intelligence and Spend Automation"]}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:AboutUs;
        UNWIND [{uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html", properties:{datePublished:datetime('2025-08-19T13:00:00Z'), internalId:11824808, internalDocId:9022045, deletedRedundantSameAsAt:1.7556290431795936E9, dateRetrieved:datetime('2025-08-19T15:35:19Z'), sourceOrganization:"PR Newswire", headline:"Simfoni Launches Strategic Spend Hub to Power AI-Driven Procurement on Snowflake AI Data Cloud"}}, {uri:"https://1145.am/db/746047/wwwprwebcom_releases_simfoni_acquires_ec_sourcing_group_to_further_accelerate_growth_and_momentum_prweb18427648htm", properties:{datePublished:datetime('2022-01-10T06:05:00Z'), internalId:1270582, internalDocId:746047, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Acquires EC Sourcing Group to Further Accelerate Growth and Momentum"}}, {uri:"https://1145.am/db/3284296/wwwprnewswirecom_news-releases_simfoni-is-doubling-down-on-spend-analytics-301048953html", properties:{datePublished:datetime('2020-04-29T01:35:00Z'), internalId:1568430, internalDocId:3284296, deletedRedundantSameAsAt:1.7454600609416347E9, dateRetrieved:datetime('2024-01-14T02:05:44Z'), sourceOrganization:"PR Newswire", headline:"Simfoni is Doubling Down on Spend Analytics"}}, {uri:"https://1145.am/db/1533890/wwwprwebcom_releases_2022_11_prweb19026628htm", properties:{datePublished:datetime('2022-11-28T03:00:00Z'), internalId:1774756, internalDocId:1533890, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Announces the Acquisition of Xeeva, Leader in Indirect Spend Management Solutions"}}, {uri:"https://1145.am/db/413077/wwwprwebcom_releases_simfoni_brings_on_david_bush_as_ceo_of_spend_automation_prweb18131933htm", properties:{datePublished:datetime('2021-08-18T04:00:00Z'), internalId:1810856, internalDocId:413077, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Brings On David Bush As CEO Of Spend Automation"}}, {uri:"https://1145.am/db/835233/wwwprwebcom_releases_simfoni_welcomes_industry_leader_herb_cunitz_to_its_board_of_directors_prweb18498654htm", properties:{datePublished:datetime('2022-02-16T02:00:00Z'), internalId:1921928, internalDocId:835233, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Welcomes Industry Leader Herb Cunitz to its Board of Directors"}}, {uri:"https://1145.am/db/1300315/wwwprwebcom_releases_2022_8_prweb18863345htm", properties:{datePublished:datetime('2022-08-30T12:35:00Z'), internalId:2058482, internalDocId:1300315, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Stefan Dent joins the advisory board of Thinking Machine"}}, {uri:"https://1145.am/db/2027303/wwwprwebcom_releases_2023_06_prweb19359808htm", properties:{datePublished:datetime('2023-06-05T12:30:00Z'), internalId:2194094, internalDocId:2027303, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Tail Spend Management and Procurement Solution Provider Simfoni Secures $8M Investment Round Led by Kearney"}}, {uri:"https://1145.am/db/384780/wwwprwebcom_releases_simfoni_raises_15_million_in_series_b_funding_to_support_rapid_growth_and_expansion_of_next_generation_procurement_platform_prweb18083126htm", properties:{datePublished:datetime('2021-07-22T04:00:00Z'), internalId:2518504, internalDocId:384780, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Raises $15 Million in Series B Funding to Support Rapid Growth and Expansion of Next-Generation Procurement Platform"}}, {uri:"https://1145.am/db/4477278/wwwprwebcom_releases_tail-spend-management-and-procurement-solution-provider-simfoni-secures-8m-investment-round-led-by-kearney-854541790html", properties:{datePublished:datetime('2023-06-05T12:30:00Z'), internalId:2521777, internalDocId:4477278, deletedRedundantSameAsAt:1.7454600609416347E9, dateRetrieved:datetime('2024-08-27T05:58:21Z'), sourceOrganization:"PR Newswire", headline:"Tail Spend Management and Procurement Solution Provider Simfoni Secures $8M Investment Round Led by Kearney"}}, {uri:"https://1145.am/db/324816/wwwprwebcom_releases_gulftainer_partners_with_simfoni_for_digital_procurement_transformation_prweb17912093htm", properties:{datePublished:datetime('2021-05-05T04:00:00Z'), internalId:3021190, internalDocId:324816, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Gulftainer Partners with Simfoni for Digital Procurement Transformation"}}, {uri:"https://1145.am/db/456774/wwwprwebcom_releases_simfoni_continues_strong_growth_and_gears_up_for_expansion_prweb18179187htm", properties:{datePublished:datetime('2021-09-09T04:00:00Z'), internalId:4360813, internalDocId:456774, deletedRedundantSameAsAt:1.7454600609416347E9, sourceOrganization:"PR Web", headline:"Simfoni Continues Strong Growth and Gears Up for Expansion"}}, {uri:"https://1145.am/db/5523328/wwwkonnecthousecom_simfoni-and-snowflake-join-forces-to-revolutionize-ai-powered-spend-intelligence-and-procurement-solutions", properties:{datePublished:datetime('2025-05-09T09:21:57Z'), internalId:7887325, internalDocId:5523328, deletedRedundantSameAsAt:1.7470102996724772E9, dateRetrieved:datetime('2025-05-11T22:41:04Z'), sourceOrganization:"KonnectHouse", headline:"Simfoni and Snowflake Join Forces to Revolutionize AI-Powered Spend Intelligence and Procurement Solutions"}}] AS row
        CREATE (n:Resource{uri: row.uri}) SET n += row.properties SET n:Article;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, end: {uri:"https://www.prweb.com/releases/simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691.html"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:url]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/413077/Simfoni-Executive_Management_Team"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/835233/Simfoni-Board_Of_Directors"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni-Chief_Financial_Officer_(cfo"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni-Eu_Accounts_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni-Accounts_Director"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni-General_Manager"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni-Chief_Financial_Officer"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/3284296/Simfoni-Chief_Executive_Officer"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasRole]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/4477278/Digital_Procurement_Solutions-Kearney_Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/324816/Digital_Procurement_Transformation-Gulftainer_Gulftainer_Etc"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/5523328/Intelligence_And_Procurement_Solutions-Simfoni_Snowflake"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/384780/Partnership-Peakspan_Capital_Simfoni"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:partnership]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/2027303/Simfoni-Investment"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:investor]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/4477278/wwwprwebcom_releases_tail-spend-management-and-procurement-solution-provider-simfoni-secures-8m-investment-round-led-by-kearney-854541790html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/413077/wwwprwebcom_releases_simfoni_brings_on_david_bush_as_ceo_of_spend_automation_prweb18131933htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/1533890/wwwprwebcom_releases_2022_11_prweb19026628htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/746047/wwwprwebcom_releases_simfoni_acquires_ec_sourcing_group_to_further_accelerate_growth_and_momentum_prweb18427648htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/324816/wwwprwebcom_releases_gulftainer_partners_with_simfoni_for_digital_procurement_transformation_prweb17912093htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/5523328/wwwkonnecthousecom_simfoni-and-snowflake-join-forces-to-revolutionize-ai-powered-spend-intelligence-and-procurement-solutions"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/835233/wwwprwebcom_releases_simfoni_welcomes_industry_leader_herb_cunitz_to_its_board_of_directors_prweb18498654htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/2027303/wwwprwebcom_releases_2023_06_prweb19359808htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/wwwprwebcom_releases_simfoni_continues_strong_growth_and_gears_up_for_expansion_prweb18179187htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/384780/wwwprwebcom_releases_simfoni_raises_15_million_in_series_b_funding_to_support_rapid_growth_and_expansion_of_next_generation_procurement_platform_prweb18083126htm"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/3284296/wwwprnewswirecom_news-releases_simfoni-is-doubling-down-on-spend-analytics-301048953html"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/1300315/wwwprwebcom_releases_2022_8_prweb18863345htm"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/geonames_location/5391959"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:basedInHighGeoNamesLocation]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/746047/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/835233/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/413077/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/384780/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/4477278/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/5523328/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/746047/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/1533890/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/2027303/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1533890/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/413077/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/4477278/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/1533890/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/2027303/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/5523328/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/413077/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/456774/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/384780/Simfoni"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/746047/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/4477278/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/835233/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/3284296/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/384780/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/456774/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/2027303/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/1300315/Simfoni"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:sameAsHigh]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/9022045/Launches-Strategic_Spend_Hub"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:productActivity]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/1533890/Xeeva-Acquisition"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/746047/Ec_Sourcing_Group-Acquisition"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:buyer]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/4477278/Kearney-Simfoni-Investment"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/384780/Peakspan_Capital-Simfoni-Investment-Series_B"}, end: {uri:"https://1145.am/db/324816/Simfoni"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:target]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Launches-Strategic_Spend_Hub"}, end: {uri:"https://1145.am/db/9022045/Strategic_Spend_Hub-Product"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:product]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Simfoni"}, end: {uri:"https://1145.am/db/9022045/Ai-Powered_Procurement_Solutions-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/9022045/Ai-Powered_Procurement_Solutions-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/324816/Digital_Solutions_Provider_For_Procurement_Analytics_And_Spend_Automation-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/384780/Digital_Solutions_Provider_For_Spend_Intelligence_And_Spend_Automation-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/3284296/Spend_Analytics_And_Spend_Automation-About-Us"}, properties:{weight:1}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/1300315/Spend_Analytics_And_Spend_Automation_Provider-About-Us"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:hasAboutUs]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Launches-Strategic_Spend_Hub"}, end: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, properties:{documentExtract:"Simfoni Launches Strategic Spend Hub to Power AI-Driven Procurement on Snowflake AI Data Cloud. With Strategic Spend Hub, Simfoni has reimagined the procurement process as a closed-loop, AI- and data-driven experience by leveraging the capabilities of the Snowflake Native App Framework. Post this. With 'Talk To My Data' , the Strategic Spend Hub's flagship AI chat feature, customers can generate meaningful analysis in moments, share it with their team, and surface the data they need to make fast-and valuable-spend decisions.  The launch of Strategic Spend Hub is a game-changer for anyone responsible for managing business spend , said Stefan Dent, Co-Founder at Simfoni.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/industry/164_transformation_digital_solutions_technologies"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/industry/480_procurement_eprocurement_sourcing_contracting"}, properties:{weight:2}}, {start: {uri:"https://1145.am/db/324816/Simfoni"}, end: {uri:"https://1145.am/db/industry/132_martech_tech_technology_technologies"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:industryClusterPrimary]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Strategic_Spend_Hub-Product"}, end: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, properties:{weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;
        UNWIND [{start: {uri:"https://1145.am/db/9022045/Ai-Powered_Procurement_Solutions-About-Us"}, end: {uri:"https://1145.am/db/9022045/wwwprwebcom_releases_simfoni-launches-strategic-spend-hub-to-power-ai-driven-procurement-on-snowflake-ai-data-cloud-302531691html"}, properties:{documentExtract:"Simfoni is a leading provider of AI-powered procurement solutions for complex, decentralized enterprises. Our Strategic Spend Hub brings together spend analytics, eSourcing, savings tracking, and supplier insights into a single, Snowflake-native platform-helping companies unlock savings, manage risk, and drive better business outcomes.", weight:1}}] AS row
        MATCH (start:Resource{uri: row.start.uri})
        MATCH (end:Resource{uri: row.end.uri})
        CREATE (start)-[r:documentSource]->(end) SET r += row.properties;    
        """
        clean_db()
        for idx, query in enumerate(queries.split(";")):
            query = query.strip()
            if len(query) == 0:
                continue
            logger.info(f"row {idx}... {query[:100]}")
            _ = db.cypher_query(query)


    def test_re_merge_entity_adds_missing_relationship(self):
        uri = "https://1145.am/db/9022045/Simfoni"
        source_node = Resource.get_by_uri(uri)
        target_node = Resource.get_by_uri(source_node.internalMergedSameAsHighToUri)
        rel_to_be_created = ('https://1145.am/db/324816/Simfoni', 
                             'https://1145.am/db/9022045/Launches-Strategic_Spend_Hub', 
                             'productActivity', 1)
        before_rels = relationship_summary(target_node)
        before_weights = sum(x[3] for x in before_rels)
        assert rel_to_be_created not in before_rels       
        _ = Resource.merge_node_connections(source_node, target_node, run_as_re_merge=True)
        after_rels = relationship_summary(target_node)
        after_weights = sum(x[3] for x in after_rels)
        assert after_weights == before_weights + 1
        assert rel_to_be_created in after_rels
        

class RecursivelyReMergeNodesTestCase(TestCase):

    def setUp(self):
        clean_db()
        node_data = [
            {"doc_id":10000, "identifier":"orga","node_type":"Organization"},
            {"doc_id":10001, "identifier":"orgb","node_type":"Organization"},
            {"doc_id":10002, "identifier":"orgc","node_type":"Organization"},
            {"doc_id":10003, "identifier":"act1","node_type":"OperationsActivity"},
            {"doc_id":10004, "identifier":"act2","node_type":"MarketingActivity"},
            {"doc_id":20000, "identifier":"orgm","node_type":"Organization"},
            {"doc_id":20001, "identifier":"orgn","node_type":"Organization"},
            {"doc_id":20002, "identifier":"orgo","node_type":"Organization"},
            {"doc_id":20003, "identifier":"orgp","node_type":"Organization"},
        ]

        nodes = [make_node(**x) for x in node_data]
        node_list = ", ".join(nodes)

        query = f"""CREATE {node_list},
        (orga)-[:hasOperationsActivity {{weight: 1}}]->(act1),
        (orga)-[:hasMarketingActivity {{weight: 1}}]->(act2),
        (orgc)-[:hasMarketingActivity {{weight: 1}}]->(act2),
        (orgm)-[:hasOperationsActivity {{weight: 1}}]->(act1),
        (orgm)-[:hasMarketingActivity {{weight: 1}}]->(act2),
        (orgo)-[:hasOperationsActivity {{weight: 1}}]->(act1),
        (orgo)-[:hasMarketingActivity {{weight: 1}}]->(act2)
        SET orga.internalMergedSameAsHighToUri = 'https://1145.am/db/10001/orgb'
        SET orgb.internalMergedSameAsHighToUri = 'https://1145.am/db/10002/orgc'
        SET orgm.internalMergedSameAsHighToUri = 'https://1145.am/db/20001/orgn'
        SET orgn.internalMergedSameAsHighToUri = 'https://1145.am/db/20002/orgo'
        SET orgo.internalMergedSameAsHighToUri = 'https://1145.am/db/20003/orgp'
        """
        db.cypher_query(query)
        self.orga = Resource.get_by_uri('https://1145.am/db/10000/orga')
        self.orgb = Resource.get_by_uri('https://1145.am/db/10001/orgb')
        self.orgc = Resource.get_by_uri('https://1145.am/db/10002/orgc')
        self.orgm = Resource.get_by_uri('https://1145.am/db/20000/orgm')
        self.orgn = Resource.get_by_uri('https://1145.am/db/20001/orgn')
        self.orgo = Resource.get_by_uri('https://1145.am/db/20002/orgo')
        self.orgp = Resource.get_by_uri('https://1145.am/db/20003/orgp')
        artm = Resource.get_by_uri('https://1145.am/db/article_orgm')
        artn = Resource.get_by_uri('https://1145.am/db/article_orgn')
        self.orgo.documentSource.connect(artm)
        self.orgo.documentSource.connect(artn)

        
    def test_recursively_re_merges(self):
        # A -> B -> C
        recursively_re_merge_node_via_same_as(self.orga)
        vals_b = relationship_summary(self.orgb)
        assert ('https://1145.am/db/10001/orgb', 'https://1145.am/db/10003/act1', 
                'hasOperationsActivity', 1) in vals_b
        assert ('https://1145.am/db/10001/orgb', 'https://1145.am/db/10004/act2', 
                'hasMarketingActivity', 1) in vals_b
        vals_c = relationship_summary(self.orgc)
        assert ('https://1145.am/db/10002/orgc', 'https://1145.am/db/10003/act1', 
                'hasOperationsActivity', 1) in vals_c
        assert ('https://1145.am/db/10002/orgc', 'https://1145.am/db/10004/act2', 
                'hasMarketingActivity', 1) in vals_c
        
    def test_does_not_continue_if_node_unchanged(self):
        # M -> N -> O -> P
        # If O already has the same links then it won't continue to P
        # even if P doesn't have the same links. This is because it's not M's
        # job to fix any problems between O and P, that will be dealt with when 
        # O is updated
        recursively_re_merge_node_via_same_as(self.orgm)
        vals_n = relationship_summary(self.orgn)
        assert vals_n == {('https://1145.am/db/20001/orgn', 'https://1145.am/db/10004/act2', 'hasMarketingActivity', 1), 
                          ('https://1145.am/db/20001/orgn', 'https://1145.am/db/article_orgn', 'documentSource', None), 
                          ('https://1145.am/db/20001/orgn', 'https://1145.am/db/article_orgm', 'documentSource', 1),
                          ('https://1145.am/db/20001/orgn', 'https://1145.am/db/10003/act1', 'hasOperationsActivity', 1)}
        vals_o = relationship_summary(self.orgo)
        assert vals_o == {('https://1145.am/db/20002/orgo', 'https://1145.am/db/10004/act2', 'hasMarketingActivity', 1), 
                          ('https://1145.am/db/20002/orgo', 'https://1145.am/db/article_orgo', 'documentSource', None), 
                          ('https://1145.am/db/20002/orgo', 'https://1145.am/db/10003/act1', 'hasOperationsActivity', 1), 
                          ('https://1145.am/db/20002/orgo', 'https://1145.am/db/article_orgm', 'documentSource', 1), 
                          ('https://1145.am/db/20002/orgo', 'https://1145.am/db/article_orgn', 'documentSource', 1)}
        vals_p = relationship_summary(self.orgp)
        assert len(vals_p) == 1 # Didn't go any further than orgo because N -> O didn't add any new connections to O
        
    def test_re_merging_does_not_stack(self):
        recursively_re_merge_node_via_same_as(self.orga)
        recursively_re_merge_node_via_same_as(self.orga)
        recursively_re_merge_node_via_same_as(self.orga)
        recursively_re_merge_node_via_same_as(self.orga)
        recursively_re_merge_node_via_same_as(self.orga)
        vals_b = relationship_summary(self.orgb)
        assert ('https://1145.am/db/10001/orgb', 'https://1145.am/db/10003/act1', 
                'hasOperationsActivity', 1) in vals_b
        assert ('https://1145.am/db/10001/orgb', 'https://1145.am/db/10004/act2', 
                'hasMarketingActivity', 1) in vals_b
        vals_c = relationship_summary(self.orgc)
        assert ('https://1145.am/db/10002/orgc', 'https://1145.am/db/10003/act1', 
                'hasOperationsActivity', 1) in vals_c
        assert ('https://1145.am/db/10002/orgc', 'https://1145.am/db/10004/act2', 
                'hasMarketingActivity', 1) in vals_c
        

def relationship_summary(node_a):
    query = f"""MATCH (n: Resource {{uri:'{node_a.uri}' }})-[o]-(p) RETURN
                n.uri,
                p.uri,
                type(o),
                o.weight """
    res, _ = db.cypher_query(query, resolve_objects=False)
    res = set([tuple(x) for x in res if not x[2].startswith("sameAs")])
    return res

class DeleteNodesAfterIntegrationTestCase(TestCase):

    def test_deletes_with_same_internal_doc_id_and_merged_as(self):
        '''
            If one doc has multiple orgs to delete and which are all in the 
        '''
        clean_db()
        node_data = [
            {"doc_id":10000, "identifier":"orga","node_type":"Organization"},
            {"doc_id":10000, "identifier":"orgb","node_type":"Organization"},
            {"doc_id":10000, "identifier":"orgc","node_type":"Organization"},
            {"doc_id":10000, "identifier":"orgd","node_type":"Organization"},
        ]

        nodes = [make_node(**x) for x in node_data]
        node_list = ", ".join(nodes)

        query = f"""CREATE {node_list}
        SET orga.internalMergedSameAsHighToUri = 'https://1145.am/db/10000/orgb'
        SET orgb.internalMergedSameAsHighToUri = 'https://1145.am/db/10000/orgc'
        SET orgc.internalMergedSameAsHighToUri = 'https://1145.am/db/10000/orgd'
        """
        db.cypher_query(query)
        assert len(Organization.nodes.all()) == 4
        delete_and_clean_up_nodes_by_doc_id(10000)
        assert len(Organization.nodes.all()) == 0

def make_node(doc_id,identifier,node_type="Organization",doc_extract=None,datestamp=datetime.now(tz=timezone.utc)):
    if node_type == "Organization":
        industry = "bar" if identifier in "aeiou" else "baz"
        industry_str = f"industry: ['{industry}'],"
    else:
        industry_str = ""
    if "Activity" in node_type:
        status_str = "status: ['some status'], "
    else:
        status_str = ""
    if "GeoNamesLocation" in node_type:
        geo_str = f" countryCode: 'US', "
        if doc_id < 100:
            admin1_str = f" admin1Code: 'PA', "
        else:
            admin1_str = f" admin1Code: 'NY', "
        geo_str = f"{geo_str} {admin1_str}"
    else:
        geo_str = ""

    friendly_name = identifier.replace("_"," ")

    node = f"({identifier}:Resource:{node_type} {{uri: 'https://1145.am/db/{doc_id}/{identifier}', name: ['Name {friendly_name.upper()}'], {industry_str} {status_str} {geo_str} internalDocId: {doc_id}}})"
    if doc_extract is None:
        doc_extract_text = ''
    else:
        doc_extract = doc_extract.replace("'","")
        doc_extract_text = f"documentExtract: '{doc_extract}''"
    doc_source = f"""(docsource_{identifier}:Resource:Article {{uri: 'https://1145.am/db/article_{identifier}',
                        headline: 'Headline {identifier}', internalDocId: {doc_id}, sourceOrganization:'prweb', datePublished: datetime('{datestamp.isoformat()}') }})"""
    doc_extract_str = ""
    if "Activity" in node_type:
        doc_extract_str = f"{{ documentExtract: 'Doc Extract {doc_extract_text}' }}"
    return f"{node}-[:documentSource {doc_extract_str}]->{doc_source}, (docsource_{identifier})-[:url]->(ext_{identifier}:Resource {{ uri: 'https://example.org/external/art_{identifier}' }})"

def all_related_uris(resource):
    vals = {}
    for k,v in resource.__all_relationships__:
        rel_lens = [x.uri for x in resource.__dict__[k]]
        vals[k] = set(rel_lens)
    return vals


